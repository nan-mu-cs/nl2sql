Total # = 52

1. Give me the dates when the max temperature was higher than 85.

SELECT date
FROM weather
WHERE max_temperature_f > 85

What are the names of stations that have latitude lower than 37.5?

SELECT name
FROM station
WHERE lat < 37.5



2. For each city, return the highest latitude among its stations.

SELECT city, max(lat)
FROM station
Group by city


Give me the start station and end station for the trips with the three oldest id.

SELECT start_station_name, end_station_name
FROM trip
Order by id
LIMIT 3


3. What is the average latitude and longitude of stations located in San Jose city?

SELECT avg(lat), avg(long)
FROM station
WHERE city = "San Jose"


What is the id of the trip that has the shortest duration?

SELECT id
FROM trip
order by duration
LIMIT 1


4. What is the total and maximum duration of trips with bike id 636?

SELECT sum(duration), max(duration)
FROM trip
WHERE bike_id = 636


For each zip code, return the average mean temperature of August there.

SELECT zip_code , avg(mean_temperature_f)
FROM weather
where date LIKE "8/%"
Group by zip_code


5. From the trip record, find the number of unique bikes.

SELECT count(DISTINCT bike_id)
FROM trip

What is the number of distinct cities the stations are located at?

SELECT count(DISTINCT city)
FROM station


6. How many stations does Mountain View city has?

SELECT COUNT(id)
FROM station
WHERE city = "Mountain View"

Return the unique name for stations that have ever had 7 bikes available.

SELECT distinct T1.name
FROM station as T1 JOIN status as T2 ON T1.id = T2.station_id
WHERE T2.bikes_available = 7


7. Which station had the most trips starting from August? Give me the name and id of the station.

SELECT start_station_name, start_station_id
FROM trip
WHERE start_date LIKE "8/%"
GROUP BY start_station_name
ORDER BY COUNT(*) DESC
LIMIT 1

Which bike traveled the most often in zip code 94002?

SELECT bike_id
FROM trip
WHERE zip_code = 94002
GROUP BY bike_id
ORDER BY COUNT(*) DESC
LIMIT 1


8. How many days had both mean humidity above 50 and mean visibility above 8?

SELECT COUNT(*)
FROM weather 
Where mean_humidity > 50 and mean_visibility_miles > 8


What is the latitude, longitude, city of the station from which the shortest trip started?

Select T1.lat, T1.long, T1.city
From station as T1 JOIN trip as T2 ON T1.id = T2.start_station_id
Order by T2.duration 
LIMIT 1


9. What are the ids of stations that are located in San Francisco and have average bike availability above 10.

SELECT id
FROM station
WHERE city = "San Francisco"
INTERSECT
SELECT station_id
FROM status
GROUP by station_id
having avg(bikes_available) > 10


What are the names and ids of stations that had more than 14 bikes available on average or were installed on December?

SELECT T1.name, T1.id
FROM station as T1 JOIN status as T2 ON T1.id = T2.station_id
GROUP by T2.station_id
having avg(T2.bikes_available) > 14
UNION
SELECT name, id
FROM station
WHERE installation_date LIKE "12/%"


10. What is the 3 most common cloud cover rates in the region of zip code 94107?

SELECT cloud_cover
FROM weather
WHERE zip_code = 94107
GROUP BY cloud_cover 
ORDER BY COUNT (*) DESC
LIMIT 3

What is the zip code in which the average mean sea level pressure is the lowest?

SELECT zip_code
FROM weather
GROUP BY zip_code 
ORDER BY mean_sea_level_pressure_inches
LIMIT 1


11.  What is the average bike availability in stations that are not located in Palo Alto?

SELECT avg(bikes_available)
FROM status
WHERE station_id NOT IN
(SELECT id
FROM station
WHERE city = "Palo Alto")


What is the average longitude of stations that never had bike availability more than 10?

SELECT avg(long)
FROM station
WHERE id NOT IN
(SELECT station_id
FROM status
GROUP by station_id
Having max(bikes_available) > 10)


12. When and in what zip code did max temperature reach 80?

Select date, zip_code
From weather
Where max_temperature_f >= 80


Give me ids for all the trip that took place in a zip code area with average mean temperature above 60.

Select T1.id
From trip as T1 JOIN weather as T2 ON T1.zip_code = T2.zip_code
Group by T2.zip_code
having avg(T2.mean_temperature_f) > 60



For each zip code, return how many times max wind speed reached 25?

Select count(*)
From weather 
Where max_wind_Speed_mph >= 25
Group by zip_code



13. On which day and in which zip code was the min dew point lower than any day in zip code 94107?

SELECT date, zip_code
FROM weather
WHERE min_dew_point_f < (SELECT min(min_dew_point_f) FROM weather WHERE zip_code = 94107)


For each trip, return its ending station's installation date.

Select T1.id, T2.installation_date
From trip as T1 JOIN station as T2 ON T1.end_station_id = T2.id


Which trip started from the station with the largest dock count? Give me the trip id.

Select T1.id
From trip as T1 JOIN station as T2 ON T1.start_station_id = T2.id
Order by T2.dock_count Desc
LIMIT 1


14. Count the number of trips that did not end in San Francisco city.

Select count(*)
From trip as T1 JOIN station as T2 ON T1.end_station_id = T2.id
Where T2.city != "San Francisco"


In zip code 94107, on which day neither Fog nor Rain was not observed?

Select date
From weather
Where zip_code = 94107 and events != "Fog" and events != "Rain"


15. What are the ids of stations that have latitude above 37.4 and never had bike availability below 7?

SELECT id
FROM station
WHERE lat > 37.4
EXCEPT
SELECT station_id
FROM status
GROUP by station_id
Having min(bikes_available) < 7


What are names of stations that have average bike availability above 10 and are not located in San Jose city?

SELECT T1.name
FROM station as T1 JOIN status as T2 ON T1.id = T2.station_id
Group by T2.station_id
Having avg(bikes_available) > 10
EXCEPT
Select name
From station
WHERE city = "San Jose"


16. What are the name, latitude, and city of the station with the lowest latitude?

SELECT name, lat, city
FROM station
ORDER BY lat DESC
LIMIT 1


What are the date, mean temperature and mean humidity for the top 3 days with the largest max gust speeds?

SELECT date, mean_temperature_f, mean_humidity
FROM weather
ORDER BY max_gust_speed_mph DESC
LIMIT 3



17. List the name and the number of stations for all the cities that have at least 15 stations.

SELECT city, COUNT(*)
FROM station
GROUP BY city
HAVING COUNT(*) >= 15

Find the ids and names of stations from which at least 200 trips started.

SELECT start_station_id, start_station_name
FROM trip
GROUP BY start_station_name
HAVING COUNT(*) >= 100


18. Find the zip code in which the average mean visibility is lower than 10.

SELECT zip_code
FROM weather
GROUP BY zip_code
HAVING avg(mean_visibility_miles) < 10

List all the cities in a decreasing order of each city's stations' highest latitude.

SELECT city
FROM station
GROUP BY city
Order by max(lat) DESC


19. What are the dates that had the top 5 cloud cover rates? Also tell me the cloud cover rate.
  
SELECT date, cloud_cover
FROM weather
ORDER BY cloud_cover DESC
LIMIT 5

What are the ids and durations of the trips with the top 3 durations?

SELECT id, duration
FROM trip
ORDER BY duration DESC
LIMIT 3


20. For each station, return its longitude and the average duration of trips that started from the station.

Select T1.name, T1.long, avg(T2.duration)
From station as T1 JOIN trip as T2 ON T1.id = T2.start_station_id
Group by T2.start_station_id


For each station, find its latitude and the minimum duration of trips that ended at the station.

Select T1.name, T1.lat, min(T2.duration)
From station as T1 JOIN trip as T2 ON T1.id = T2.end_station_id
Group by T2.end_station_id 



21. List all the distinct stations from which a trip of duration below 100 started.

Select distinct start_station_name
From trip
Where duration < 100


Find all the zip codes in which the max dew point have never reached 70.

Select distinct zip_code
From weather
EXCEPT
Select distinct zip_code
From weather
Where max_dew_point_f >= 70

or

Select distinct zip_code
From weather
Group by zip_code
Having max(max_dew_point_f) < 70


22. 
Find the id for the trips that lasted at least three times as long as the average duration of trips in zip code 94103.

Select id
From trip
Where duration >= 3 * (Select avg(duration) From trip Where zip_code = 94103)


What are the dates in which the mean sea level pressure was between 30.3 and 31?

Select date
From weather 
Where mean_sea_level_pressure_inches between 30.3 and 31 


23. 
Find the day in which the difference between the max temperature and min temperature was the smallest. Also report the difference.

Select date, max_temperature_f - min_temperature_f 
From weather
Order by max_temperature_f - min_temperature_f 
LIMIT 1


What are the id and name of the stations that have ever had more than 12 bikes available?

Select Distinct T1.id, T1.name
From station as T1 JOIN status as T2 ON T1.id = T2.station_id
Where T2.bikes_available > 12




24. Give me the zip code where the average mean humidity is below 70 and at least 100 trips took place.

Select zip_code
From weather
Group by zip_code
having avg(mean_humidity) < 70
INTERSECT
Select zip_code
From trip
Group by zip_code
having count(*) >= 100


What are the names of stations that are located in Palo Alto city but have never been the ending point of trips more than 100 times?

Select name
From station
Where city = "Palo Alto"
EXCEPT
Select end_station_name
From trip
Group by end_station_name
Having count(*) > 100



25. How many trips started from Mountain View city and ended at Palo Alto city?

Select count(*)
From station as T1 JOIN trip as T2 JOIN station as T3 JOIN trip as T4 ON T1.id = T2.start_station_id and T2.id = T4.id and T3.id = T4.end_station_id
Where T1.city = "Mountain View" and T3.city = "San Francisco"


What is the average latitude and longitude of the starting points of all trips?

Select avg(T1.lat), avg(T1.long)
From station as T1 JOIN trip as T2 ON T1.id = T2.start_station_id
