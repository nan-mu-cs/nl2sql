Total # = 38

1.Find the name of all modern rooms with a base price below $160 and two beds.

SELECT roomName
FROM Rooms
WHERE basePrice < 160 AND beds= 2 and decor = 'modern';

2.Find all rooms with price higher than 160 and can accommodate more than 2 people. Report room names and codes.

SELECT roomName, RoomId
FROM Rooms
WHERE basePrice > 160 AND maxOccupancy > 2;

3.Find the most popular room in the hotel. The most popular room is the room that had seen the largest number of reservations

SELECT T2.roomName
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
GROUP BY T1.Room
ORDER BY count(*) desc
LIMIT 1;

4.How many kids lives in the room reserved by ROY SWEAZY

SELECT kids
FROM Reservations
WHERE FirstName="ROY" AND LastName = "SWEAZY";

5.How many times does ROY SWEAZY has reserved a room.

SELECT count(*)
FROM Reservations
WHERE FirstName="ROY" AND LastName = "SWEAZY";

6.Which room has highest rate? List the room's full name, rate, check in and check out day.

SELECT T2.roomName, T1.Rate, T1.CheckIn, T1.CheckOut
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
GROUP BY T1.Room
ORDER BY T1.Rate desc
Limit 1;

7.How many adults in CONRAD SELBIG Oct 23,2010's reservation?

SELECT Adults
FROM Reservations
WHERE CheckIn = "2010-10-23" and FirstName = "CONRAD" AND LastName = "SELBIG";

8.How many kids in DAMIEN TRACHSEL Sep 21,2010's reservation?

SELECT Kids
FROM Reservations
WHERE CheckIn = "2010-09-21" and FirstName = "DAMIEN" AND LastName = "TRACHSEL";

9.How many king beds ar there?

SELECT sum(beds)
FROM Rooms
WHERE bedtype = 'King';

10. List the names and decor of rooms that have a king bed. Sort the list by their price.

SELECT roomName, decor
FROM Rooms
WHERE bedtype = 'King'
ORDER BY basePrice;

11.Which room has cheapest base price? List the room's name and the base price.

SELECT roomName, basePrice
FROM Rooms
ORDER BY basePrice ASC
LIMIT 1;

12. What is the decor of room Recluse and defiance?

SELECT decor
FROM Rooms
WHERE roomName = "Recluse and defiance";

13. What is the average base price of different bed type? List bed type and average base price.

SELECT bedType, avg(basePrice)
FROM Rooms
GROUP BY bedType;

14.What is the total number of people could stay in the modern rooms?

SELECT sum(maxOccupancy)
FROM Rooms
WHERE decor = 'modern';

15.What kind of decor has least number of reservations? 

SELECT T2.decor
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
GROUP BY T2.decor
ORDER BY count(T2.decor) asc
Limit 1;

16.List how many times the number of people in the room reached the maximum occupancy of the room. The number of people include adults and kids.

SELECT count(*)
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
WHERE  T2.maxOccupancy = T1.Adults + T1.Kids;

17. Find the first and last names of people who payed more than the rooms' base prices?

SELECT T2.firstname, T2.lastname
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
Where T1.Rate - T2.basePrice > 0

18.How many rooms are there?

SELECT count(*)
FROM Rooms;

19.Find the number of rooms with king bed.

SELECT count(*)
FROM Rooms
WHERE bedType = "King";

20.Find the number of rooms for each bed type.

SELECT bedType, count(*)
FROM Rooms
GROUP BY bedType;

21.Find the name of the room with the maximum occupancy.

SELECT roomName
FROM Rooms
ORDER BY maxOccupancy DESC
LIMIT 1;

22.Find the id and name of the most expensive base price room.

SELECT roomName
FROM Rooms
ORDER BY basePrice DESC
LIMIT 1;


23.List the type of bed and name of all traditional rooms.

SELECT roomName, bedType
FROM Rooms
WHERE decor="traditional";

24.Find the number of rooms with king bed for each decor type.

SELECT decor, count(*)
FROM Rooms
WHERE bedType="King"
GROUP BY decor;

25.Find the average and minimum price of the rooms in different decor.

SELECT decor,avg(basePrice), min(basePrice)
FROM Rooms
GROUP BY decor;

26.List the name of all rooms sorted by their prices.

SELECT roomName
FROM Rooms
Order by basePrice;

27.Find the number of rooms with price higher than 120 for different decor.

SELECT decor,count(*)
FROM Rooms
WHERE basePrice > 120
GROUP BY decor;

28.Find the average price for the room with each bed type.

SELECT bedType, avg(basePrice)
FROM Rooms
GROUP BY bedType;

29.List the name of rooms with king or queen bed.

SELECT roomName
FROM Rooms
WHERE bedType = "King" OR bedType = "Queen";

30.How many different type of bed for all rooms are there?

SELECT count(distinct bedType)
FROM Rooms;

31.Find the name and id of the top 3 expensive rooms.

SELECT RoomId, roomName
FROM Rooms
ORDER BY basePrice DESC
LIMIT 3;

32.Find the name of rooms whose price is higher than the average price.

SELECT roomName
FROM Rooms
WHERE basePrice > (
	SELECT avg(basePrice)
	FROM Rooms
);

33. Find the number of rooms that do not have any reservation. 

select count(*)
from rooms
where roomid NOT IN (select room from reservations)

34. Find the name of rooms and number of reservations for each of them.

SELECT T2.roomName, count(*), T1.Room
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
group by T1.Room

35. Find the name of rooms that have been reserved for more than 60 times.

SELECT T2.roomName
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
group by T1.Room
having count(*) > 60

36. find the name of rooms whose base price is between 120 and 150.

select roomname
from rooms
where baseprice between 120 and 150

37. Find the name of rooms booked by some customers whose first name contains ROY.

SELECT T2.roomName
FROM Reservations AS T1 JOIN Rooms AS T2 on T1.Room = T2.RoomId
where firstname LIKE '%ROY%'
