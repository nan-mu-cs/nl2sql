Total # = 50

1. What is the name of the song that was released in the most recent year?

select song_name, releasedate
from song
order by releasedate desc
limit 1

Where is the f_id of the longest song?

select f_id
from files
order by duration desc
limit 1


2. Find the names of all English songs.

Select song_name
From song
Where languages = "english"


What are the f_id of songs whose format is mp3.

Select f_id
From files
Where formats = "mp3"


3. List the name and country of origin for all singers who have produced songs with rating above 9.

Select DISTINCT T1.artist_name, T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Where T2.rating > 9


List the file size and format for all songs that have resolution lower than 800.

Select DISTINCT T1.file_size, T1.formats
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
Where T2.resolution < 800



4. What is the name of the artist who produced the shortest song?

Select T1.artist_name
From song as T1 JOIN files as T2 ON T1.f_id = T2.f_id
Order by T2.duration
LIMIT 1


What are the names and countries of origin for the artists who produced the top three highly rated songs.

Select T1.artist_name, T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Order by T2.rating DESC
LIMIT 3 



5. How many songs have 4 minute duration?

Select count(*)
From files
where duration LIKE "4:%"


How many artists are from Bangladesh?

Select count(*)
From artist
where country = "Bangladesh"


6. What is the average rating of songs produced by female artists?

Select avg(T2.rating)
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
where T1.gender = "Female"


What is the most popular file format?

Select formats
from files
group by formats
order by count (*) DESC 
LIMIT 1


7. Find the names of the artists who are from UK and have produced English songs.

Select artist_name
From artist 
where country = "UK"
INTERSECT
Select artist_name
From song
where languages = "english"


Find the f_id of songs that are available in mp4 format and have resolution lower than 1000.

Select f_id
From files 
where formats = "mp4"
INTERSECT
Select f_id
From song
where resolution < 1000



8. What is the country of origin of the artist who is female and produced a song in Bangla?

Select T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
where T1.gender = "Female" and T2.languages = "bangla"


What is the average duration of songs that have mp3 format and resolution below 800?

Select avg(T1.duration)
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
where T1.formats = "mp3" and T2.resolution  < 800



9. What is the number of artists for each gender?

Select count(*), gender
From artist
group by gender


What is the average rating of songs for each language?

Select avg(rating), languages
From song
group by languages



***10. Return the gender and name of artist who produced the song with the lowest resolution.

Select T1.gender, T1.artist_name
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Order by T2.resolution Desc
LIMIT 1


For each file format, return the number of artists who released songs in that format.

Select count(*), formats
From files
Group by formats


11.  Find the distinct names of all songs that have a higher resolution than some songs  in English.

Select distinct T1.song_name
From song as T1, song as T2
where T1.resolution > T2.resolution and T2.languages = "english"


What are the distinct ids of all songs that have a lower rating than some songs of blues genre?

Select distinct T1.song_name
From song as T1, song as T2
where T1.rating < T2.rating and T2.genre_is = "blues"



12. What is the name and country of origin of the artist who released a song that has "love" in its title?

Select T1.artist_name, T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Where T2.song_name LIKE "%love%"


List the name and gender for all artists who released songs on March.

Select T1.artist_name, T1.gender
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Where T2.releasedate LIKE "%Mar%"


13. List the names of all genres in alphabetical oder, together with its ratings.

Select g_name, rating
From genre
Order by g_name


Give me a list of the names of all songs ordered by their resolution.

Select song_name
From song
Order by resolution


14. What are the f_ids of songs that are available in either mp4 format or have resolution above 720?

Select f_id
From files
where formats = "mp4"
UNION
Select f_id
From song
where resolution > 720


List the names of all songs that have 4 minute duration or are in English.

Select T2.song_name
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id 
where T1.duration LIKE "4:%"
UNION
Select song_name
From song
where languages = "english"



15. What is the language used the least often in the songs?

Select languages
From song
Group by languages
Order by count(*) DESC
LIMIT 1


What is the language that was used most often in songs with resolution above 500?

Select artist_name
From song
Group by languages
having resolution > 500
Order by count(*) DESC
LIMIT 1


16. What are the names of artists who are Male and are from UK?

Select artist_name
From artist
Where country = "UK" and gender = "Male"


Find the names of songs whose genre is modern or language is English.

Select song_name
From song
Where genre_is = "modern" and languages = "english"



17. Return the names of songs for which format is mp3 and resolution is below 1000.

Select T2.song_name
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
Where T1.formats = "mp3"
INTERSECT
Select song_name
From song
Where resolution < 1000


Return the names of singers who are from UK and released an English song.

Select artist_name
From artist
Where country = "UK"
INTERSECT
Select T1.artist_name
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
Where T2.languages = "english"




18. What are the average rating and resolution of songs that are in Bangra?

Select avg(rating), avg(resolution)
From song
where languages = "bangla"


What are the maximum and minimum resolution of songs whose duration is 3 minutes?

Select max(T2.resolution), min(T2.resolution)
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
where T1.duration LIKE "3:%"



19. What are the maximum duration and resolution of songs grouped and ordered by languages?

Select max(T1.duration), max(T2.resolution), T2.languages
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
group by T2.languages
order by T2.languages


What are the shortest duration and lowest rating of songs grouped by genre and ordered by genre?

Select min(T1.duration), min(T2.rating), T2.genre_is
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
group by T2.genre_is
order by T2.genre_is


20. Find the names and number of works of all artists who have at least one English songs.

Select T1.artist_name, count(*)
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
where T2.languages = "english"
group by T2.artist_name
having count(*) >= 1


Find the name and country of origin for all artists who have release at least one song of resolution above 900.

Select T1.artist_name, T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
where T2.resolution > 900
group by T2.artist_name
having count(*) >= 1


21. Find the names and number of works of the three artists who have produced the most songs.

Select T1.artist_name, count(*)
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
group by T2.artist_name
Order by count(*) DESC
LIMIT 3


Find the country of origin for the artist who made the least number of songs?

Select T1.country
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
group by T2.artist_name
Order by count(*)
LIMIT 1



22. What is names of the songs whose rating is below the rating of all songs in English?

Select song_name
From song
where rating <  (select min(rating)
                             from song
                             where languages = 'english')


What is f_ids of the songs whose resolution is higher than the resolution of any songs with rating lower than 8?

Select f_id
From song
where resolution > (select max(resolution)
                                      from song
                                       where rating < 8)


What is f_ids of the songs whose resolution is twice higher than the average resolution of songs in modern genre?

Select f_id
From song
where resolution > 2 * (select avg(resolution)
                                      from song
                                       where genre_is = "modern")



23. Find the top 3 artists who have the largest number of songs works whose language is Bangla.

Select T1.artist_name
From artist as T1 JOIN song as T2 ON T1.artist_name = T2.artist_name
where T2.languages = "bangla"
group by T2.artist_name
order by count(*) DESC
LIMIT 3


24. List the f_id, genre and artist name of English songs ordered by rating.

Select f_id, genre_is, artist_name
From song
where languages =  "English"
order by rating


List the duration, file size and format of songs whose genre is pop, ordered by title?

Select T1.duration, T1.file_size, T1.formats
From files as T1 JOIN song as T2 ON T1.f_id = T2.f_id
where T2.genre_is = "pop"
order by T2.song_name


25. Find the names of the artists have produced English songs but have never received rating higher than 8.

Select distinct artist_name
From song
where languages = "english"
EXCEPT
Select distinct artist_name
From song
where rating > 8


Find the names of the artists are from Bangladesh and have never received rating higher than 7.

Select distinct artist_name
From artist
where country = "Bangladesh"
EXCEPT
Select distinct artist_name
From song
where rating > 7
