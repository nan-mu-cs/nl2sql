
Total # = 64

1.display the first name and department name for each employee.

SELECT T1.first_name, T2.department_name
FROM employees as T1 JOIN departments as T2 ON T1.department_id = T2.department_id

List the full name (first and last name), and salary for those employees who earn below 6000.

SELECT first_name, last_name, salary
FROM employees
WHERE salary < 6000
 
display the first name, and department number for all employees whose last name is "McEwen".

SELECT first_name, department_id
FROM employees
WHERE last_name = 'McEwen'

Return all the information for all employees without any department number.

SELECT *
FROM employees
WHERE department_id IS NULL

display all the information about the department Marketing.

SELECT *
FROM  departments
WHERE department_name = 'Marketing'

when is the hire date for those employees whose first name does not containing the letter M?

SELECT hire_date
FROM employees
WHERE first_name NOT LIKE '%M%'

display the full name (first and last), hire date, salary, and department number for those employees whose first name does not containing the letter M。

SELECT first_name, last_name, hire_date, salary, department_id
FROM employees
WHERE first_name NOT LIKE '%M%'

display the full name (first and last), hire date, salary, and department number for those employees whose first name does not containing the letter M and make the result set in ascending order by department number.

SELECT first_name, last_name, hire_date, salary, department_id
FROM employees
WHERE first_name NOT LIKE '%M%'
ORDER BY department_id

what is the phone number of employees whose salary is in the range of 8000 and 12000?

SELECT phone_number
FROM employees
WHERE salary BETWEEN 8000 AND 12000

display all the information of employees whose salary is in the range of 8000 and 12000 and commission is not null or department number is except the number 40.

SELECT *
FROM employees
WHERE salary BETWEEN 8000 AND 12000 
AND commission_pct IS NOT NULL
OR  department_id != 40

What are the full name (first and last name) and salary for all employees who does not earn any commission?

SELECT first_name, last_name, salary
FROM  employees
WHERE commission_pct IS NULL

display the first and last name, and salary for those employees whose first name is ending with the letter m.

SELECT first_name, last_name, salary
FROM employees
WHERE first_name LIKE '%m'

Find job id and date of hire for those employees who was hired during November 5th, 2007 and July 5th, 2009.

SELECT job_id, hire_date 
FROM employees 
WHERE hire_date BETWEEN '2007-11-05' AND '2009-07-05'

What are the first and last name for those employees who works either in department 70 or 90?

SELECT first_name, last_name
FROM employees
WHERE department_id = 70 OR department_id = 90

Find the salary and manager number for those employees who is working under a manager.

SELECT salary, manager_id
FROM employees
WHERE manager_id IS NOT NULL

display all the details from Employees table for those employees who was hired before 2002-06-21.

SELECT *
FROM employees
WHERE hire_date < '2002-06-21'

display all the information for all employees who have the letters D, S, or N in their first name and also arrange the result in descending order by salary.

SELECT *
FROM employees
WHERE first_name LIKE '%D%' OR first_name LIKE '%S%' OR first_name LIKE '%N%'
ORDER BY salary DESC

display those employees who joined after 7th September, 1987.

SELECT * 
FROM employees  
WHERE hire_date > '1987-09-07'

display the job title of jobs which minimum salary is greater than 9000.

SELECT job_title 
FROM jobs 
WHERE min_salary > 9000

display job Title, the difference between minimum and maximum salaries for those jobs which max salary within the range 12000 to 18000.

SELECT job_title, max_salary-min_salary
FROM jobs 
WHERE max_salary BETWEEN 12000 AND 18000

display the emails of the employees who have no commission percentage and salary within the range 7000 to 12000 and works in that department which number is 50.

SELECT email
FROM employees 
WHERE commission_pct IS NULL 
AND salary BETWEEN 7000 AND 12000 
AND department_id=50

display the employee ID and the date on which he ended his previous job.

SELECT employee_id, MAX(end_date) 
FROM job_history 
GROUP BY employee_id

display those departments where more than ten employees work who got a commission percentage.

SELECT department_id 
FROM employees 
GROUP BY department_id 
HAVING COUNT(commission_pct)>10

Find the ids of the departments where any manager is managing 4 or more employees.

SELECT DISTINCT department_id
FROM employees
GROUP BY department_id, manager_id 
HAVING COUNT(employee_id) >=4

display the average salary of employees for each department who gets a commission percentage.

SELECT department_id, AVG(salary) 
FROM employees 
WHERE commission_pct IS NOT NULL 
GROUP BY department_id

display the country ID and number of cities for each country.

SELECT country_id, COUNT(*)  
FROM locations 
GROUP BY country_id

display job ID for those jobs that were done by two or more for more than 300 days.

SELECT job_id 
FROM job_history 
WHERE end_date-start_date >300 
GROUP BY job_id 
HAVING COUNT(*)>=2

display the ID for those employees who did two or more jobs in the past.

SELECT employee_id 
FROM job_history 
GROUP BY employee_id 
HAVING COUNT(*) >=2

2. Find employee with ID and name of the country presently where (s)he is working.

 SELECT employee_id, country_name
 FROM employees as T1 
             JOIN departments as T2 ON T1.department_id = T2.department_id
             JOIN locations as T3 ON T2.location_id = T3.location_id
             JOIN countries as T4 ON T3.country_id = T4.country_id
 
3. display the department name and number of employees in each of the department.

 SELECT T2.department_name, COUNT(*)
 FROM employees as T1 JOIN departments as T2 ON T1.department_id = T2.department_id
 GROUP BY T2.department_name
 
4. can you return all detailed info of jobs which was done by any of the employees who is presently earning a salary on and above 12000?

 SELECT T1.*
 FROM  job_history as T1 JOIN employees as T2 ON T1.employee_id = T2.employee_id
 WHERE T2.salary >= 12000
 
5. display job title and average salary of employees.

SELECT job_title, AVG(salary)
FROM employees as T1 JOIN jobs as T2 on T1.job_id = T2.job_id
GROUP BY T2.job_title
 
6. What is the name ( first name and last name ) for those employees who gets more salary than the employee whose id is 163?

 SELECT first_name, last_name
 FROM employees
 WHERE salary >
 (SELECT salary
 FROM employees
 WHERE employee_id=163
 )

return the smallest salary for every departments.

SELECT MIN(salary), department_id
FROM employees  
GROUP BY department_id 

Find the first name and last name and department id for those employees who earn such amount of salary which is the smallest salary of any of the departments.

SELECT first_name, last_name, department_id  
FROM employees  
WHERE salary IN  
(SELECT MIN(salary)  
FROM employees  
GROUP BY department_id)
 
7. Find the employee id for all employees who earn more than the average salary.

 SELECT employee_id
 FROM employees
 WHERE salary >
 (SELECT AVG(salary)
 FROM employees)
 
8. display the employee id and salary of all employees who report to Payam.

SELECT DISTINCT employee_id, salary
FROM employees AS T1 JOIN departments AS T2 ON T1.department_id = T2.department_id
WHERE T1.first_name = 'Payam'

#check
SELECT employee_id, salary
 FROM employees
 WHERE manager_id =
 (SELECT employee_id
 FROM employees
 WHERE first_name = 'Payam'
 )
 
9. find the name of all departments that do actually have one or more employees assigned to them.

 SELECT DISTINCT department_name
 FROM employees AS T1 JOIN departments AS T2 ON T1.department_id = T2.department_id
 
10. get the details of employees who manage a department.

 SELECT DISTINCT *
 FROM employees AS T1 JOIN departments AS T2 ON T1.department_id = T2.department_id
 WHERE T1.employee_id = T2.manager_id
 
11. display all the information about the department Marketing

 SELECT *
 FROM  departments
 WHERE department_name = 'Marketing'
 
12. display the ID for those employees who did two or more jobs in the past.

 SELECT employee_id
 FROM job_history
 GROUP BY employee_id
 HAVING COUNT(*) >=2
 
13. What are the unique ids of those departments where any manager is managing 4 or more employees.

 SELECT DISTINCT department_id
 FROM employees
 GROUP BY department_id, manager_id
 HAVING COUNT(employee_id) >=4
 
14. Find the job ID for those jobs which average salary is above 8000.

 SELECT job_id
 FROM employees
 GROUP BY job_id
 HAVING AVG(salary)>8000
 
15. display the employee ID and job name for all those jobs in department 80.

 SELECT T1.employee_id, T2. job_title
 FROM employees T1 JOIN jobs as T2 on T1.job_id = T2.job_id
 WHERE T1.department_id=80

What is the first name and job id for all employees in the Finance department?

SELECT T1.first_name, T1.job_id 
FROM employees as T1 JOIN departments as T2 ON T1.department_id = T2.department_id 
WHERE T2.department_name = 'Finance'

display all the information of the employees whose salary if within the range of smallest salary and 2500.

SELECT * 
FROM employees 
WHERE salary BETWEEN  
(SELECT MIN(salary) 
FROM employees) AND 2500

find the ids of the employees who does not work in those departments where some employees works whose manager id within the range 100 and 200.

SELECT * 
FROM employees 
WHERE department_id NOT IN 
(SELECT department_id 
FROM departments 
WHERE manager_id BETWEEN 100 AND 200)


display the employee name ( first name and last name ) and hire date for all employees in the same department as Clara.

SELECT first_name, last_name, hire_date  
FROM employees  
WHERE department_id =  
(SELECT department_id  
FROM employees  
WHERE first_name = "Clara")

display the employee name ( first name and last name ) and hire date for all employees in the same department as Clara excluding Clara.

SELECT first_name, last_name, hire_date  
FROM employees  
WHERE department_id =  
( SELECT department_id  
FROM employees  
WHERE first_name = "Clara")  
AND first_name != "Clara"

display the employee number and name( first name and last name ) for all employees who work in a department with any employee whose name contains a ’T’.

SELECT employee_id, first_name, last_name  
FROM employees  
WHERE department_id IN  
( SELECT department_id  
FROM employees  
WHERE first_name LIKE '%T%' )

display the employee number, name( first name and last name ), and salary for all employees who earn more than the average salary and who work in a department with any employee with a 'J' in their name.

SELECT employee_id, first_name , salary  
FROM employees  
WHERE salary > 
( SELECT AVG (salary)
FROM employees ) 
AND department_id IN 
( SELECT department_id  
FROM employees
WHERE first_name LIKE '%J%')

display the employee number and job id for all employees whose salary is smaller than any salary of those employees whose job title is MK_MAN.

SELECT employee_id, job_id  
FROM employees 
WHERE salary < 
( SELECT min(salary)  
FROM employees  
WHERE job_id = 'MK_MAN' )

display the employee number, name( first name and last name ) and job title for all employees whose salary is more than any salary of those employees whose job title is PU_MAN.

SELECT employee_id, first_name, last_name, job_id  
FROM employees  
WHERE salary >  
( SELECT max(salary)
FROM employees  
WHERE job_id = 'PU_MAN' )

display the department id and the total salary for those departments which contains at least two employees.

SELECT department_id, SUM(salary)
FROM employees  
GROUP BY department_id
HAVING count(*) >= 2

display all the information of those employees who did not have any job in the past.

SELECT * 
FROM employees 
WHERE employee_id NOT IN 
(SELECT employee_id 
FROM job_history)

display the department ID, full name (first and last name), salary for those employees who is highest salary in every department.

SELECT first_name,  last_name,  salary, department_id
FROM employees 
GROUP BY department_id
HAVING salary = MAX(salary)

display the first and last name, department, city, and state province for each employee.

SELECT T1.first_name, T1.last_name, T2.department_name, T3.city, T3.state_province
FROM employees as T1
JOIN departments as T2 ON T1.department_id = T2.department_id  
JOIN locations as T3 ON T2.location_id = T3.location_id

display those employees who contain a letter z to their first name and also display their last name, city.

SELECT T1.first_name, T1.last_name, T3.city
FROM employees as T1
JOIN departments as T2 ON T1.department_id = T2.department_id  
JOIN locations as T3 ON T2.location_id = T3.location_id
WHERE T1.first_name LIKE '%z%'

display the department name, city, and state province for each department.

SELECT T1.department_name, T2.city, T2.state_province
FROM departments as T1 JOIN locations as T2 ON T2.location_id = T1.location_id

display the full name (first and last name ) of employee with ID and name of the country presently where (s)he is working.

SELECT first_name, employee_id, country_name 
FROM employees as T1 
           JOIN departments as T2 ON T1.department_id = T2.department_id
           JOIN locations as T3 ON T2.location_id = T3.location_id
           JOIN countries as T4 ON T3.country_id = T4.country_id

display the department name and number of employees in each of the department.

SELECT department_name, COUNT(*) 
FROM employees as T1 JOIN departments as T2 ON T1.department_id = T2.department_id
GROUP BY department_name

display the full name (first and last name), and salary of those employees who working in any department located in London.

SELECT first_name, last_name, salary
FROM employees as T1
	   JOIN departments as T2 ON T1.department_id = T2.department_id
	   JOIN  locations as T3 ON T2.location_id = T3.location_id
WHERE  T3.city = 'London'



