
Total # = 43

1. How many continents are there?


select count(*)
from CONTINENTS;


2. Which of the continents has the most number of countries? List the continent id, continent name and the number of countries.


select T1.ContId, T1.Continent, count(*)
from CONTINENTS as T1 JOIN COUNTRIES as T2 on T1.ContId = T2.Continent
group by T1.ContId
order by count(*) DESC LIMIT 1;



3. How many countries are listed?


select count(*)
from COUNTRIES;


4. Which maker makes the most number of models? List both maker full name and id.


select T1.FullName, T1.Id
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
group by T1.Id
order by count(*) DESC LIMIT 1;


5. Which model of the cars has the minimum horsepower?


select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
order by T2.horsepower ASC LIMIT 1;


6. Which of the latest makes is the heaviest?

COMMENT: question is ambiguous

select T1.Make
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.Year =
(select min(Year)
from CARS_DATA
)
order by T2.weight DESC LIMIT 1;


7. Which of the makers produced the earliest car model?

COMMENT: SQL wrong/strange

select distinct T1.Maker
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2
on T1.Id = T2.Maker JOIN CAR_NAMES as T3
on T2.model = T3.model JOIN CARS_DATA as T4
on T3.MakeId = T4.id
where T4.year in (select Year
from CARS_DATA
order by Year ASC LIMIT 1
);



8. Which cars were not produced in the earliest year? What are the car names (make) and the production time?

COMMENT: question are wrong&strange: Find the name and production time of the cars that were not produced in the earliest year?
         SQL wrong/strange should be:

         select T2.Make, T1.Year
         from CARS_DATA as T1 join CAR_NAMES as T2
         on T1.Id = T2.MakeId
         where T1.Year != (select min(Year)
         from CARS_DATA);

select T2.Make, T1.Year
from CARS_DATA as T1 join CAR_NAMES as T2
on T1.Id = T2.MakeId
where T1.Year not in (select Year
from CARS_DATA
order by Year ASC LIMIT 1
);


9. Which distinct car models are the earliest car models?

COMMENT: ask too many earliest question. change this question.

select distinct T1.model
from MODEL_LIST as T1 JOIN CAR_NAMES as T2
on T1.model = T2.model JOIN CARS_DATA as T3
on T2.MakeId = T3.id
where T3.year in (select Year
from CARS_DATA
order by Year ASC LIMIT 1
);


10. Which of the continents has the most number of car makers?


select T1.Continent
from CONTINENTS as T1 JOIN COUNTRIES as T2
on T1.ContId = T2.continent JOIN COUNTRIES as T3
on T2.CountryId = T3.CountryId
group by T1.Continent
order by Count(*) DESC LIMIT 1;


11. Which of the countries has the most car makers? List the country name and id.


select T2.CountryName, T1.Country
from CAR_MAKERS as T1 JOIN COUNTRIES as T2 on T1.Country = T2.CountryId
group by T1.Country
order by Count(*) DESC LIMIT 1;



12. How many car models are produced by each maker? List the count and the maker full name.


 select Count(*), T2.FullName
 from MODEL_LIST as T1 JOIN CAR_MAKERS as T2 on T1.Maker = T2.Id
 group by T2.FullName;


13. What is the accelerate of the car make amc hornet sportabout (sw)?


select T1.Accelerate
from CARS_DATA as T1 JOIN CAR_NAMES as T2 on T1.Id = T2.MakeId
where T2.Make = 'amc hornet sportabout (sw)';


14. How many car makers are there in france?


select count(*)
from CAR_MAKERS as T1 JOIN COUNTRIES as T2 on T1.Country = T2.CountryId
where T2.CountryName = 'france';


15. How many car models are produced in the usa?

select count(*)
from MODEL_LIST as T1 JOIN CAR_MAKERS as T2 on T1.Maker = T2.Id
JOIN COUNTRIES as T3 on T2.Country = T3.CountryId
where T3.CountryName = 'usa';

16. What is the average miles per gallon(mpg) of the cars with 4 cylinders?


select avg(mpg)
from CARS_DATA
where Cylinders = 4;


17. What is the smallest weight of the car produced with 8 cylinders on 1974?


select Weight
from CARS_DATA
where Cylinders = 4 and Year = 1974
order by Weight asc Limit 1;


18. What are all the model names?

COMMENT: names?

select Model
from MODEL_LIST;


19. What are the countries having at least one car maker? List name and id.


select T1.CountryName, T1.CountryId
from COUNTRIES as T1 JOIN CAR_MAKERS as T2 on T1.CountryId = T2.Country
group by T1.CountryId
having count(*) >= 1;


20. What is the number of the cars with horsepower more than 150?


select count(*)
from CARS_DATA
where horsepower > 150;


21. What is the average weight of cars each year?

COMMENT: question is fine. but too wired, image if someone would ask this kinda question

select avg(Weight), Year
from CARS_DATA
group by Year;



22. Which country in europe has most manufacturers?

COMMENT: most manufacturers? What does this mean? where manufacturers comes from?

select T1.CountryName
from COUNTRIES as T1 JOIN CONTINENTS as T2
on T1.Continent = T2.ContId
JOIN CAR_MAKERS as T3
on T1.CountryId = T3.Country
where T2.Continent = 'europe'
group by T1.CountryName
order by count(*) desc limit 1;


23. what is the maximum horsepower and the make name of the car models with 3 cylinders ?

select T2.horsepower, T1.Make
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.cylinders = 3
order by T2.horsepower DESC LIMIT 1;


24. Which model saves the most gasoline? That is to say, have the maximum miles per gallon.


select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
order by T2.mpg DESC LIMIT 1;



25. What is the average horsepower of the cars before 1980?


select avg(horsepower)
from CARS_DATA
where Year < 1980;


26. What is the average edispl of the cars of model volvo?


select avg(T2.edispl)
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T1.Model = 'volvo';



27. What is the maximum accelerate for different number of cylinders?


select max(Accelerate), Cylinders
from CARS_DATA
group by Cylinders;


28. Which model has the most version(make) of cars?


select Model
from CAR_NAMES
group by Model
order by count(*) DESC LIMIT 1;


29. How many cars have more than 4 cylinders?


select count(*)
from CARS_DATA
where Cylinders > 4;


30. how many cars were produced on 1980?

select count(*)
from CARS_DATA
where Year = 1980;


31. How many car models were produced by the maker with full name American Motor Company?


select count(*)
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
where T1.FullName = 'American Motor Company';


32. Which makers designed more than 3 car models? List full name and the id.


select T1.FullName, T1.Id
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
group by T1.Id
having count(*) > 3;


33. Which models are produced by maker with the full name General Motors or weighing more than 3500?

COMMENT: use OR. it is much simpler.

select T2.Model
from CAR_NAMES as T1 JOIN MODEL_LIST as T2
on T1.Model = T2.Model
JOIN CAR_MAKERS as T3 on T2.Maker = T3.Id
where T3.FullName = 'General Motors'
union
select T1.model
from MODEL_LIST as T1 JOIN CAR_NAMES as T2
on T1.Model = T2.Model
JOIN CARS_DATA as T3 on T2.MakeId = T3.Id
where T3.weight > 3500;



34. In which year most cars were produced weighing between 3000 and 4000?


select T1.Year
from CARS_DATA as T1
where T1.Weight between 3000 and 4000
group by T1.Year
order by COUNT(*) DESC LIMIT 1;


35. What is the horsepower of the car makes with the largest accelerate?

COMMENT:car makes? how about the car with the largest accelerate

select T1.horsepower
from CARS_DATA as T1
order by T1.accelerate DESC LIMIT 1;


36. For model volvo, how many cylinders does the car with the least accelerate have?


select T1.cylinders
from CARS_DATA as T1 JOIN CAR_NAMES as T2
on T1.Id = T2.MakeId
where T2.Model = 'volvo'
order by T1.accelerate asc limit 1;


37. How many cars have a larger accelerate than the car with the largest horsepower?

select COUNT(*)
from CARS_DATA
where Accelerate > (
        select Accelerate
        from CARS_DATA
        order by Horsepower DESC LIMIT 1
);


38. How many countries has more than 2 car makers?

select COUNT(*)
from (
 select T1.CountryId, COUNT(*)
 from COUNTRIES as T1, CAR_MAKERS as T2
 where T1.CountryId = T2.Country
 group by T1.CountryId
 having count(*) > 2
);

39. How many cars has over 6 cylinders?


select COUNT(*)
from CARS_DATA
where Cylinders > 6;

40. For the cars with 4 cylinders, which model has the largest horsepower?


select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.Cylinders = 4
order by T2.horsepower DESC LIMIT 1;


41. Among the cars with more than lowest horsepower, Which ones do not have more than 3 cylinders? List the car makeid and make name.

COMMENT: use EXCEPT when only except works

select T2.MakeId, T2.Make
from CARS_DATA as T1 JOIN CAR_NAMES as T2 on T1.Id = T2.MakeId
where T1.Horsepower > (select min(Horsepower) from CARS_DATA)
EXCEPT
select T2.MakeId, T2.Make
from CARS_DATA as T1 JOIN CAR_NAMES as T2 on T1.Id = T2.MakeId
where T1.Cylinders > 3;


42. What is the maximum miles per gallon of the car with 8 cylinders or produced before 1980?

COMMENT: too many *est/maximum question. if you search limit, there are 21/42, half of the question.

select mpg
from CARS_DATA
where Cylinders = 8 or Year < 1980
order by mpg desc Limit 1;


43. Which models are lighter than 3500 but not built by the 'Ford Motor Company'?

COMMENT: use EXCEPT when only except works

select T1.model
from MODEL_LIST as T1 JOIN CAR_NAMES as T2
on T1.Model = T2.Model
JOIN CARS_DATA as T3 on T2.MakeId = T3.Id
where T3.weight < 3500
EXCEPT
select T2.Model
from CAR_NAMES as T1 JOIN MODEL_LIST as T2
on T1.Model = T2.Model
JOIN CAR_MAKERS as T3 on T2.Maker = T3.Id
where T3.FullName = 'Ford Motor Company';


COMMENT: can add more simple SQL: select multi/all columns, simple avg/max/min, split one complex into simpler one, add OR, INTERSECT(maybe)
