Total = #36

1.Who receieved a 1.5kg package?
SELECT T2.Name
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber
WHERE T1.Weight=1.5;

2.What is the total weight of all the packages that Al Gore's Head sent?

SELECT sum(T1.Weight)
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="Al Gore's Head";

3.What is the position of Phillip J. Fry ?
SELECT Position
FROM Employee
WHERE Name="Phillip J. Fry";

4.What is Turanga Leela's salary ?

SELECT Salary
FROM Employee
WHERE Name="Turanga Leela";

5. What is intern's average salary?

SELECT avg(Salary)
FROM Employee
WHERE Position="Intern";

6. What is Bender Bending Rodriguez's level?

SELECT T1.Level
FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee=T2.EmployeeID
WHERE T2.Name="Bender Bending Rodriguez";

7.List Package Number of all package sent by Leo Wong?
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="Leo Wong";

8.List all package received by Leo Wong?

SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber
WHERE T2.Name="Leo Wong";

9. List all package sent or received by Leo Wong.

SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="Leo Wong"
UNION
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber
WHERE T2.Name="Leo Wong"

10.Count the number of packages sent by Ogden Wernstrom and received by Leo Wong.
How many packages sent by Ogden Wernstrom and received by Leo Wong?
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber JOIN Client AS T3 ON T1.Sender=T3.AccountNumber
WHERE T2.Name="Leo Wong" AND T3.NAME="Ogden Wernstrom";

SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="Ogden Wernstrom"
INTERSECT
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber
WHERE T2.Name="Leo Wong"

11. What is the contents of package sent by John Zoidfarb?
SELECT T1.Contents
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="John Zoidfarb";

12. What is the heaviest package sent by Al Gore's Head? List package number and weight.
SELECT T1.PackageNumber,max(T1.Weight)
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
WHERE T2.Name="Al Gore's Head";

13. List package number and weight of top 3 lightest packages.
SELECT PackageNumber,Weight
FROM Package
ORDER BY Weight ASC
Limit 3;

14.Who sent most number of packages? List client name and number of packages sent by that client.
SELECT T2.Name,count(T1.Sender)
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
GROUP BY T1.Sender
ORDER BY count(T1.Sender) desc
Limit 1;

15. Who received least number of packages? List client name and number of packages received by that client.
SELECT T2.Name,count(T1.Sender)
FROM Package AS T1 JOIN Client AS T2 ON T1.Recipient = T2.AccountNumber
GROUP BY T1.Sender
ORDER BY count(T1.Sender) desc
Limit 1;

16. Who sent more than one packages? List the client's name.
SELECT T2.Name,count(T1.Sender)
FROM Package AS T1 JOIN Client AS T2 ON T1.Sender = T2.AccountNumber
GROUP BY T1.Sender
HAVING count(T1.Sender) > 1;

17. What is the Coordinates if Mars?
SELECT Coordinates
FROM Planet
WHERE Name="Mars"; 

18 List all Planet's name.
SELECT Name
FROM Planet

19 List all shipment id under Phillip J. Fry's management.

SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Employee AS T2 ON T1.Manager=T2.EmployeeID
WHERE T2.Name="Phillip J. Fry";

20 List the date of all shipment.
SELECT Date
FROM Shipment;

21. List all shipment id in Mars Planet.
SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID
WHERE T2.Name="Mars";

22 List all shipment id in Mars Planet and under the management of Turanga Leela.
SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID JOIN Employee as T3 on T3.EmployeeID=T1.Manager
WHERE T2.Name="Mars" AND T3.Name="Turanga Leela";

SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Employee AS T2 ON T1.Manager=T2.EmployeeID
WHERE T2.Name="Turanga Leela"
INTERSECT
SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID
WHERE T2.Name="Mars";

23. List all shipment id in Mars Planet or under the management of Turanga Leela.
SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID JOIN Employee as T3 on T3.EmployeeID=T1.Manager
WHERE T2.Name="Mars" OR T3.Name="Turanga Leela";

SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Employee AS T2 ON T1.Manager=T2.EmployeeID
WHERE T2.Name="Turanga Leela"
UNION
SELECT T1.ShipmentID
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID
WHERE T2.Name="Mars";

24. What is the total shipments in each planet? List the planet name and total shipments.

SELECT T2.Name, count(T1.ShipmentID)
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID
GROUP BY T1.Planet;

25. In which planet has most shipment? List the planet name.
SELECT T2.Name
FROM Shipment AS T1 JOIN Planet AS T2 ON T1.Planet=T2.PlanetID
GROUP BY T1.Planet
ORDER BY count(T1.Planet) DESC
LIMIT 1;

26. List the manger's name and number of shipments under his management.

SELECT T2.Name,count(T1.ShipmentID)
FROM Shipment AS T1 JOIN Employee AS T2 ON T1.Manager=T2.EmployeeID
GROUP BY T1.Manager;

27. Calculate total weight of package shipped in Mars.
SELECT sum(T1.Weight)
FROM Package AS T1 JOIN Shipment AS T2 ON T1.Shipment=T2.ShipmentID JOIN Planet AS T3 ON T2.Planet=T3.PlanetID
WHERE T3.Name="Mars";

28.Calculate total weight of package shipped in each planet.

SELECT T3.Name,sum(T1.Weight)
FROM Package AS T1 JOIN Shipment AS T2 ON T1.Shipment=T2.ShipmentID JOIN Planet AS T3 ON T2.Planet=T3.PlanetID
GROUP BY T2.Planet;

29. Which planet has total weight of shipment greater than 30? List planet name and total weight.

SELECT T3.Name,sum(T1.Weight)
FROM Package AS T1 JOIN Shipment AS T2 ON T1.Shipment=T2.ShipmentID JOIN Planet AS T3 ON T2.Planet=T3.PlanetID
GROUP BY T2.Planet
HAVING sum(T1.Weight)>30;

30. List package number of package shipped in Omicron Persei 8 and sent by Zapp Brannigan.

SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON  T1.Sender=T2.AccountNumber JOIN Shipment AS T3 ON T1.Shipment=T3.ShipmentID JOIN Planet AS T4 ON T3.Planet=T4.PlanetID
WHERE T2.Name="Zapp Brannigan" AND T4.Name="Omicron Persei 8";

SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON  T1.Sender=T2.AccountNumber
WHERE T2.Name="Zapp Brannigan"
INTERSECT
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Shipment AS T2 ON T1.Shipment=T2.ShipmentID JOIN Planet AS T3 ON T2.Planet=T3.PlanetID
WHERE T3.Name="Omicron Persei 8";

31. List package number of package shipped in Omicron Persei 8 OR sent by Zapp Brannigan.
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON  T1.Sender=T2.AccountNumber JOIN Shipment AS T3 ON T1.Shipment=T3.ShipmentID JOIN Planet AS T4 ON T3.Planet=T4.PlanetID
WHERE T2.Name="Zapp Brannigan" OR T4.Name="Omicron Persei 8";


SELECT T1.PackageNumber
FROM Package AS T1 JOIN Client AS T2 ON  T1.Sender=T2.AccountNumber
WHERE T2.Name="Zapp Brannigan"
UNION
SELECT T1.PackageNumber
FROM Package AS T1 JOIN Shipment AS T2 ON T1.Shipment=T2.ShipmentID JOIN Planet AS T3 ON T2.Planet=T3.PlanetID
WHERE T3.Name="Omicron Persei 8";

32. Which packages have weight between 10 and 30? List the package number and weight.

SELECT PackageNumber, Weight
FROM Package
WHERE Weight between 10 and 30;


33.Which employees do not have clearance in Mars? List employee's name.

SELECT Name
FROM Employee
EXCEPT
SELECT T2.Name
FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee=T2.EmployeeID JOIN Planet AS T3 ON T1.Planet=T3.PlanetID
WHERE T3.Name="Mars";


SELECT Name
FROM Employee
WHERE Name not in (
SELECT T2.Name
FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee=T2.EmployeeID JOIN Planet AS T3 ON T1.Planet=T3.PlanetID
WHERE T3.Name="Mars"
);

34. Which employees have clearance in Omega III? List employees' name.
SELECT T2.Name
FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee=T2.EmployeeID JOIN Planet AS T3 ON T1.Planet=T3.PlanetID
WHERE T3.Name="Omega III";

35. Which planets that have no employee has clearance? List planets' name.
SELECT T3.Name
FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee=T2.EmployeeID JOIN Planet AS T3 ON T1.Planet=T3.PlanetID
GROUP BY T1.Planet
HAVING count(T1.Planet) = 0;

36.Which employees have salary between 5000 and 10000? List employees' name.
SELECT Name
FROM Employee
WHERE Salary between 5000 and 10000

