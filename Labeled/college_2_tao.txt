
Total # = 72

Find the buildings where have rooms with capacity more than 50.

Select distinct building
From classroom
Where capacity > 50

Count the number of rooms that are not in the Lamberton building.

Select count(*)
From classroom
Where building != 'Lamberton'

What is the name and building of the departments whose budget is more than the average budget?

Select dept_name, building
From department
Where budget > (select avg(budget) from department)


Find the room number of the rooms where can sit 50 to 100 students and their buildings.

Select building, room_number
From classroom
Where capacity between 50 and 100

Find the name and building of the department with the highest budget.

Select dept_name, building
From department
Order by budget desc
Limit 1

What is the name of the student who has the highest total credits in the History department.

Select name
From student
Where dept_name = 'History'
Order by tot_cred desc
Limit 1


How many rooms does the Lamberton building have?

Select count(*)
From classroom
where building = 'Lamberton'

How many students have advisors?

Select count(distinct s_id)
From advisor

How many departments offer courses?

Select count(distinct dept_name)
From course

How many different courses offered by Physics department?

Select count(distinct course_id)
From course
Where dept_name = 'Physics'

Find the title of courses that have two prerequisites?

Select T1.title
From course as T1 join prereq as T2 on T1.course_id = T2.course_id
Group by T2.course_id
Having count(*) = 2

Find the title, credit, and department name of courses that have more than one prerequisites?

Select T1.title, T1.credits,T1.dept_name
From course as T1 join prereq as T2 on T1.course_id = T2.course_id
Group by T2.course_id
Having count(*) > 1

How many courses that do not have prerequisite?

select count(*)
From course
where course_id NOT IN (Select course_id From prereq)

Find the name of the courses that do not have any prerequisite?

select title
From course
where course_id NOT IN (Select course_id From prereq)

How many different instructors have taught some course?

select count (distinct id)
From teaches

Find the total budgets of the Marketing or Finance department.
Find the total budgets of the Marketing and Finance departments.

Select sum(budget)
From department
Where dept_name = 'Marketing' or dept_name = 'Finance'

Find the department name of the instructor whose name contains 'Soisalon'.

Select dept_name
From instructor
Where name like '%Soisalon%'


How many rooms whose capacity is less than 50 does the Lamberton building have?

Select count(*)
From classroom
Where building = 'Lamberton' and capacity < 50

Find the name and budget of departments whose budgets are more than the average budget.

Select dept_name, budget
From department
Where budget > (select avg(budget) from department)

what is the name of the instructor who is in Statistics department and earns the lowest salary?

Select name
From instructor
Where dept_name = 'Statistics'
Order by salary
Limit 1


Find the title of course that is provided by both Statistics and Psychology departments.

Select title
From course
Where dept_name = 'Statistics'
intersect
Select title
From course
Where dept_name = 'Psychology'

Find the title of course that is provided by Statistics but not Psychology departments.

Select title
From course
Where dept_name = 'Statistics'
Except
Select title
From course
Where dept_name = 'Psychology'

Find the id of instructors who taught a class in Fall 2009 but not in Spring 2010.

Select id
From teaches
Where semester = 'Fall' and year = 2009
Except
Select id
From teaches
Where semester = 'Spring' and year = 2010

Find the name of students who took any class in the years of 2009 and 2010.

select distinct T1.name
From student as T1 join takes as T2 on T1.id = T2.id
Where year = 2009 or year = 2010

Find the names of the top 3 departments that provide the largest amount of courses?

Select dept_name
From course
Group by dept_name
Order by count(*) desc
Limit 3

Find the name of the department that offers the highest total credits?

Select dept_name
From course
Group by dept_name
Order by sum(credits) desc
Limit 1

List the names of all courses ordered by their titles and credits.

Select title
From course
Order by title, credits

Which department has the lowest budget.

Select dept_name
From department
Order by budget
Limit 1

List the names and buildings of all departments sorted by the budget from large to small.

Select dept_name, building
From department
Order by budget desc

Who is the instructor with the highest salary?

Select name
From instructor
order by salary desc
Limit 1

List the information of all instructors ordered by their salary in ascending order.

Select *
From instructor
Order by salary

Find the name of the students and their department names sorted by their total credits in ascending order.

Select name, dept_name
From student
Order by tot_cred

list in alphabetic order all course names and their instructors' names in year 2008.

Select T1.title, T3.name
From course as T1
     Join teaches as T2 on T1.course_id = T2.course_id
     Join instructor as T3 on T2.id = T3.id
Where year = 2008


Find the name of instructors who are advising more than one student.

select T1.name
From instructor as T1 join advisor as T2 on T1.id = T2.i_id
Group by T2.i_id
Having count(*) > 1

Find the name of the students who have more than one advisor?

Select T1.name
From student as T1 join advisor as T2 on T1.id = T2.s_id
Group by T2.s_id
Having count(*) > 1

Find the number of rooms with more than 50 capacity for each building.

select count(*), building
from classroom
where capacity > 50
group by building

Find the maximum and average capacity among rooms in each building.

select max(capacity), avg(capacity), building
from classroom
group by building

Find the title of the course that is offered by more one department.

select title
from course
group by title
having count(*) > 1

Find the total credits of courses provided by different department.

select sum(credits), dept_name
from course
group by dept_name

Find the minimum salary for the departments whose average salary is above the average payment of all instructors.

select min(salary), dept_name
from instructor
group by dept_name
having avg(salary) > (select avg(salary) from instructor)

Find the number of courses provided in each semester and year.

select count(*), semester, year
from section
group by semester, year

Find the year when offers the largest number of courses.

select year
from section
group by year
order by count(*) desc
limit 1

Find the year and semester when offers the largest number of courses.

select semester, year
from section
group by semester, year
order by count(*) desc
limit 1

Find the name of department has the highest amount of students?

select dept_name
from student
group by dept_name
order by count(*) desc
limit 1

Find the total number of students in each department.

select count(*), dept_name
from student
group by dept_name

Find the semester and year when has the least number of student took any class.

select semester, year
from takes
group by semester, year
order by count(*)
limit 1


What is the id of the instructor advisors of all students from History department?

select i_id
from advisor as T1 join student T2 on T1.s_id = T2.id
where T2.dept_name = 'History'

Find the name and salary of the instructors who are the advisors of all students from History department?

select T2.name, T2.salary
from advisor as T1
     join instructor as T2 on T1.i_id = T2.id
     join student as T3 on T1.s_id = T3.id
where T3.dept_name = 'History'

Find the id of the courses that do not have any prerequisite?

select course_id
from course
except
select course_id
from prereq

Find the name of the courses that do not have any prerequisite?

select title
from course
where course_id NOT IN
(select course_id
from prereq)

What is the title of the prerequisite class of International Finance course?

select title
from course
where course_id IN
(select T1.prereq_id
from prereq as T1 join course as T2 on T1.course_id = T2.course_id
where T2.title = 'International Finance')

Find the title of course whose prerequisite is course Differential Geometry.

select title
from course
where course_id IN
(select T1.course_id
from prereq as T1 join course as T2 on T1.prereq_id = T2.course_id
where T2.title = 'Differential Geometry')

Find the names of students who have taken any course in the fall semester of year 2003.

select name
from student
where id NOT IN
(select id
from takes
where semester = 'Fall' and year = 2003)

What is the title of the course that was offered at building Chandler during the fall semester in the year of 2010?

select T1.title
from course as T1 join section as T2 on T1.course_id = T2.course_id
where building = 'Chandler' and semester = 'Fall' and year = 2010

Find the name of the instructors who taught C Programming course before.

select T1.name
from instructor as T1
     join teaches as T2 on T1.id = T2.id
     join course as T3 on T2.course_id = T3.course_id
where T3.title = 'C Programming'

Find the name and salary of instructors who are advisors of the students from the Math department.

select T2.name, T2.salary
from advisor as T1
     join instructor as T2 on T1.i_id = T2.id
     join student as T3 on T1.s_id = T3.id
where T3.dept_name = 'Math'


Find the name of instructors who are advisors of the students from the Math department, and sort the results by students' total credit.

select T2.name
from advisor as T1
     join instructor as T2 on T1.i_id = T2.id
     join student as T3 on T1.s_id = T3.id
where T3.dept_name = 'Math'
order by T3.tot_cred

What is the course title of the prerequisite of course Mobile Computing? 

select title
from course
where course_id IN
(select T1.prereq_id
from prereq as T1 join course as T2 on T1.course_id = T2.course_id
where T2.title = 'Mobile Computing')

Find the name of instructor who is the advisor of the student who has the highest number of total credits.

select T2.name
from advisor as T1
     join instructor as T2 on T1.i_id = T2.id
     join student as T3 on T1.s_id = T3.id
order by T3.tot_cred desc
limit 1

Find the name of instructors who didn't teach any courses?

select name
from instructor
where id NOT IN
(select id from teaches)

Find the id of instructors who didn't teach any courses?

select id
from instructor
except
select id
from teaches

Find the names of instructors who didn't each any courses in any Spring semester.

select name
from instructor
where id NOT IN
(select id from teaches where semester = 'Spring')

Find the name of the department where has the highest average salary of professors.

select dept_name
from instructor
group by dept_name
order by avg(salary) desc
limit 1

Find the number and averaged salary of all instructors who are in the department with the highest budget.

select avg(T1.salary), count(*)
from instructor as T1 join department as T2 on T1.dept_name = T2.dept_name
order by T2.budget desc
limit 1

What is the title and credits of the course that is taught in the largest classroom (with the highest capacity)?

select T3.title, T3.credits
from classroom as T1
     join section as T2 on T1.building = T2.building and T1.room_number = T2.room_number
     join course as T3 on T2.course_id = T3.course_id
where T1.capacity = (select max(capacity) from classroom)

Find the name of students who didn't take any course from Biology department.

select name
from student
where id NOT IN
(select T1.id
from takes as T1 join course as T2 on T1.course_id = T2.course_id
where T2.dept_name = 'Biology')


Find the name of students who didn't take any course taught by instructor McKinnon.

#####wrong#####check
select name
from student as T1 join takes as T2 on T1.id = T2.id
where T2.course_id, T2.sec_id, T2.semester, T2.year NOT IN
(Select T1.course_id, T1.sec_id, T1.semester, T1.year
from teaches as T1 join instructor as T2 on T1.id = T2.id
where T2.name = 'McKinnon')
     
Find the total number of students and total number of instructors for each department.

select count(distinct T2.id), count(distinct T3.id), T3.dept_name
from department as T1 
     join student as T2 on T1.dept_name = T2.dept_name
     join instructor as T3 on T1.dept_name = T3.dept_name
group by T3.dept_name

Find the name of students who have taken the prerequisite course of the course with title International Finance.

select T1.name
from student as T1 join takes as T2 on T1.id = T2.id
where T2.course_id = 
(select T2.prereq_id
from course as T1 join prereq as T2 on T1.course_id = T2.course_id
where T1.title = 'International Finance')

Find the name and salary of instructors whose salary is below the average salary of the instructors in the Physics department.

select name, salary
from instructor
where salary <
(select avg(salary)
from instructor
where dept_name = 'Physics')

Find the name of students who took some course offered by Statistics department.

select T3.name
from course as T1 
     join takes as T2 on T1.course_id = T2.course_id
     join student as T3 on T2.id = T3.id
where T1.dept_name = 'Statistics'

Find the building, room number, semester and year of all courses offered by Psychology department sorted by course titles.

select T2.building, T2.room_number, T2.semester, T2.year
from course as T1 join section as T2 on T1.course_id = T2.course_id
where T1.dept_name = 'Psychology'