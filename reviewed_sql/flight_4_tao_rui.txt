
Total # = 42

Find the name of the airport in the city of Goroka. 

select name
from airports
where city = 'Goroka'

Find the name, city, country, and altitude (or elevation) of the airports in the city of New York.

select name, city, country, elevation
from airports
where city = 'New York'

How many airlines are there?

select count(*)
from airlines

How many airlines does Russia has?

select count(*)
from airlines
where country = 'Russia'

What is the maximum elevation of all airports in the country of Iceland?

select max(elevation)
from airports
where country = 'Iceland'

Find the name of the airports located in Cuba or Argentina.

select name
from airports
where country = 'Cuba' or country = 'Argentina'

Find the country of the airlines whose name starts with 'Orbit'. 

select country
from airlines
where name LIKE 'Orbit%'

Find the name of airports whose latitude is between -50 and 50.

select name
from airports
where elevation between -50 and 50

Which country is the airport that has the highest latitude located in?

select country
from airports
order by elevation desc
limit 1

Find the number of airports whose name contain the word 'International'.

select count(*)
from airports
where name LIKE '%International%'

How many different cities do have some airport in the country of Greenland?

select count(distinct city)
from airports
where country = 'Greenland'

Find the number of routes operated by American Airlines.

select count(*)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
where T1.name = 'American Airlines'

find the number of routes whose destination airports are in Canada.

select count(*)
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where country = 'Canada'

Find the name, city, and country of the airport that has the lowest altitude.

select name, city, country
from airports
order by elevation
limit 1

Find the name, city, and country of the airport that has the highest latitude.

select name, city, country
from airports
order by elevation desc
limit 1

Find the name and city of the airport which is the destination of the most number of routes.

select T1.name, T1.city, T2.dst_apid
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
group by T2.dst_apid 
order by count(*) desc
limit 1

Find the names of the top 10 airlines that operate the most number of routes.

select T1.name, T2.alid
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T2.alid
order by count(*) desc
limit 10

Find the name and city of the airport which is the source for the most number of flight routes.

select T1.name, T1.city, T2.src_apid
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T2.src_apid
order by count(*) desc
limit 1

Find the number of different airports which are the destinations of the American Airlines.

select count(distinct dst_apid)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
where T1.name = 'American Airlines'


Which countries has the most number of airlines?

select country
from airlines
group by country
order by count(*) desc
limit 1

Which countries has the most number of airlines whose active status is 'Y'?

select country
from airlines
where active = 'Y'
group by country
order by count(*) desc
limit 1

List all countries and their number of airlines in the descending order of number of airlines.

select country, count(*)
from airlines
group by country
order by count(*) desc

How many airports are there per country? Order the countries by decreasing number of airports.

select count(*), country
from airports
group by country
order by count(*) desc

How many airports are there per city in the United States? Order the cities by decreasing number of airports.

select count(*), city
from airports
where country = 'United States'
group by city
order by count(*) desc

Return the cities with more than 3 airports in the United States.

select city
from airports
where country = 'United States'
group by city
having count(*) > 3

How many cities are there haing more than 3 airports?

select count(*)
from 
(select city
from airports
group by city
having count(*) > 3)

List the cities which have more than one airports and number of airports.

select city, count(*)
from airports
group by city
having count(*) > 1

List the cities which have more than 2 airports sorted by the number of airports.

select city
from airports
group by city
having count(*) > 2
order by count(*)

Find the number of routes for each source airport and the airport name.

select count(*), T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T1.name


Find the number of routes and airport name for each source airport, order the results by decreasing number of routes.

select count(*), T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T1.name
order by count(*) desc

Find the average elevation of all airports for each country.

select avg(elevation), country
from airports
group by country

Find the cities which have exactly two airports.

select city
from airports
group by city
having count(*) = 2

Find the most popular airline (airline that has the most number of routes) in each country.

###wrong check
select T1.country, T1.name, count(*)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T1.country, T1.name

Find the number of routes with destination airports in Italy.

select count(*)
from routes as T1 join airports as T2 on T1.dst_apid = T2.apid
where T2.country = 'Italy'

Return the number of routes with destination airport in Italy operated by the airline with name 'American Airlines'.

select count(*)
from routes as T1 
     join airports as T2 on T1.dst_apid = T2.apid
     join airlines as T3 on T1.alid = T3.alid
where T2.country = 'Italy' and T3.name = 'American Airlines'

Find the number of routes that have destination John F Kennedy International Airport.

select count(*)
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where T1.name = 'John F Kennedy International Airport'

Find the number of routes from the United States to Canada.

select count(*)
from routes 
where dst_apid IN (select apid from airports where country = 'Canada') 
      and src_apid IN (select apid from airports where country = 'United States')

Find the id of routes whose source and destination airports are in the United States.

select rid
from routes 
where dst_apid IN (select apid from airports where country = 'United States') 
      and src_apid IN (select apid from airports where country = 'United States')

Find the number of routes whose source and destination airports are in different countries.

COMMENT: sql not correct?

select count(*)
from routes
where (select country from airports where apid = dst_apid) != (select country from airports where apid = src_apid)


Find the name of airline which runs the most number of routes.

select T1.name
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T1.name
order by count(*) desc
limit 1

Find the busiest source airport that runs most number of routes in China.

select T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
where T1.country = 'China'
group by T1.name
order by count(*) desc
limit 1

Find the busiest destination airport that runs most number of routes in China.

select T1.name
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where T1.country = 'China'
group by T1.name
order by count(*) desc
limit 1
