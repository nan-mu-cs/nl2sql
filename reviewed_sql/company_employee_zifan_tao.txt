Total = 15

1. How many companies headquerted in the US are there?

SELECT count(*)
FROM company
where Headquarters = 'USA'

2. List the names of companies in ascending order of sales.

SELECT Name
FROM company
order by Sales_in_Billion ASC

3. What are the headquarters and industries of companies?

SELECT Headquarters, Industry
FROM company

4. Show the names of companies in banking or retailing industry?

SELECT Name
FROM company
Where Industry = "Banking" or Industry = "Retailing"

5. What is the maximum and minimum market value of companies?

SELECT max(Market_Value_in_Billion), min(Market_Value_in_Billion)
FROM company

6. What is the headquarter of the company with the largest sales.

SELECT Headquarters
FROM company
order by Sales_in_Billion DESC limit 1

7. Show different headquarters and the number of companies at each headquarter.

SELECT Headquarters, COUNT(*)
FROM company
group by Headquarters
 
8. Show the most common headquarter of companies.

SELECT Headquarters
FROM company
group by Headquarters
order by COUNT(*) DESC limit 1

9. Show the headquarters that have at least two companies.

SELECT Headquarters
FROM company
group by Headquarters
Having COUNT(*) >= 2

10. Show the headquarters that have both companies in banking industry and companies in oil and gas industry.

SELECT Headquarters
from company
Where Industry = "Banking"
Intersect 
SELECT Headquarters
from company
Where Industry = "Oil and gas"

11. Show names of companies and the names of employees.

SELECT T3.Name, T2.Name
FROM employment as T1 JOIN people as T2
on T1.People_ID = T2.People_ID join company as T3
on T1.Company_ID = T3.Company_ID

12. Show names of companies and the names of employees in descending order of number of years working of the employee.

SELECT T3.Name, T2.Name
FROM employment as T1 JOIN people as T2
on T1.People_ID = T2.People_ID join company as T3
on T1.Company_ID = T3.Company_ID
order by T1.Year_working

13. Show the names of employees that work for companies with sales bigger than 200.

SELECT T2.Name
FROM employment as T1 JOIN people as T2
on T1.People_ID = T2.People_ID join company as T3
on T1.Company_ID = T3.Company_ID
Where T3.Sales_in_Billion > 200

14. Show the names of companies and the number of employees they have

SELECT T3.Name, COUNT(*)
FROM employment as T1 JOIN people as T2
on T1.People_ID = T2.People_ID join company as T3
on T1.Company_ID = T3.Company_ID
group by T3.Name

15. List the names of people that are not employed by any company

SELECT Name
from people
where People_ID not in (SELECT People_ID FROM employment)

16. list the names of the companies with more than 200 sales in the descending order of sales and profits.

select name
from company
where Sales_in_Billion > 200
order by Sales_in_Billion, Profits_in_Billion desc
