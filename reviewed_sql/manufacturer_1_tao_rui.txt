Total # = 40

1. Who is the founder of Sony?

Select founder
from manufacturers
Where name = 'Sony'

2. Where is the headquarter of the company founded by James?

Select headquarter
From manufacturers
Where founder = 'James'

3. Find all manufacturers' names, their headquarters. List the ones with highest revenue first.

Select name, headquarter
From manufacturers
Order by revenue desc
Limit 1

4. What are the average, maximum and total revenues of all companies?

Select avg(revenue), max(revenue), sum(revenue)
From manufacturers

5. How many companies were created by Andy?

Select count(*)
From manufacturers
Where founder = 'Andy'

6. Find the total revenue created by the companies whose headquarter is located at Austin.

Select sum(revenue)
From manufacturers
Where headquarter = 'Austin'

7. What are the different cities listed?

Select distinct headquarter
From manufacturers

8. Find the name of manufactures that are based in Tokyo or Beijing.

Select count(*)
From manufacturers
Where headquarter = 'Tokyo' or headquarter = 'Beijing'

9. Find the founder of the company whose name beginning with the letter 'S'.

Select founder
From manufacturers
Where name LIKE '%S%'

10. Find the name of companies whose benefit is between 100 and 150.

Select name
From manufacturers
Where revenue between 100 and 150

11. What is the total revenue of the companies whose main office is at Tokyo or Taiwan?

Select sum(revenue)
From manufacturers
Where Headquarter = 'Tokyo' or Headquarter = 'Taiwan'

12. Find the name of product that is produced by both companies Creative Labs and Sony.

Select T1.name
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
where T2.name = 'Creative Labs'
INTERSECT
Select T1.name
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
where T2.name = 'Sony'

13. Find the name, headquarter and founder of the manufacturer that has the highest revenue.

Select name, headquarter, founder
From manufacturers
Order by Revenue desc
Limit 1

14. Find the name, headquarter and revenue of all manufacturers sorted by their revenue in the descending order.

Select name, headquarter, revenue
From manufacturers
Order by revenue desc


15. Find the name of companies whose revenue is greater than the average revenue of all companies.

Select name
From manufacturers
Where revenue > (select avg(revenue) From manufacturers)

16. Find the name of companies whose revenue is smaller than the revenue of all companies based in Austin.

Select name
From manufacturers
Where revenue < (select min(revenue) From manufacturers where headquarter = 'Austin')

17. Find the total revenue of companies whose revenue is larger than the revenue of some companies based in Austin.

Select sum(revenue)
From manufacturers
Where revenue > (select min(revenue) From manufacturers where headquarter = 'Austin')

18. Find the total revenue of companies of each founder.

Select sum(revenue), founder
From manufacturers
Group by founder

19. Find the name and revenue of the company that earns the highest revenue in each city.

Select name, max(revenue), Headquarter
From manufacturers
Group by Headquarter

20. Find the total revenue for each manufacturer.

Select sum(revenue), name
From manufacturers
Group by name

21. Find the average prices of all products from each manufacture, and list each company's name.

Select avg(T1.price), T2.name
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
Group by T2.name

22. Find the number of different products that are produced by companies at different headquarter cities.

Select count(distinct T1.name), T2.Headquarter
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
Group by T2. Headquarter

23. Find number of products which Sony does not make.

Select count(distinct name)
From products
Where name NOT IN (select T1.name From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code where T2.name = 'Sony') 

24. Find the name of companies that do not make DVD drive.

Select name
from manufacturers
EXCEPT
Select T2.name
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
where T1.name = 'DVD drive'

25. Find the number of products for each manufacturer, showing the name of each company.

Select count(*), T2.name
From products as T1 JOIN manufacturers as T2 on T1.Manufacturer = T2.code
Group by T2.name

26. Select the names of all the products in the store.

select Name
from Products
 
27. Select the names and the prices of all the products in the store.

select name, price
from products
 
28. Select the name of the products with a price less than or equal to $200.

select name
from products
where price <= 200
 
29. Find all information of all the products with a price between $60 and $120.

select * 
from products 
where price between 60 and 120
  
30. Compute the average price of all the products.

select avg(price)
from products
 
31. Compute the average price of all products with manufacturer code equal to 2.

select avg(price)
from products
where Manufacturer = 2
 
32. Compute the number of products with a price larger than or equal to $180.

select count(*)
from products
where price>=180
 
33. Select the name and price of all products with a price larger than or equal to $180, and sort first by price (in descending order), and then by name  (in ascending order).

select name, price
from products
where price >= 180
order by price desc, name asc
 
34. Select all the data from the products, including the name for each product's manufacturer.

select T1.*, T2.name
from products as T1 join Manufacturers as T2 on T1.manufacturer = T2.code
  
35. Select the average price of each manufacturer's products, showing only the manufacturer's code.

SELECT AVG(Price), Manufacturer
FROM Products
GROUP BY Manufacturer

36. Select the average price of each manufacturer's products, showing the manufacturer's name.

select avg(T1.Price), T2.name
from products as T1 join Manufacturers as T2 on T1.manufacturer = T2.code
group by T2.name
 
37. Select the names of manufacturer whose products have an average price larger than or equal to $150.

select avg(T1.Price), T2.name
from products as T1 join Manufacturers as T2 on T1.manufacturer = T2.code
group by T2.name
having avg(T1.price)>=150
 
38. Select the name and price of the cheapest product.

SELECT name, price
FROM Products
ORDER BY price ASC
LIMIT 1 

39. Select the name of each manufacturer along with the name and price of its most expensive product.                                                                                           

select T1.Name, max(T1.Price), T2.name
from products as T1 join Manufacturers as T2 on T1.manufacturer = T2.code
group by T2.name

40. Select the code of product that is cheapest in each product category.

Select code, name
from products
Group by name
Having price = min(price)
