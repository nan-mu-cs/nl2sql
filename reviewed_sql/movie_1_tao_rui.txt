Total # = 53

1. Find the titles of all movies directed by steven spielberg.

 select title
 from Movie
 where director='Steven Spielberg'

What is the name of the movie produced after 2000 and directed by James Cameron?

select title
from Movie
where director='James Cameron' and year > 2000

How many movies were made before 2000?

select count(*)
from Movie
where year < 2000

Who is the director of movie Avatar?

 select director
 from Movie
 where title ='Avatar'

How many reviewers listed?

Select count(*)
From Reviewer

What is the id of the reviewer whose name has substring “Mike”?

SELECT rID
FROM Reviewer
WHERE name LIKE "%Mike%"

What is the reviewer id of Daniel Lewis?

SELECT rID
FROM Reviewer
WHERE name = "Daniel Lewis"

What is the total number of ratings that has more than 3 stars?

Select count(*)
From Rating
Where stars > 3

What is the lowest and highest rating star?

Select max(stars), min(stars)
From Rating

2. Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order of year.

 select distinct year
 from Movie as T1 JOIN Rating as T2 on T1.mID = T2.mID
 where T2.stars >= 4
 order by T1.year

What are the names of directors who directed movies with 5 star rating? Also return the title of these movies.

select T1.director, T1.title
from Movie as T1 JOIN Rating as T2 on T1.mID = T2.mID
where T2.stars = 5

What is the average rating star for each reviewer?

select T2.name, avg(T1.stars)
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
Group by T2.name

3. Find the titles of all movies that have no ratings.

select title
from Movie
where mID not in (select mID from Rating)

4.Find the names of all reviewers who have ratings with a NULL value for the date.

 select distinct name
 from Reviewer as T1 JOIN Rating as T2 on T1.rID = T2.rID
 where ratingDate is NULL

What is the average rating stars and title for the oldest movie?

select avg(T1.stars), T2.title
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T2.year = (select min(year) from Movie)

What is the name of the most recent movie?

select title
from Movie
where year = (select max(year) from Movie)

What is the maximum stars and year for the most recent movie?

select max(T1.stars), T2.year
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T2.year = (select max(year) from Movie)

What is the names of movies whose created year is after all movies directed by Steven Spielberg?

select title
from Movie
where year > (select max(year) from Movie where director = "Steven Spielberg")

What are the titles and directors of the movies whose star is greater than the average stars of the movies directed by James Cameron?

select T2.title, T2.director
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T1.stars > (select avg(T1.stars) from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID where T2.director = "James Cameron")

5. Return reviewer name, movie title, stars, and ratingDate. And sort the data first by reviewer name, then by movie title, and lastly by number of stars.

 select T3.name, T2.title, T1.stars, T1.ratingDate
 from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 order by T3.name, T2.title, T1.stars

What are all reviewer name, movie titles and rating stars? 

select T3.name, T2.title, T1.stars
 from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID

6. Find the names of all reviewers who have contributed three or more ratings.

 SELECT T2.name
 FROM Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
 GROUP BY T1.rID
 HAVING COUNT(*) >= 3

 
7. Find the names of all reviewers who rated Gone with the Wind.

 select distinct T3.name
 from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 where T2.title = 'Gone with the Wind'

Find the names of all directors whose movies are rated by Sarah Martinez.

 select distinct T2.director
 from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 where T3.name = 'Sarah Martinez'
 
8. For any rating where the name of reviewer is the same as the director of the movie, return the reviewer name, movie title, and number of stars.

 select distinct T3.name, T2.title, T1.stars
 from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 where T2.director = T3.name

 
9. Return all reviewer names and movie names together in a single list.

select name
from Reviewer
union
select title
from Movie

10. Return all reviewer names and movie names together in a single list and sort them by name

select name
from (select name
from Reviewer
union
select title
from Movie)
order by name
 
11. Find the titles of all movies not reviewed by Chris Jackson.

select distinct title 
from Movie
EXCEPT
select T2.title
from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 where T3.name = 'Chris Jackson'
 
 
12. For all directors who directed more than one movie, return the titles of all movies directed by them, along with the director name. Sort by director name, then movie title.

 select T1.title, T1.director
 from Movie T1, Movie T2
 where T1.director = T2.director and T1.title != T2.title
 order by T1.director, T1.title

13. For directors who had more than one movie, return the titles and produced years of all movies directed by them.

select T1.title, T1.year
 from Movie T1, Movie T2
 where T1.director = T2.director and T1.title != T2.title

14. What are the names of the directors who made exactly one movie?

select director
from Movie 
group by director
having count(*) = 1

15. What are the names of the directors who made exactly one movie excluding director NULL?

select director
from Movie
where director is not NULL
group by director
having count(*) = 1

16. How many movie reviews does each director get?

select count(*), T1.director
from Movie as T1 JOIN Rating as T2 ON T1.mID = T2.mID
group by T1.director

 
17. Find the movies with the highest average rating. Return the movie titles and average rating.

select T2.title, avg(T1.stars)
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
group by T1.mID
order by avg(T1.stars) DESC
limit 1


18. What are the movie titles and average rating of the movies with the lowest average rating? 

select T2.title, avg(T1.stars)
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
group by T1.mID
order by avg(T1.stars)
limit 1

What are the names and years of the movies that has the top 3 highest rating star?

select T2.title, T2.year
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
order by T1.stars desc
limit 3
 
19. For each director, return the director's name together with the title of the movie they directed that received the highest rating among all of their movies, and the value of that rating. Ignore movies whose director is NULL.

select T2.title, T1.stars, T2.director
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where director is not NULL
group by director
Having T1.stars = max(T1.stars)

Find the title and star rating of the movie that got the least rating star for each reviewer.

 SELECT T2.title, T1.rID, T1.stars
 FROM Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
 GROUP BY T1.rID
Having T1.stars = min(T1.stars)

Find the title and score of the movie with the lowest rating among all movies directed by each director.

select T2.title, T1.stars, T2.director
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
group by T2.director
Having T1.stars = min(T1.stars)

20. What is the name of the movie that is rated by most of times?

select T2.title, T1.mID
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
group by T1.mID
order by count(*) desc
limit 1

21. What are the titles of all movies that have rating star is between 3 and 5?

select T2.title
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T1.stars between 3 and 5

find the names of reviewers who had given higher than 3 star ratings?

select T2.name
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
where T1.stars > 3

22.  Find the average rating star for each movie that are not reviewed by Brittany Harris.

select mID, avg(stars)
from Rating
where mID NOT IN
(select T1.mID
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
where T2.name = "Brittany Harris")
GROUP BY mID

What are the ids of the movies that are not reviewed by Brittany Harris.

select mID
from Rating
EXCEPT
select T1.mID
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
where T2.name = "Brittany Harris"

Find the average rating star for each movie that received at least 2 ratings.

select mID, avg(stars)
from Rating
GROUP BY mID
having count(*) >= 2

23. find the ids of reviewers who did not give 4 star.

select rID
from Rating
EXCEPT
select rID
from Rating
where stars = 4

Find the ids of reviewers who didn't only give 4 star.

select rID
from Rating
where stars != 4


24. What are names of the movies that are either made after 2000 or reviewed by Brittany Harris?

select distinct T2.title
from Rating as T1 
      JOIN Movie as T2 on T1.mID = T2.mID
      JOIN Reviewer as T3 on T1.rID = T3.rID
 where T3.name = 'Brittany Harris' or T2.year > 2000

What are names of the movies that are either made before 1980 or directed by James Cameron?

select title
from Movie 
where director = "James Cameron" or year  < 1980

25. What are the names of reviewers who had rated 3 star and 4 star?

select T2.name
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
where T1.stars = 3
INTERSECT
select T2.name
from Rating as T1 JOIN Reviewer as T2 on T1.rID = T2.rID
where T1.stars = 4

What are the names of movies that get 3 star and 4 star?

select T2.title
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T1.stars = 3
INTERSECT
select T2.title
from Rating as T1 JOIN Movie as T2 on T1.mID = T2.mID
where T1.stars = 4
