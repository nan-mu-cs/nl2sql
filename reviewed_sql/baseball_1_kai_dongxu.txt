Total = # 40


1. what is the full name and id of the college with most number of baseball player?

SELECT T1.name_full, T1.college_id
FROM college as T1 join player_college as T2 on T1.college_id = T2.college_id
GROUP BY T1.college_id
ORDER BY count(*) desc
LIMIT 1;

2. What is average salary of players in the team named 'Boston Red Stockings' ?

SELECT avg(T1.salary)
FROM salary as T1 join team as T2 on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings'


3. What are first and last names of players participating in all star game in 1998?

SELECT name_first, name_last
FROM player as T1 join all_star as T2 on T1.player_id = T2.player_id
WHERE year = 1998

4. What is the  first name, last name  and id of the player with most all star game experiences? Also list the count.

SELECT T1.name_first,T1.name_last, T1.player_id,  count(*)
FROM player as T1 join all_star as T2 on T1.player_id = T2.player_id
GROUP BY T1.player_id
ORDER BY count(*) desc
LIMIT 1;

5.  What is the id and name of the team appearing at any game with most of all star players ? 

select T2.team_id, T1.name
from team as T1 JOIN appearances as T2
on T1.team_id = T2.team_id
JOIN all_star as T3
where T2.player_id = T3.player_id
group by T2.team_id
order by count(*) desc
limit 1;

6. How many players enter hall of fame each year?

SELECT yearid, count(player_id)
FROM hall_of_fame
GROUP BY yearid;

7. What is the average number of attendance for each year?

SELECT year, avg(attendance)
FROM home_game
GROUP BY year;

8. In 2014, what is the id and rank of the team that has most average number of attendance?

SELECT T2.team_id, T2.rank
FROM home_game as T1 join team as T2 
on T1.team_id = T2.team_id
WHERE T1.year = 2014
GROUP BY T1.team_id
ORDER BY avg(T1.attendance) desc
LIMIT 1;

9. What's the manager's first name, last name and id who won most of the manager award?

SELECT T1.name_first, T1.name_last, T2.player_id
FROM player as T1 join manager_award as T2 on T1.player_id = T2.player_id
GROUP BY T2.player_id
ORDER BY count(*) desc
LIMIT 1;

10. How many parks are there in the state of NY?

SELECT count(*)
FROM park
WHERE state = 'NY';

11. Which 3 players won most of player award? List their full name and id.
	
SELECT T1.name_first, T1.name_last, T1.player_id
FROM player as T1 join player_award as T2 on T1.player_id = T2.player_id
GROUP BY T1.player_id
ORDER BY count(*) desc
LIMIT 3;

12. List three countries which are the origins of least players.

SELECT birth_country
FROM player
GROUP BY birth_country
ORDER BY count(*) asc
LIMIT 3;

13. Find all players' first name and last name who have empty death record.

SELECT name_first, name_last
FROM player
WHERE death_year='';

14. How many players born in USA are right-handed batters? That is, have the batter value as 'R'.

SELECT count(*)
FROM player
WHERE birth_country='USA' and bats = 'R';

15. What is the average height of players from the college named 'Yale University'?

SELECT avg(T1.height)
FROM player as T1 JOIN player_college T2 on T1.player_id = T2.player_id
JOIN college T3 on T3.college_id = T2.college_id
WHERE T3.name_full = 'Yale University';

16. What is the highest salary of each team? List the team name, id and maximum salary.

SELECT T1.name, T1.team_id, max(T2.salary)
FROM team as T1 JOIN salary as T2 on T1.team_id = T2.team_id 
GROUP BY T1.team_id;

17. What is the name and id of the team offering the lowest average salary?

SELECT T1.name, T1.team_id
FROM team as T1 JOIN salary as T2 on T1.team_id=T2.team_id 
GROUP BY T1.team_id
ORDER BY avg(T2.salary) asc
LIMIT 1;

18. Find out players' first name and last name who won award both in 1960 and 1961

SELECT T1.name_first,T1.name_last
FROM player as T1 JOIN player_award as T2
WHERE T2.year = 1960
INTERSECT
SELECT T1.name_first,T1.name_last
FROM player as T1 JOIN player_award as T2
WHERE T2.year = 1961

19. List players' first name and last who have weight greater than 220 or height shorter than 75.

SELECT name_first, name_last
FROM player
WHERE weight > 220 or height < 75

20. List maximum scores of team Boston Red Stockings when the team winned in postseason?

SELECT max(T1.wins)
FROM postseason as T1 JOIN team as T2 ON T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings';


21. How many times did Boston Red Stockings lose in 2009 postseason?

SELECT count(*)
FROM postseason as T1 JOIN team as T2 on T1.team_id_loser = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings' and T1.year=2009;

21. What is the name and id of the team with most victories in 2008 postseason?

SELECT T2.name, T1.team_id_winner
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T1.year = 2008
GROUP BY T1.team_id_winner
ORDER BY count(*) desc
LIMIT 1;

22. What is the number of wins the team Boston Red Stockings got in the postseasons each year in history?

SELECT count(*), T1.year
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
GROUP BY T1.year

23. What is the total number of postseason games that team Boston Red Stockings participate?

select count(*)
from (
SELECT *
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
UNION
SELECT *
FROM postseason as T1 JOIN team as T2 on T1.team_id_loser = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
);

24. How many games in 1885 postseason resulted in ties, which value is '1'?

SELECT count(*)
FROM postseason
WHERE year = 1885 and ties = 1;

25. What is the total salary paid by team Boston Red Stockings in 2010?
P: What is the total salary expenses of team Boston Red Stockings in 2010?

SELECT sum(T1.salary)
FROM salary as T1 join team as T2 
on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings' and T1.year = 2010

26. How many players were in the team Boston Red Stockings in 2000?
P: How many players did Boston Red Stockings have in 2000?

SELECT count(*)
FROM salary as T1 join team as T2 
on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings' and T1.year = 2000

27. List the 3 highest salaries of players in 2001?

SELECT salary
FROM salary
WHERE year = 2001
ORDER BY salary desc
LIMIT 3;

28. What were all the salary values of players in 2010 and 2001?


SELECT salary
FROM salary
WHERE year = 2010
UNION
SELECT salary
FROM salary
WHERE year = 2001


29. In which year did least people enter hall of fame?

SELECT yearid
FROM hall_of_fame
GROUP BY yearid
ORDER BY count(*) asc
LIMIT 1;

30. How many parks are there in Atlanta city?

SELECT count(*)
FROM park
WHERE city='Atlanta';

31. How many games played in park Columbia Park in 1907?

SELECT count(*)
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year=1907 and T2.park_name='Columbia Park';

32. How many games were played in city Atlanta in 2000?

SELECT count(*)
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year = 2000 and T2.city = 'Atlanta';

33. What is the total home game attendance of team Boston Red Stockings from 2000 to 2010?

SELECT sum(T1.attendance)
FROM home_game as T1 JOIN team as T2 on T1.team_id = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings' and T1.year between 2000 and 2010;

34. How much did the the player with first name Len and last name Barker earned between 1985 to 1990 in total?

SELECT sum(T1.salary)
FROM salary as T1 JOIN player as T2 on T1.player_id=T2.player_id
WHERE T2.name_first = 'Len' and T2.name_last='Barker' and T1.year between 1985 and 1990;

35. List players' first name and last name who recieved salary from team Washington Nationals in both 2005 and 2007. was

SELECT T2.name_first, T2.name_last
FROM salary as T1 JOIN player as T2 ON T1.player_id=T2.player_id JOIN
team as T3 on T3.team_id_br=T1.team_id
WHERE T1.year=2005 and T3.name='Washington Nationals'
INTERSECT
SELECT T2.name_first,T2.name_last
FROM salary as T1 JOIN player as T2 ON T1.player_id=T2.player_id JOIN
team as T3 on T3.team_id_br=T1.team_id
WHERE T1.year=2007 and T3.name='Washington Nationals' 

36. How many home games did the team Boston Red Stockings play from 1990 to 2000 in total?

SELECT sum(T1.games)
FROM home_game as T1 JOIN team as T2 on T1.team_id=T2.team_id_br
WHERE T2.name='Boston Red Stockings' and T1.year between 1990 and 2000;

37. Which team had least number of attendances in home games in 1980?

SELECT T2.name
FROM home_game as T1 JOIN team as T2 on T1.team_id=T2.team_id_br
WHERE T1.year=1980
ORDER BY T1.attendance asc
LIMIT 1;

38. List name of states that have more than 2 parks.
P: Which states have more than 2 parks.

SELECT state
FROM park
GROUP BY state
HAVING count(*) > 2;

39. How many team franchises are active, with active value as 'Y'?

SELECT count(*)
FROM team_franchise
WHERE active='Y';

40. Which cities have between 2 to 4 parks?

SELECT city
FROM park
GROUP BY city
HAVING count(city) between 2 and 4;

41. Which park had most attendances in 2008?

SELECT T2.park_name
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year=2008
ORDER BY T1.attendance desc
LIMIT 1;

