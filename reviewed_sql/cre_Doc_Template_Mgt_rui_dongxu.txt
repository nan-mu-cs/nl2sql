Total = # 42


1. Home many documents do we have?

select count(*)
from Documents

2. List document IDs, document names, and document descriptions for all documents.

select document_id, document_name, document_description
from Documents

3. What is the document name and template id for document with description with the letter 'w' in it?

select document_name, template_id
from Documents
where Document_Description LIKE "%w%"

4. What is the document id, template id and description for document named "Robbin CV"?

select document_id, template_id, Document_Description
from Documents
where document_name = "Robbin CV"

5. How many different templates do all document use?

select count(distinct template_id)
from Documents

6. How many documents are using the template with type code 'PPT'?

select count(*)
from Documents as T1 JOIN Templates as T2
on T1.Template_ID = T2.Template_ID
where T2.Template_Type_Code = 'PPT'

7. Show all template ids and number of documents using each template.

select template_id, count(*)
from Documents
group by template_id

8. What is the id and type code for the template used by most number of documents?

select T1.template_id, T2.Template_Type_Code
from Documents as T1 join Templates as T2
on T1.template_id = T2.template_id
group by T1.template_id
order by count(*) desc
limit 1

9. Show ids for all templates that are used by more than one document.

select template_id
from Documents
group by template_id
having count(*) > 1

10. Show ids for all templates not used by any document.

select template_id
from Templates
EXCEPT
select template_id
from Documents

11. How many templates do we have?

select count(*)
from Templates

12. Show template ids, version numbers, and template type codes for all templates.

select template_id, version_number, template_type_code
from Templates

13. Show all distinct template type codes for all templates.

select distinct template_type_code
from Templates

14. What are the ids of templates with template type code PP or PPT?

select template_id
from Templates
where template_type_code = "PP" or template_type_code = "PPT"

15. How many templates have template type code CV?

select count(*)
from Templates
where template_type_code = "CV"

16. What is the version number and template type code for the template with version number later than 5?

select version_number, template_type_code
from Templates
where version_number > 5

17. Show all template type codes and number of templates for each.

select template_type_code, count(*)
from Templates
group by template_type_code

18. Which template type code has most number of templates?

select template_type_code
from Templates
group by template_type_code
order by count(*) desc
limit 1

19. Show all template type codes with less than three templates.

select template_type_code
from Templates
group by template_type_code
having count(*) < 3

20. What the smallest version number and its template type code ?

select min(Version_Number), template_type_code
from Templates

21. What is the template type code of the template used by document with name "Data base"?

select T1.template_type_code
from Templates as T1 join Documents as T2 on T1.template_id = T2.template_id
where T2.document_name = "Data base"

22. Show all document names using templates with template type code BK.

select T2.document_name
from Templates as T1 join Documents as T2 on T1.template_id = T2.template_id
where T1.template_type_code = "BK"

23. Show all template type codes and the number of documents using each type.

select T1.template_type_code, count(*)
from Templates as T1 join Documents as T2 on T1.template_id = T2.template_id
group by T1.template_type_code

24. Which template type code is used by most number of documents?

select T1.template_type_code
from Templates as T1 join Documents as T2 on T1.template_id = T2.template_id
group by T1.template_type_code
order by count(*) desc
limit 1

25. Show all template type codes that are not used by any document.


select template_type_code
from Templates
EXCEPT
select template_type_code
from Templates as T1 join Documents as T2 on T1.template_id = T2.template_id

26. Show all template type codes and descriptions.

select template_type_code, template_type_description
from Ref_template_types

27. What is the template type descriptions for template type code "AD".

select template_type_description
from Ref_template_types
where template_type_code = "AD"

28. What is the template type code for template type description "Book".

select template_type_code
from Ref_template_types
where template_type_description = "Book"

29. What are the distinct template type descriptions for the templates ever used by any document?

select distinct T1.template_type_description
from Ref_template_types as T1 join Templates as T2 on T1.template_type_code =T2.template_type_code
join Documents as T3
on T2.Template_ID = T3.template_ID

30. What are the template ids with template type description "Presentation".

select T2.template_id
from Ref_template_types as T1 join Templates as T2 on T1.template_type_code =T2.template_type_code
where T1.template_type_description = "Presentation"

31. How many paragraphs in total?

select count(*)
from Paragraphs

32. How many paragraphs for the document with name 'Summer Show' ?

select count(*)
from Paragraphs as T1 join Documents as T2
on T1.document_ID = T2.document_ID
where T2.document_name = 'Summer Show'

33. Show paragraph details for paragraph with text 'Korea'

select Other_Details
from Paragraphs
where paragraph_text = 'Korea'

34. Show all paragraph ids and texts for the document with name 'Welcome to NY'.

select T1.paragraph_id,  T1.paragraph_text
from Paragraphs as T1 join Documents as T2
on T1.document_id = T2.document_id
where T2.Document_Name = 'Welcome to NY'

35. Show all paragraph texts for the document "Customer reviews".

select T1.paragraph_text
from Paragraphs as T1 join Documents as T2 on T1.document_id = T2.document_id
where T2.document_name = "Customer reviews"

36. Show all document ids and the number of paragraphs in each document. Order by document id.

select document_id, count(*)
from Paragraphs
group by document_id
order by document_id

37. Show all document ids, names and the number of paragraphs in each document.

select T1.document_id, T2.document_name, count(*)
from Paragraphs as T1 join Documents as T2 on T1.document_id = T2.document_id
group by T1.document_id

38. List all document ids with at least two paragraphs.

select document_id
from Paragraphs
group by document_id
having count(*) >= 2

39. What is the document id and name with most number of paragraphs?

select T1.document_id, T2.document_name
from Paragraphs as T1 join Documents as T2 on T1.document_id = T2.document_id
group by T1.document_id
order by count(*) desc
limit 1

40. What is the document id with least number of paragraphs?

select document_id
from Paragraphs
group by document_id
order by count(*) asc
limit 1

41. What is the document id with 1 to 2 paragraphs?

select document_id
from Paragraphs
group by document_id
having count(*) between 1 and 2

42. Show the document id with paragraph text 'Brazil' and 'Ireland'.

select document_id
from Paragraphs
where paragraph_text = 'Brazil'
intersect
select document_id
from Paragraphs
where paragraph_text = 'Ireland'