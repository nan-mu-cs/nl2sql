1. How many book clubs are there?

select count(*)
from book_club

2. show book title, author or editor for all books after year 1989.

select book_title, author_or_editor
from book_club
where year > 1989

3. Show all distinct publishers for books.

select distinct publisher
from book_club

4. Show year, book title, and publisher for all books in descending order of year.

select year, book_title, publisher
from book_club
order by year desc

5. Show  all publishers and the number of books by each publisher.

select publisher, count(*)
from book_club
group by publisher

6. What is the publisher with most number of books?

select publisher
from book_club
group by publisher
order by count(*) desc
limit 1

7. Show all book categories and the number of year for each category.

select category, count(*)
from book_club
group by category

8. List categories with at least two books after year 1989.

select category
from book_club
where year > 1989
group by category
having count(*) >= 2

9. Show publishers with a book published in 1989 and a book in 1990.

select publisher
from book_club
where year = 1989
intersect
select publisher
from book_club
where year = 1990

10. Show all publishers which do not have a book in 1989.

select publisher
from book_club
except
select publisher
from book_club
where year = 1989

11. Show all movie title, year, and director in order by budget.

select title, year, director
from movie
order by budget_million

12. How many movie directors are there?

select count (distinct director)
from movie

13. What is the title and director for the movie with most worldwide gross in year 2000 or before?

select title, director
from movie
where year <= 2000
order by gross_worldwide desc
limit 1

14. Show all director names who have a movie in both year 1999 and 2000.

select director
from movie
where year = 2000
intersect
select director
from movie
where year = 1999

15. Show all director names who have a movie in year 1999 or 2000.

select director
from movie
where year = 1999 or year = 2000

16. What is the average, maximum, and minimum budget for all movies before 2000.

select avg(budget_million), max(budget_million), min(budget_million)
from movie
where year < 2000

17. Show all movie titles which do not have an associated culture company.

select title
from movie
where movie_id not in (select movie_id from movie)

18. Show movie title and book title for all companies in China.

select T1.title, T3.book_title
from movie as T1 join culture_company as T2 on T1.movie_id = T2.movie_id join book_club as T3 on T3.book_club_id = T2.book_club_id
where T2.incorporated_in = 'China'

19. Show all company names with a movie directed in year 1999.

select T2.company_name
from movie as T1 join culture_company as T2 on T1.movie_id = T2.movie_id
where T1.year = 1999

20. List all company names with a book published by Alyson.

select T1.company_name
from culture_company as T1 join book_club as T2 on T1.book_club_id = T2.book_club_id
where T2.publisher = 'Alyson'
