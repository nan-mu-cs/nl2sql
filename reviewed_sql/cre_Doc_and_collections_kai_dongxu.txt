Total # = 40

1. List all collections' subset. List the subsets' names.

SELECT Collection_Subset_Name FROM Collection_Subsets;

2. What is detail of collection subset with name 'Top collection'?

SELECT Collecrtion_Subset_Details
FROM Collection_Subsets
WHERE Collection_Subset_Name="Top collection";

3. List all documents's subset. List the subset's name.

SELECT Document_Subset_Name FROM Document_Subsets;

4. What is the detail of document subset with name 'Best for 2000'?

SELECT Document_Subset_Details
FROM Document_Subsets
WHERE Document_Subset_Name="Best for 2000";

5. List document id of all documents.

SELECT Document_Object_ID FROM Document_Objects;

6. What is the parent document of document owned by Marlin? List the document id.

SELECT Parent_Document_Object_ID
FROM Document_Objects
WHERE Owner = 'Marlin'

7. What is the owner of document with the Description 'Braeden Collection'?

SELECT Owner
FROM Document_Objects
WHERE Description = 'Braeden Collection'

8. What is the owner of the parent document of document owned by 'Marlin'?

SELECT T2.Owner
FROM Document_Objects AS T1 JOIN Document_Objects AS T2 ON T1.Parent_Document_Object_ID=T2.Document_Object_ID
WHERE T1.Owner = 'Marlin'

9. What are the different descriptions of all the parent documents?

SELECT distinct T2.Description
FROM Document_Objects AS T1 JOIN Document_Objects AS T2 ON T1.Parent_Document_Object_ID=T2.Document_Object_ID

10. How many documents owned by Marlin?

SELECT count(*)
FROM Document_Objects
WHERE Owner="Marlin";

11. List all documents ids that are not the parent of other documents.

SELECT Document_Object_ID
FROM Document_Objects
EXCEPT
SELECT Parent_Document_Object_ID
from Document_Objects

12. How many child documents does each parent document has? List the document id and the number.

SELECT T2.Document_Object_ID, count(*)
FROM Document_Objects AS T1 JOIN Document_Objects AS T2 ON T1.Parent_Document_Object_ID=T2.Document_Object_ID
group by T2.Document_Object_ID;

13. List the name of all collections.
SELECT Collection_Name FROM Collections;

14. What is the description of collection named Best?

SELECT Collection_Description
FROM Collections
WHERE Collection_Name="Best";

15. What is the name of the parent collection of the collection named Nice? 

SELECT T2.Collection_Name
FROM Collections AS T1 JOIN Collections AS T2 ON T1. Parent_Collection_ID=T2.Collection_ID
WHERE T1.Collection_Name="Nice";

16. Which collection is not the parent of other collection? List the collection's name.

SELECT Collection_Name
FROM Collections
EXCEPT
SELECT T2.Collection_Name
FROM Collections AS T1 JOIN Collections AS T2 ON T1. Parent_Collection_ID=T2.Collection_ID;

17. List document that have more than one child. List the document id.

SELECT T2.Document_Object_ID
FROM Document_Objects AS T1 JOIN Document_Objects AS T2 ON T1.Parent_Document_Object_ID=T2.Document_Object_ID
GROUP BY T2.Document_Object_ID
HAVING count(*) > 1;

18. How many child collection does the collection named Best has?

SELECT count(*)
FROM Collections AS T1 JOIN Collections AS T2 ON T1. Parent_Collection_ID=T2.Collection_ID
WHERE T2.Collection_Name="Best";

19. List all document which is related to document owned by Ransom. List the document id.

SELECT T1.Related_Document_Object_ID
FROM Document_Subset_Members as T1 join Document_Objects as T2
on T1.Document_Object_ID = T2.Document_Object_ID
WHERE T2.Owner = 'Ransom'


20. List collection subset id, name and number of collections in each subset.

SELECT T2.Collection_Subset_ID, T1.Collection_Subset_Name, count(*)
FROM Collection_Subsets as T1 JOIN Collection_Subset_Members as T2
ON T1.Collection_Subset_ID= T2.Collection_Subset_ID
GROUP BY T2.Collection_Subset_ID;

21. Which document has most of child? List the document id and the number of child.

SELECT T2.Document_Object_ID, count(*)
FROM Document_Objects AS T1 JOIN Document_Objects AS T2 ON T1.Parent_Document_Object_ID=T2.Document_Object_ID
GROUP BY T2.Document_Object_ID
ORDER BY count(*) DESC
LIMIT 1;


22. Which document has least number of related documents? List the document id and the number of related documents.

SELECT Document_Object_ID,count(*)
FROM Document_Subset_Members
GROUP BY Document_Object_ID
ORDER BY count(*) ASC
LIMIT 1;


23. Which document has between 2 and 4 number of related documents? List the document id and the number of related documents.

SELECT Document_Object_ID,count(*)
FROM Document_Subset_Members
GROUP BY Document_Object_ID
Having count(*) between 2 and 4;


24. List all owner of documents that is related to documents owned by Braeden.

SELECT DISTINCT Owner
FROM Document_Subset_Members as T1 JOIN Document_Objects as T2
ON T1.Related_Document_Object_ID = T2.Document_Object_ID
WHERE T2.Owner = 'Braeden';

25. Which unique subset does document owned by Braeden belong to? List the subset name.

SELECT distinct T1.Document_Subset_Name
FROM Document_Subsets as T1 JOIN Document_Subset_Members as T2
ON T1.Document_Subset_ID= T2.Document_Subset_ID
JOIN Document_Objects as T3
on T2.Document_Object_ID = T3.Document_Object_ID
WHERE T3.owner = 'Braeden'

26. List subset id, name and number of different documents in each subset.

SELECT T1.Document_Subset_ID, T2.Document_Subset_Name,count(distinct T1.Document_Object_ID)
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2
ON T1.Document_Subset_ID= T2.Document_Subset_ID
GROUP BY T1.Document_Subset_ID;

27. Which document subset has most of number of distinct documents? List subset id, name and number of documents.

SELECT T1.Document_Subset_ID, T2.Document_Subset_Name,count(distinct T1.Document_Object_ID)
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2
ON T1.Document_Subset_ID= T2.Document_Subset_ID
GROUP BY T1.Document_Subset_ID
ORDER BY count(distinct T1.Document_Object_ID) DESC
LIMIT 1;

28. For document subset named 'Best for 2000', List all document id that in this subset.

SELECT DISTINCT T1.Document_Object_ID
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2 ON T1.Document_Subset_ID= T2.Document_Subset_ID
WHERE T2.Document_Subset_Name="Best for 2000";

29. List all document subsets of documents that related to each document id. List the name of document subset and the document id.

SELECT distinct T3.Document_Subset_Name, T1.Document_Object_ID
FROM Document_Subset_Members AS T1 JOIN Document_Subset_Members  AS T2 
ON T1.Related_Document_Object_ID=T2.Document_Object_ID 
JOIN Document_Subsets as T3
ON T2.Document_Subset_ID= T3.Document_Subset_ID

30. List the Collection_Name that document owned by 'Ransom' belong to.

SELECT T1.Collection_Name
FROM Collections as T1 JOIN Documents_in_Collections as T2
ON T1.Collection_ID=T2.Collection_ID
join Document_Objects as T3
on T2.Document_object_id = T3.Document_object_id 
WHERE T3.owner = 'Ransom'

31. How many collections does each document belong to? List the count and the document id.

SELECT count(*), T2.Document_Object_ID
FROM Collections as T1 JOIN Documents_in_Collections as T2
ON T1.Collection_ID=T2.Collection_ID
group by T2.Document_Object_ID

32. How many documents does collection named 'Best' has?

SELECT count(*)
FROM Collections as T1 JOIN Documents_in_Collections as T2 ON T1.Collection_ID=T2.Collection_ID
WHERE T1.Collection_Name="Best";

33. List the document id of all documents in collection named Best.

SELECT T2.Document_Object_ID
FROM Collections as T1 JOIN Documents_in_Collections as T2 ON T1.Collection_ID=T2.Collection_ID
WHERE T1.Collection_Name="Best";

34. Which collection have most number of documents? List collection name, id and number of documents.

SELECT T1.Collection_Name, T1.Collection_ID, count(*)
FROM Collections as T1 JOIN Documents_in_Collections as T2 ON T1.Collection_ID=T2.Collection_ID
WHERE T1.Collection_Name="Best"
GROUP BY T1.Collection_ID
ORDER BY count(*) DESC
LIMIT 1;

35.List id of documents that in document subset Best for 2000 and collection named Best.


SELECT DISTINCT T1.Document_Object_ID
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2
ON T1.Document_Subset_ID= T2.Document_Subset_ID
JOIN Documents_in_Collections T3
on T1.Document_Object_ID = T3.Document_Object_ID
JOIN Collections as T4
on T3.Collection_ID = T4.Collection_ID
WHERE T2.Document_Subset_Name="Best for 2000" and T4.Collection_Name="Best";

36.List id of documents that in collection named Best but not in document subset Best for 2000.

SELECT DISTINCT T2.Document_Object_ID
FROM Collections as T1 JOIN Documents_in_Collections as T2 ON T1.Collection_ID=T2.Collection_ID
WHERE T1.Collection_Name="Best"
EXCEPT
SELECT DISTINCT T1.Document_Object_ID
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2 ON T1.Document_Subset_ID= T2.Document_Subset_ID
WHERE T2.Document_Subset_Name="Best for 2000"


37.List id of documents that in document subset Best for 2000 or in collection named Best. 

SELECT DISTINCT T1.Document_Object_ID
FROM Document_Subset_Members as T1 JOIN Document_Subsets as T2
ON T1.Document_Subset_ID= T2.Document_Subset_ID
JOIN Documents_in_Collections T3
on T1.Document_Object_ID = T3.Document_Object_ID
JOIN Collections as T4
on T3.Collection_ID = T4.Collection_ID
WHERE T2.Document_Subset_Name="Best for 2000" or T4.Collection_Name="Best";

38. List all name of collections that are related to collection named Best.

SELECT distinct T4.Collection_Name
FROM Collection_Subset_Members AS T1 JOIN Collection_Subset_Members AS T2 ON T1.Related_Collection_ID=T2.Collection_ID 
JOIN Collections AS T3 
ON T1.Collection_ID=T3.Collection_ID 
JOIN Collections AS T4 ON 
T2.Collection_ID=T4.Collection_ID
WHERE T3.Collection_Name="Best";

39. How many collections that are related to collection named Best?

SELECT count(distinct T1.Related_Collection_ID)
FROM Collection_Subset_Members as T1 JOIN Collections as T2 
ON T1.Collection_ID = T2.Collection_ID
WHERE T2.Collection_Name="Best";

40.Which collection subset does collection name Best in? List collection subset name.

SELECT DISTINCT T1.Collection_Subset_Name
FROM Collection_Subsets as T1 JOIN Collection_Subset_Members as T2
ON T1.Collection_Subset_ID= T2.Collection_Subset_ID 
JOIN Collections as T3
ON T2.Collection_ID= T3.Collection_ID
WHERE T3.Collection_Name="Best";
 
