Total = # 40


1. How many agencies do we have?


select count(*)
from Agencies


2. Show all agency ids and details.


select agency_id, agency_details
from Agencies
________________


3. Show the number of clients.


select count(*)
from Clients


4. List all client ids and client details.


select client_id, client_details
from Clients
________________


5. Show agency ids and the number of clients for each agent.


select agency_id, count(*)
from Clients
group by agency_id


6. What is the agent id with most number of clients?


select agency_id
from Clients
group by agency_id
order by count(*) desc
limit 1


7. Show agency ids with at least 2 clients.


select agency_id
from Clients
group by agency_id
having count(*) >= 2
________________


8. Show agency details for client with id 1.


select T2.agency_details
from Clients as T1 join Agencies as T2 on T1.agency_id = T2.agency_id
where T1.client_id = 1


9. Show ids for all clients of agent 1.


select T1.client_id
from Clients as T1 join Agencies as T2 on T1.agency_id = T2.agency_id
where T2.agency_id = 1
 
________________
10. Show all sic codes and the number of clients with each code.


select sic_code, count(*)
from Clients
group by sic_code


11. Show all client ids and details with sic code "Bad".


select client_id, client_details
from Clients
where sic_code = "Bad"
________________


12. Show all agency ids and details with a client.


select agency_id, agency_details
from Agencies
where agency_id IN (select agency_id from Clients)


13. Show all agency ids without any client.


select agency_id
from Agencies
EXCEPT
select agency_id
from Clients
________________


14. How many invoices do we have?


select count(*)
from Invoices


15. Show ids, status codes, and details for all invoices for client 15.


select invoice_id, invoice_status_code, invoice_details
from Invoices
where client_id = 15
________________


16. Show all client ids and the number of invoices for each client.


select client_id, count(*)
from Invoices
group by client_id


17. List the client id and detail with most number of invoices.


select T1.client_id, T2.client_details
from Invoices as T1 join Clients as T2 on T1.client_id = T2.client_id
group by T1.client_id
order by count(*) desc
limit 1


18. What are client ids with at least 2 invoices.


select client_id
from Invoices
group by client_id
having count(*) >= 2
________________


19. Show all invoice status codes and the number of invoices with each status.


select invoice_status_code, count(*)
from Invoices
group by invoice_status_code


20. What is the invoice status code with most number of invoices.


select invoice_status_code
from Invoices
group by invoice_status_code
order by count(*) desc
limit 1
________________


21. Show all invoice status codes and descriptions.


select invoice_status_code, invoice_status_description
from Ref_invoice_status


22. List all meeting type codes and descriptions.


select meeting_type_code, meeting_type_description
from Ref_meeting_types


23. Show all meeting outcome codes and descriptions.


select meeting_outcome_code, meeting_outcome_description
from Ref_meeting_outcomes
________________


24. Show all payment ids and details for invoice 8.


select payment_id, payment_details
from Payments
where invoice_id = 8


25. Show all invoice ids without a payment.


select invoice_id
from Invoices
EXCEPT
select invoice_id
from Payments


26. How many payments do we have?


select count(*)
from Payments


27. List all payment ids with invoice ids and details.


select payment_id, invoice_id, payment_details
from Payments


28. Show all invoice ids with a payment.


select distinct invoice_id
from Payments


29. Show all invoice ids and the number of payments for each invoice.


select invoice_id, count(*)
from Payments
group by invoice_id


30. What is the invoice id, status code, and details for the invoice with most number of payments.


select T1.invoice_id, T2.invoice_status_code, T2.invoice_details
from Payments as T1 join Invoices as T2 on T1.invoice_id = T2.invoice_id
group by T1.invoice_id
order by count(*) desc
limit 1
31. How many staff do we have?


select count(*)
from Staff


32. Show the agency ids and the number of staff in each agent?


select agency_id, count(*)
from Staff
group by agency_id


33. What is the agent id and details for the agent with most number of staff?


select T1.agency_id, T2.agency_details
from Staff as T1 join Agencies as T2 on T1.agency_id = T2.agency_id
group by T1.agency_id
order by count(*) desc
limit 1
________________


34. Show meeting outcome codes and the number of meeting in each outcome.


select meeting_outcome_code, count(*)
from Meetings
group by meeting_outcome_code


35. List the client ids and the number of meeting for each client.


select client_id, count(*)
from Meetings
group by client_id


36. Show the meeting type codes and the number of meeting for each client.


select meeting_type_code, count(*)
from Meetings
group by meeting_type_code


37. Show all meeting ids with meeting outcome descriptions and meeting type descriptions.


select T1.meeting_id, T2.meeting_outcome_description, T3.meeting_type_description
from Meetings as T1 join Ref_meeting_outcomes as T2 on T1.meeting_outcome_code = T2.meeting_outcome_code join Ref_meeting_types as T3 on T1.meeting_type_code = T3.meeting_type_code


________________


38. Show the meeting ids and the number of staff in each meeting


select meeting_id, count(*)
from Staff_in_meetings
group by meeting_id


39. Show the staff ids and the number of meetings attended by each staff.


select staff_id, count(*)
from Staff_in_meetings
group by staff_id


40. How many staff have attended a meeting?


select count(distinct staff_id)
from Staff_in_meetings
