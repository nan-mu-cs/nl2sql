
Total # = 41


1. what is the name of the oldest pilot?

SELECT pilot_name
FROM PilotSkills 
ORDER BY age DESC
LIMIT 1

What are the pilots whose age is below the average age, and list their names ordered by their age?

SELECT pilot_name
FROM PilotSkills 
WHERE age < (select avg(age) from PilotSkills)
ORDER BY age

Find all information of the pilots whose age is under 30.

SELECT *
FROM PilotSkills 
WHERE age < 30

Find the names of all pilots who have plane Piper Cub and is under 35.

SELECT pilot_name
FROM PilotSkills 
WHERE age < 35 and plane_name = 'Piper Cub'

Where is the plane F-14 Fighter located?

SELECT location
FROM hangar 
WHERE plane_name = 'F-14 Fighter'

How many different places have some plane?

SELECT count(distinct location)
FROM hangar

Which plane does the pilot Jones with age 32 has?

SELECT plane_name
FROM pilotskills
WHERE pilot_name = 'Jones'  and age = 32

2. How many pilots who are older than 40? 

SELECT count(*)
FROM pilotskills
WHERE age > 40

How many plane B-52 Bomber owned by the pilot who is under 35?

SELECT count(*)
FROM pilotskills
WHERE age < 35 and plane_name = 'B-52 Bomber'

Who is the youngest pilot having plane Piper Cub?

SELECT pilot_name
FROM pilotskills
WHERE plane_name = 'Piper Cub'
ORDER BY age
LIMIT 1

What is the most popular plane?

SELECT plane_name
FROM pilotskills
GROUP BY plane_name
ORDER BY count(*) desc
LIMIT 1

What is the least popular plane?

SELECT plane_name
FROM pilotskills
GROUP BY plane_name
ORDER BY count(*)
LIMIT 1

How many pilots whose planes are in Chicago?

SELECT 	count(distinct T1.pilot_name)
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
WHERE T2.location = 'Chicago'

What are the planes owned by pilot Smith with age 41?

SELECT plane_name
FROM pilotskills 
WHERE pilot_name = 'Smith' and age = 41

How many distinct types of planes owned by all pilots?

SELECT count(distinct plane_name)
FROM pilotskills

How many planes owned by the pilot whose name is Smith?

SELECT count(plane_name)
FROM pilotskills
WHERE pilot_name = 'Smith'

How many planes are controlled by the pilots whose age is older than 40?

SELECT count(plane_name)
FROM pilotskills
WHERE age > 40

Find the names of all pilots with age between 30 and 40 sorted by their ages in ascending order.

SELECT pilot_name
FROM pilotskills
WHERE age between 30 and 40
ORDER BY age

3. List all pilot names sorted by their ages in the descending order.

SELECT pilot_name
FROM pilotskills
ORDER BY age desc

Find all locations of planes sorted by the plane name.

SELECT location
FROM hangar
ORDER BY plane_name

List all distinct types of planes owned by all pilots in alphabetic order?

SELECT distinct plane_name
FROM pilotskills
ORDER BY plane_name

4. How many pilots who are older than 40 or younger than 30?

SELECT count(pilot_name)
FROM pilotskills
ORDER BY age > 40 or age < 30

What are the names and ages of pilots who own plane Piper Cub and is older than 35 or have F-14 Fighter and younger than 30?

SELECT pilot_name, age
FROM pilotskills
where plane_name = 'Piper Cub' and age > 35
UNION
SELECT pilot_name, age
FROM pilotskills
where plane_name = 'F-14 Fighter' and age < 30

Find pilots who own plane Piper Cub but not B-52 Bomber.

SELECT pilot_name
FROM pilotskills
where plane_name = 'Piper Cub' 
EXCEPT
SELECT pilot_name
FROM pilotskills
where plane_name = 'B-52 Bomber'

Find pilots who own planes Piper Cub and B-52 Bomber.

SELECT pilot_name
FROM pilotskills
where plane_name = 'Piper Cub' 
INTERSECT
SELECT pilot_name
FROM pilotskills
where plane_name = 'B-52 Bomber'

What are the average and smallest ages of all pilots?

SELECT avg(age), min(age)
FROM pilotskills

What are the names of pilots who have planes in both Austin and Boston?

SELECT T1.pilot_name
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
WHERE T2.location = "Austin"
INTERSECT
SELECT T1.pilot_name
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
WHERE T2. location = "Boston"

Find the pilots who have either plane Piper Cub or plane F-14 Fighter.

SELECT pilot_name
FROM pilotskills
ORDER BY plane_name = 'Piper Cub' or plane_name = 'F-14 Fighter'

5. What is the average age of pilots for different types of planes?

SELECT avg(age), plane_name
FROM pilotskills
GROUP BY plane_name

Find the number of planes for each type.

SELECT count(*), plane_name
FROM pilotskills
GROUP BY plane_name

Find the name of the oldest pilot for each type of plane, and order the results by plane name.

SELECT pilot_name, plane_name
FROM pilotskills
GROUP BY plane_name
HAVING age = max(age)
ORDER BY plane_name

What are the names of oldest pilots for each type of plane?

SELECT pilot_name, plane_name
FROM pilotskills
GROUP BY plane_name
HAVING age = max(age)

Find the max age for each group of pilots with the same name.

SELECT max(age), pilot_name
FROM pilotskills
GROUP BY pilot_name

Find the number and average age of pilots who have a plane for each city.

SELECT count(T1.pilot_name), avg(T1.age), T2.location
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
GROUP BY T2.location

Find the number of pilots for the plane types with average pilot age below 35.

SELECT count(*), plane_name
FROM pilotskills
GROUP BY plane_name
HAVING avg(age) < 35

Find the location of the plane that is owned by the youngest pilot.

SELECT T2.location
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
WHERE T1.age = (select min(age) from pilotskills)

Find the name and age of pilots who have a plane in Austin.

SELECT T1.pilot_name, T1.age
FROM pilotskills as T1 JOIN hangar as T2 ON T1.plane_name = T2.plane_name
WHERE T2.location = "Austin"

6. List in alphabetic order the names of pilots whose age is greater than some pilots having plane Piper Cub.

SELECT pilot_name
FROM pilotskills
WHERE age > (select min(age) from pilotskills where plane_name = 'Piper Cub')
ORDER BY pilot_name

Find the number of pilots whose age is younger than all pilots whose plane is F-14 Fighter.

SELECT count(*)
FROM pilotskills
WHERE age < (select min(age) from pilotskills where plane_name = 'F-14 Fighter')

7. Find all different planes whose names contain substring 'Bomber'.

SELECT distinct plane_name
FROM pilotskills
WHERE plane_name LIKE '%Bomber%'

8. Find the number of all pilots whose age is older than some pilot who has plane Piper Cub.

SELECT count(pilot_name)
FROM pilotskills
WHERE age > (select min(age) from pilotskills where plane_name = 'Piper Cub')

Find the names and ages of all distinct pilots who is younger than the oldest pilot.

select distinct T1.pilot_name, T1.age
from pilotskills as T1, pilotskills as T2
where T1.age < T2.age


