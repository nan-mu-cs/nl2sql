reading labeled file for db:  manufacturer_1
reading labeled file for db:  bike_1
reading labeled file for db:  apartment_rentals
reading labeled file for db:  world_1
reading labeled file for db:  pets_1
reading labeled file for db:  department_store
reading labeled file for db:  college_3
reading labeled file for db:  e_commerce
reading labeled file for db:  sakila_1
reading labeled file for db:  loan_1
reading labeled file for db:  music_1
reading labeled file for db:  voter_2
db_id:  voter_2
question:  Find the average number of students per advisor.
sql:  SELECT avg(cnt) FROM (SELECT count(*) AS cnt FROM STUDENT GROUP BY Advisor)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  How many students does each advisor have on average?
sql:  SELECT avg(cnt) FROM (SELECT count(*) AS cnt FROM STUDENT GROUP BY Advisor)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  Report the distinct advisors who have between one and three students.
sql:  SELECT DISTINCT Advisor FROM (SELECT Advisor ,  COUNT(*) AS cnt FROM STUDENT GROUP BY Advisor) WHERE cnt  >=  1 AND cnt  <=  3
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  Which advisors are advising one to three students?
sql:  SELECT DISTINCT Advisor FROM (SELECT Advisor ,  COUNT(*) AS cnt FROM STUDENT GROUP BY Advisor) WHERE cnt  >=  1 AND cnt  <=  3
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

reading labeled file for db:  flight_2
db_id:  flight_2
question:  Find all airlines which have departure flights in all airports.
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.SourceAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Which airlines have departing flights from all airports?
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.SourceAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Find all airlines which have arriving flights in all airports.
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.DestAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Which airlines have arriving flights in all airports?
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.DestAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

reading labeled file for db:  book_1
db_id:  book_1
question:  What is the maximum difference between the sale price and purchase price?
sql:  SELECT max(saleprice-purchaseprice) FROM Book
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: saleprice-purchaseprice
None 

db_id:  book_1
question:  Return the largest difference in sale price and purchase price.
sql:  SELECT max(saleprice-purchaseprice) FROM Book
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: saleprice-purchaseprice
None 

reading labeled file for db:  soccer_2
db_id:  soccer_2
question:  Find the name of the tryout players who are from the college with largest size.
sql:  SELECT T2.pName FROM  tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID WHERE T1.cName  =  (SELECT cName FROM college ORDER BY enr DESC LIMIT 1) S: What IS the largest college? S: What ARE the NAMES OF players ARE FROM that college? S: OF those ,  who tried OUT FOR the team?
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: s
None 

db_id:  soccer_2
question:  What are the names of all tryout participants who are from the largest college?
sql:  SELECT T2.pName FROM  tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID WHERE T1.cName  =  (SELECT cName FROM college ORDER BY enr DESC LIMIT 1) S: What IS the largest college? S: What ARE the NAMES OF players ARE FROM that college? S: OF those ,  who tried OUT FOR the team?
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: s
None 

db_id:  soccer_2
question:  Find the names of all the players who have yCards AND hours less than some other Player.
sql:  SELECT DISTINCT T1.pName FROM Player AS T1 ,  Player AS T2 WHERE T1.yCard  =  "yes" AND T1.HS  <  T2.HS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the names of all the players who have yCards and practiced for less time than some other player?
sql:  SELECT DISTINCT T1.pName FROM Player AS T1 ,  Player AS T2 WHERE T1.yCard  =  "yes" AND T1.HS  <  T2.HS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  Find the states where have the colleges whose enrollments are less than the largest size.
sql:  SELECT DISTINCT T1.state FROM college AS T1 ,  college AS T2 WHERE T1.enr  <  T2.enr
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the states with colleges that have enrollments less than the some other college?
sql:  SELECT DISTINCT T1.state FROM college AS T1 ,  college AS T2 WHERE T1.enr  <  T2.enr
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  Find names of colleges with enrollment greater than that of some (at least one) college in the FL state.
sql:  SELECT DISTINCT T1.cName FROM college AS T1 ,  college AS T2 WHERE T1.enr  >  T2.enr AND T2.state  =  'FL'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the names of the colleges that are larger than at least one college in Florida?
sql:  SELECT DISTINCT T1.cName FROM college AS T1 ,  college AS T2 WHERE T1.enr  >  T2.enr AND T2.state  =  'FL'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  planet_1
reading labeled file for db:  cre_Doc_Template_Mgt
reading labeled file for db:  pilot_1
db_id:  pilot_1
question:  Find the names and ages of all distinct pilots who is younger than the oldest pilot.
sql:  SELECT DISTINCT T1.pilot_name ,  T1.age FROM pilotskills AS T1 ,  pilotskills AS T2 WHERE T1.age  <  T2.age
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  pilot_1
question:  What are the names and ages of pilots who are not the oldest pilot?
sql:  SELECT DISTINCT T1.pilot_name ,  T1.age FROM pilotskills AS T1 ,  pilotskills AS T2 WHERE T1.age  <  T2.age
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  college_1
reading labeled file for db:  allergy_1
db_id:  allergy_1
question:  How many female students have milk or egg allergies?
sql:  SELECT count(*) FROM has_allergy AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.sex  =  "F" AND (T1.allergy  =  "Milk" OR T1.allergy  =  "Eggs")
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 247, in parse_val_unit
    assert toks[idx] == ')'
AssertionError
None 

db_id:  allergy_1
question:  How many students who are female are allergic to milk or eggs?
sql:  SELECT count(*) FROM has_allergy AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.sex  =  "F" AND (T1.allergy  =  "Milk" OR T1.allergy  =  "Eggs")
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 247, in parse_val_unit
    assert toks[idx] == ')'
AssertionError
None 

reading labeled file for db:  hr_1
db_id:  hr_1
question:  display job Title, the difference between minimum and maximum salaries for those jobs which max salary within the range 12000 to 18000.
sql:  SELECT job_title ,  max_salary-min_salary FROM jobs WHERE max_salary BETWEEN 12000 AND 18000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: max_salary-min_salary
None 

db_id:  hr_1
question:  What are the job titles, and range of salaries for jobs with maximum salary between 12000 and 18000?
sql:  SELECT job_title ,  max_salary-min_salary FROM jobs WHERE max_salary BETWEEN 12000 AND 18000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: max_salary-min_salary
None 

db_id:  hr_1
question:  display job ID for those jobs that were done by two or more for more than 300 days.
sql:  SELECT job_id FROM job_history WHERE end_date-start_date  > 300 GROUP BY job_id HAVING COUNT(*) >= 2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: end_date-start_date
None 

db_id:  hr_1
question:  What are the job ids for jobs done more than once for a period of more than 300 days?
sql:  SELECT job_id FROM job_history WHERE end_date-start_date  > 300 GROUP BY job_id HAVING COUNT(*) >= 2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: end_date-start_date
None 

db_id:  hr_1
question:  Find employee with ID and name of the country presently where (s)he is working.
sql:  SELECT employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  What are all the employee ids and the names of the countries in which they work?
sql:  SELECT employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  Can you return all detailed info of jobs which was done by any of the employees who is presently earning a salary on and above 12000?
sql:  SELECT T1.* FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

db_id:  hr_1
question:  What is all the job history info done by employees earning a salary greater than or equal to 12000?
sql:  SELECT T1.* FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

db_id:  hr_1
question:  display the employee ID and job name for all those jobs in department 80.
sql:  SELECT T1.employee_id ,  T2.job_title FROM employees T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't1'
None 

db_id:  hr_1
question:  what are the employee ids and job titles for employees in department 80?
sql:  SELECT T1.employee_id ,  T2.job_title FROM employees T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't1'
None 

db_id:  hr_1
question:  display the full name (first and last name ) of employee with ID and name of the country presently where (s)he is working.
sql:  SELECT first_name ,  last_name ,  employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  What the full names, ids of each employee and the name of the country they are in?
sql:  SELECT first_name ,  last_name ,  employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

reading labeled file for db:  flight_1
db_id:  flight_1
question:  Show names for all aircrafts with distance at least a quarter of the maximum.
sql:  SELECT name FROM Aircraft WHERE distance  >=  (SELECT max(distance)/4 FROM Aircraft)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 329, in parse_condition
    idx, val1 = parse_value(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 279, in parse_value
    idx, val = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: /4
None 

db_id:  flight_1
question:  What are the names of all aircrafts that have a distance of at least a quarter of the maximum?
sql:  SELECT name FROM Aircraft WHERE distance  >=  (SELECT max(distance)/4 FROM Aircraft)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 329, in parse_condition
    idx, val1 = parse_value(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 279, in parse_value
    idx, val = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: /4
None 

reading labeled file for db:  car_1
db_id:  car_1
question:  How many countries has more than 2 car makers?
sql:  SELECT COUNT(*) FROM ( SELECT T1.CountryId ,  COUNT(*) FROM COUNTRIES AS T1 ,  CAR_MAKERS AS T2 WHERE T1.CountryId  =  T2.Country GROUP BY T1.CountryId HAVING count(*)  >  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  car_1
question:  What is the number of countries with more than 2 car makers?
sql:  SELECT COUNT(*) FROM ( SELECT T1.CountryId ,  COUNT(*) FROM COUNTRIES AS T1 ,  CAR_MAKERS AS T2 WHERE T1.CountryId  =  T2.Country GROUP BY T1.CountryId HAVING count(*)  >  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 388, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  cre_Drama_Workshop_Groups
reading labeled file for db:  customers_card_transactions
reading labeled file for db:  cre_Docs_and_Epenses
reading labeled file for db:  address_1
reading labeled file for db:  scientist_1
reading labeled file for db:  dorm_1
db_id:  dorm_1
question:  Find the first name of students who are living in the dorm that has most number of amenities.
sql:  SELECT T1.fname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T2.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid GROUP BY T2.dormid ORDER BY count(*) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'dorm.stuid'
None 

db_id:  dorm_1
question:  What are the first names of all students who live in the dorm with the most amenities?
sql:  SELECT T1.fname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T2.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid GROUP BY T2.dormid ORDER BY count(*) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'dorm.stuid'
None 

db_id:  dorm_1
question:  Find the first and last name of students who are living in the dorms that have amenity TV Lounge.
sql:  SELECT T1.fname ,  T1.lname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  What are the first and last names of all students who are living in a dorm with a TV Lounge?
sql:  SELECT T1.fname ,  T1.lname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  Find the first name and age of students who are living in the dorms that do not have amenity TV Lounge.
sql:  SELECT T1.fname ,  T1.age FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid NOT IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  What is the first name and age of every student who lives in a dorm with a TV Lounge?
sql:  SELECT T1.fname ,  T1.age FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid NOT IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 398, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

reading labeled file for db:  wine_1
db_id:  wine_1
question:  Find the distinct names of all wines that have prices higher than some wines from John Anthony winery.
sql:  SELECT DISTINCT T1.Name FROM WINE AS T1 ,  WINE AS T2 WHERE T1.Price  >  T2.Price AND T2.Winery  =  "John Anthony"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  wine_1
question:  What are the distinct names of wines with prices higher than any wine from John Anthony winery.
sql:  SELECT DISTINCT T1.Name FROM WINE AS T1 ,  WINE AS T2 WHERE T1.Price  >  T2.Price AND T2.Winery  =  "John Anthony"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  wta_1
reading labeled file for db:  chinook_1
reading labeled file for db:  e_learning
reading labeled file for db:  insurance_policies
db_id:  insurance_policies
question:  Find the total claimed amount of all the claims.
sql:  SELECT sum(Amount_Claimed) FROM Claims
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: amount_claimed
None 

db_id:  insurance_policies
question:  What is total amount claimed summed across all the claims?
sql:  SELECT sum(Amount_Claimed) FROM Claims
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 509, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 361, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: amount_claimed
None 

reading labeled file for db:  hospital_1
db_id:  hospital_1
question:  What is the name of the patient who made the most recent appointment?
sql:  SELECT T1.name FROM patient AS T1 ,  appointment AS T2 WHERE T1.ssn = T2.patient ORDER BY T2.start DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  hospital_1
question:  Find the name of the patient who made the appointment with the most recent start date.
sql:  SELECT T1.name FROM patient AS T1 ,  appointment AS T2 WHERE T1.ssn = T2.patient ORDER BY T2.start DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 506, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 259, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  hospital_1
question:  List the physicians' employee ids together with their primary affiliation departments' ids.
sql:  SELECT physician ,  department FROM affiliated_with WHERE primaryaffiliation
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 315, in parse_condition
    if toks[idx] == 'not':
IndexError: list index out of range
None 

db_id:  hospital_1
question:  What are each physician's employee id and department id primarily affiliated.
sql:  SELECT physician ,  department FROM affiliated_with WHERE primaryaffiliation
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 315, in parse_condition
    if toks[idx] == 'not':
IndexError: list index out of range
None 

reading labeled file for db:  aan_1
reading labeled file for db:  products_gen_characteristics
reading labeled file for db:  boat_1
reading labeled file for db:  art_1
reading labeled file for db:  real_estate_rentals
reading labeled file for db:  flight_4
reading labeled file for db:  activity_1
reading labeled file for db:  customers_and_orders
reading labeled file for db:  warehouse_1
reading labeled file for db:  dog_kennels
reading labeled file for db:  bakery_1
reading labeled file for db:  store_1
reading labeled file for db:  inn_1
reading labeled file for db:  network_1
reading labeled file for db:  movie_2
reading labeled file for db:  small_bank_1
reading labeled file for db:  cre_Theme_park
reading labeled file for db:  college_2
reading labeled file for db:  customers_and_addresses
db_id:  customers_and_addresses
question:  Find the names of customers who never ordered product Latte.
sql:  SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 538, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

db_id:  customers_and_addresses
question:  What are names of customers who never ordered product Latte.
sql:  SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 552, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 538, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 418, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 313, in parse_condition
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 240, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

reading labeled file for db:  game_1
reading labeled file for db:  advertising_agencies
