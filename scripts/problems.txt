reading labeled file for db:  manufacturer_1
reading labeled file for db:  bike_1
reading labeled file for db:  apartment_rentals
reading labeled file for db:  world_1
reading labeled file for db:  pets_1
reading labeled file for db:  department_store
reading labeled file for db:  college_3
reading labeled file for db:  e_commerce
reading labeled file for db:  sakila_1
reading labeled file for db:  loan_1
reading labeled file for db:  music_1
reading labeled file for db:  voter_2
db_id:  voter_2
question:  Find the average number of students per advisor.
sql:  SELECT avg(cnt) FROM (SELECT count(*) AS cnt FROM STUDENT GROUP BY Advisor)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  How many students does each advisor have on average?
sql:  SELECT avg(cnt) FROM (SELECT count(*) AS cnt FROM STUDENT GROUP BY Advisor)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  Report the distinct advisors who have between one and three students.
sql:  SELECT DISTINCT Advisor FROM (SELECT Advisor ,  COUNT(*) AS cnt FROM STUDENT GROUP BY Advisor) WHERE cnt  >=  1 AND cnt  <=  3
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

db_id:  voter_2
question:  Which advisors are advising one to three students?
sql:  SELECT DISTINCT Advisor FROM (SELECT Advisor ,  COUNT(*) AS cnt FROM STUDENT GROUP BY Advisor) WHERE cnt  >=  1 AND cnt  <=  3
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: as
None 

reading labeled file for db:  flight_2
db_id:  flight_2
question:  Find all airlines which have departure flights in all airports.
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.SourceAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Which airlines have departing flights from all airports?
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.SourceAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Find all airlines which have arriving flights in all airports.
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.DestAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

db_id:  flight_2
question:  Which airlines have arriving flights in all airports?
sql:  SELECT DISTINCT AIRLINES.Airline FROM AIRLINES WHERE NOT EXISTS ( SELECT DISTINCT AIRPORTS.AirportCode FROM AIRPORTS EXCEPT SELECT DISTINCT FLIGHTS.DestAirport FROM FLIGHTS WHERE AIRLINES.uid  =  FLIGHTS.Airline)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: not
None 

reading labeled file for db:  book_1
db_id:  book_1
question:  What is the maximum difference between the sale price and purchase price?
sql:  SELECT max(saleprice-purchaseprice) FROM Book
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: saleprice-purchaseprice
None 

db_id:  book_1
question:  Return the largest difference in sale price and purchase price.
sql:  SELECT max(saleprice-purchaseprice) FROM Book
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: saleprice-purchaseprice
None 

reading labeled file for db:  soccer_2
db_id:  soccer_2
question:  Find the name of the tryout players who are from the college with largest size.
sql:  SELECT T2.pName FROM  tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID WHERE T1.cName  =  (SELECT cName FROM college ORDER BY enr DESC LIMIT 1) S: What IS the largest college? S: What ARE the NAMES OF players ARE FROM that college? S: OF those ,  who tried OUT FOR the team?
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: s
None 

db_id:  soccer_2
question:  What are the names of all tryout participants who are from the largest college?
sql:  SELECT T2.pName FROM  tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID WHERE T1.cName  =  (SELECT cName FROM college ORDER BY enr DESC LIMIT 1) S: What IS the largest college? S: What ARE the NAMES OF players ARE FROM that college? S: OF those ,  who tried OUT FOR the team?
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: s
None 

db_id:  soccer_2
question:  Find the names of all the players who have yCards AND hours less than some other Player.
sql:  SELECT DISTINCT T1.pName FROM Player AS T1 ,  Player AS T2 WHERE T1.yCard  =  "yes" AND T1.HS  <  T2.HS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the names of all the players who have yCards and practiced for less time than some other player?
sql:  SELECT DISTINCT T1.pName FROM Player AS T1 ,  Player AS T2 WHERE T1.yCard  =  "yes" AND T1.HS  <  T2.HS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  Find the states where have the colleges whose enrollments are less than the largest size.
sql:  SELECT DISTINCT T1.state FROM college AS T1 ,  college AS T2 WHERE T1.enr  <  T2.enr
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the states with colleges that have enrollments less than the some other college?
sql:  SELECT DISTINCT T1.state FROM college AS T1 ,  college AS T2 WHERE T1.enr  <  T2.enr
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  Find names of colleges with enrollment greater than that of some (at least one) college in the FL state.
sql:  SELECT DISTINCT T1.cName FROM college AS T1 ,  college AS T2 WHERE T1.enr  >  T2.enr AND T2.state  =  'FL'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  soccer_2
question:  What are the names of the colleges that are larger than at least one college in Florida?
sql:  SELECT DISTINCT T1.cName FROM college AS T1 ,  college AS T2 WHERE T1.enr  >  T2.enr AND T2.state  =  'FL'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  planet_1
db_id:  planet_1
question:  List the dates of all shipments.
sql:  SELECT Date FROM Shipment;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  planet_1
question:  What are the dates of every shipment in the database?
sql:  SELECT Date FROM Shipment;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  planet_1
question:  Find the number of employees who do not have clearance in Mars.
sql:  SELECT count(*) FROM Employee WHERE Name NOT IN ( SELECT T2.Name FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee = T2.EmployeeID JOIN Planet AS T3 ON T1.Planet = T3.PlanetID WHERE T3.Name = "Mars" );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  planet_1
question:  What is the number of employees that do not have clearance on Mars?
sql:  SELECT count(*) FROM Employee WHERE Name NOT IN ( SELECT T2.Name FROM Has_Clearance AS T1 JOIN Employee AS T2 ON T1.Employee = T2.EmployeeID JOIN Planet AS T3 ON T1.Planet = T3.PlanetID WHERE T3.Name = "Mars" );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

reading labeled file for db:  cre_Doc_Template_Mgt
reading labeled file for db:  pilot_1
db_id:  pilot_1
question:  Find the names and ages of all distinct pilots who is younger than the oldest pilot.
sql:  SELECT DISTINCT T1.pilot_name ,  T1.age FROM pilotskills AS T1 ,  pilotskills AS T2 WHERE T1.age  <  T2.age
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  pilot_1
question:  What are the names and ages of pilots who are not the oldest pilot?
sql:  SELECT DISTINCT T1.pilot_name ,  T1.age FROM pilotskills AS T1 ,  pilotskills AS T2 WHERE T1.age  <  T2.age
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  college_1
reading labeled file for db:  allergy_1
db_id:  allergy_1
question:  How many female students have milk or egg allergies?
sql:  SELECT count(*) FROM has_allergy AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.sex  =  "F" AND (T1.allergy  =  "Milk" OR T1.allergy  =  "Eggs")
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    assert toks[idx] == ')'
AssertionError
None 

db_id:  allergy_1
question:  How many students who are female are allergic to milk or eggs?
sql:  SELECT count(*) FROM has_allergy AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.sex  =  "F" AND (T1.allergy  =  "Milk" OR T1.allergy  =  "Eggs")
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    assert toks[idx] == ')'
AssertionError
None 

reading labeled file for db:  hr_1
db_id:  hr_1
question:  display job Title, the difference between minimum and maximum salaries for those jobs which max salary within the range 12000 to 18000.
sql:  SELECT job_title ,  max_salary-min_salary FROM jobs WHERE max_salary BETWEEN 12000 AND 18000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: max_salary-min_salary
None 

db_id:  hr_1
question:  What are the job titles, and range of salaries for jobs with maximum salary between 12000 and 18000?
sql:  SELECT job_title ,  max_salary-min_salary FROM jobs WHERE max_salary BETWEEN 12000 AND 18000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: max_salary-min_salary
None 

db_id:  hr_1
question:  display job ID for those jobs that were done by two or more for more than 300 days.
sql:  SELECT job_id FROM job_history WHERE end_date-start_date  > 300 GROUP BY job_id HAVING COUNT(*) >= 2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: end_date-start_date
None 

db_id:  hr_1
question:  What are the job ids for jobs done more than once for a period of more than 300 days?
sql:  SELECT job_id FROM job_history WHERE end_date-start_date  > 300 GROUP BY job_id HAVING COUNT(*) >= 2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: end_date-start_date
None 

db_id:  hr_1
question:  Find employee with ID and name of the country presently where (s)he is working.
sql:  SELECT employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  What are all the employee ids and the names of the countries in which they work?
sql:  SELECT employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  Can you return all detailed info of jobs which was done by any of the employees who is presently earning a salary on and above 12000?
sql:  SELECT T1.* FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

db_id:  hr_1
question:  What is all the job history info done by employees earning a salary greater than or equal to 12000?
sql:  SELECT T1.* FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

db_id:  hr_1
question:  display the employee ID and job name for all those jobs in department 80.
sql:  SELECT T1.employee_id ,  T2.job_title FROM employees T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't1'
None 

db_id:  hr_1
question:  what are the employee ids and job titles for employees in department 80?
sql:  SELECT T1.employee_id ,  T2.job_title FROM employees T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't1'
None 

db_id:  hr_1
question:  display the full name (first and last name ) of employee with ID and name of the country presently where (s)he is working.
sql:  SELECT first_name ,  last_name ,  employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

db_id:  hr_1
question:  What the full names, ids of each employee and the name of the country they are in?
sql:  SELECT first_name ,  last_name ,  employee_id ,  country_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN locations AS T3 ON T2.location_id  =  T3.location_id JOIN countries AS T4 ON T3.country_id  =  T4.country_id
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: country_name
None 

reading labeled file for db:  flight_1
db_id:  flight_1
question:  Show names for all aircrafts with distance at least a quarter of the maximum.
sql:  SELECT name FROM Aircraft WHERE distance  >=  (SELECT max(distance)/4 FROM Aircraft)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 326, in parse_condition
    idx, val1 = parse_value(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 276, in parse_value
    idx, val = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: /4
None 

db_id:  flight_1
question:  What are the names of all aircrafts that have a distance of at least a quarter of the maximum?
sql:  SELECT name FROM Aircraft WHERE distance  >=  (SELECT max(distance)/4 FROM Aircraft)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 326, in parse_condition
    idx, val1 = parse_value(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 276, in parse_value
    idx, val = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: /4
None 

reading labeled file for db:  car_1
db_id:  car_1
question:  How many continents are there?
sql:  SELECT count(*) FROM CONTINENTS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  What is the number of continents?
sql:  SELECT count(*) FROM CONTINENTS;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  How many countries are listed?
sql:  SELECT count(*) FROM COUNTRIES;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  How many countries exist?
sql:  SELECT count(*) FROM COUNTRIES;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  Find the make and production time of the cars that were produced in the earliest year?
sql:  SELECT T2.Make ,  T1.Year FROM CARS_DATA AS T1 JOIN CAR_NAMES AS T2 ON T1.Id  =  T2.MakeId WHERE T1.Year  =  (SELECT min(YEAR) FROM CARS_DATA);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  car_1
question:  What is the maker of the carr produced in the earliest year and what year was it?
sql:  SELECT T2.Make ,  T1.Year FROM CARS_DATA AS T1 JOIN CAR_NAMES AS T2 ON T1.Id  =  T2.MakeId WHERE T1.Year  =  (SELECT min(YEAR) FROM CARS_DATA);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  car_1
question:  What are all the makers and models?
sql:  SELECT Maker ,  Model FROM MODEL_LIST;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  What are the makers and models?
sql:  SELECT Maker ,  Model FROM MODEL_LIST;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  car_1
question:  How many cars have a larger accelerate than the car with the largest horsepower?
sql:  SELECT COUNT(*) FROM CARS_DATA WHERE Accelerate  >  ( SELECT Accelerate FROM CARS_DATA ORDER BY Horsepower DESC LIMIT 1 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  car_1
question:  What is the number of cars with a greater accelerate than the one with the most horsepower?
sql:  SELECT COUNT(*) FROM CARS_DATA WHERE Accelerate  >  ( SELECT Accelerate FROM CARS_DATA ORDER BY Horsepower DESC LIMIT 1 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  car_1
question:  How many countries has more than 2 car makers?
sql:  SELECT COUNT(*) FROM ( SELECT T1.CountryId ,  COUNT(*) FROM COUNTRIES AS T1 ,  CAR_MAKERS AS T2 WHERE T1.CountryId  =  T2.Country GROUP BY T1.CountryId HAVING count(*)  >  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  car_1
question:  What is the number of countries with more than 2 car makers?
sql:  SELECT COUNT(*) FROM ( SELECT T1.CountryId ,  COUNT(*) FROM COUNTRIES AS T1 ,  CAR_MAKERS AS T2 WHERE T1.CountryId  =  T2.Country GROUP BY T1.CountryId HAVING count(*)  >  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 381, in parse_from
    idx, sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  cre_Drama_Workshop_Groups
reading labeled file for db:  customers_card_transactions
reading labeled file for db:  cre_Docs_and_Epenses
reading labeled file for db:  address_1
reading labeled file for db:  scientist_1
reading labeled file for db:  dorm_1
db_id:  dorm_1
question:  Find the first name of students who are living in the dorm that has most number of amenities.
sql:  SELECT T1.fname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T2.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid GROUP BY T2.dormid ORDER BY count(*) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'dorm.stuid'
None 

db_id:  dorm_1
question:  What are the first names of all students who live in the dorm with the most amenities?
sql:  SELECT T1.fname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T2.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid GROUP BY T2.dormid ORDER BY count(*) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'dorm.stuid'
None 

db_id:  dorm_1
question:  Find the first and last name of students who are living in the dorms that have amenity TV Lounge.
sql:  SELECT T1.fname ,  T1.lname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  What are the first and last names of all students who are living in a dorm with a TV Lounge?
sql:  SELECT T1.fname ,  T1.lname FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  Find the first name and age of students who are living in the dorms that do not have amenity TV Lounge.
sql:  SELECT T1.fname ,  T1.age FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid NOT IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

db_id:  dorm_1
question:  What is the first name and age of every student who lives in a dorm with a TV Lounge?
sql:  SELECT T1.fname ,  T1.age FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid NOT IN (SELECT T1.dormid FROM has_amenity AS T1 JOIN dorm_amenity AS T2 ON T1.amenid  =  T2.amenid WHERE T2.amenity_name  =  'TV Lounge')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'has_amenity.stuid'
None 

reading labeled file for db:  wine_1
db_id:  wine_1
question:  Find the distinct names of all wines that have prices higher than some wines from John Anthony winery.
sql:  SELECT DISTINCT T1.Name FROM WINE AS T1 ,  WINE AS T2 WHERE T1.Price  >  T2.Price AND T2.Winery  =  "John Anthony"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  wine_1
question:  What are the distinct names of wines with prices higher than any wine from John Anthony winery.
sql:  SELECT DISTINCT T1.Name FROM WINE AS T1 ,  WINE AS T2 WHERE T1.Price  >  T2.Price AND T2.Winery  =  "John Anthony"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  wta_1
reading labeled file for db:  chinook_1
reading labeled file for db:  e_learning
reading labeled file for db:  insurance_policies
db_id:  insurance_policies
question:  Find the total claimed amount of all the claims.
sql:  SELECT sum(Amount_Claimed) FROM Claims
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: amount_claimed
None 

db_id:  insurance_policies
question:  What is total amount claimed summed across all the claims?
sql:  SELECT sum(Amount_Claimed) FROM Claims
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: amount_claimed
None 

reading labeled file for db:  hospital_1
db_id:  hospital_1
question:  What is the name of the patient who made the most recent appointment?
sql:  SELECT T1.name FROM patient AS T1 ,  appointment AS T2 WHERE T1.ssn = T2.patient ORDER BY T2.start DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  hospital_1
question:  Find the name of the patient who made the appointment with the most recent start date.
sql:  SELECT T1.name FROM patient AS T1 ,  appointment AS T2 WHERE T1.ssn = T2.patient ORDER BY T2.start DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  hospital_1
question:  List the physicians' employee ids together with their primary affiliation departments' ids.
sql:  SELECT physician ,  department FROM affiliated_with WHERE primaryaffiliation
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 312, in parse_condition
    if toks[idx] == 'not':
IndexError: list index out of range
None 

db_id:  hospital_1
question:  What are each physician's employee id and department id primarily affiliated.
sql:  SELECT physician ,  department FROM affiliated_with WHERE primaryaffiliation
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 312, in parse_condition
    if toks[idx] == 'not':
IndexError: list index out of range
None 

reading labeled file for db:  aan_1
reading labeled file for db:  products_gen_characteristics
reading labeled file for db:  boat_1
db_id:  boat_1
question:  return the unique ids of sailors who are older than any sailors.
sql:  SELECT DISTINCT sid FROM Sailors WHERE age  >  (SELECT min(age) FROM Sailors);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  boat_1
question:  What is the different id of every sailor who is not the youngest?
sql:  SELECT DISTINCT sid FROM Sailors WHERE age  >  (SELECT min(age) FROM Sailors);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  boat_1
question:  Return the unique names of sailors who are older than any sailors whose rating is larger than 7.
sql:  SELECT DISTINCT name FROM Sailors WHERE age  >  (SELECT min(age) FROM Sailors WHERE rating  >  7);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  boat_1
question:  What are the different names of sailors who are older than some other sailor with a rating larger than 7?
sql:  SELECT DISTINCT name FROM Sailors WHERE age  >  (SELECT min(age) FROM Sailors WHERE rating  >  7);
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  boat_1
question:  Find all information for the sailors who do not have a reservation of a boat?
sql:  SELECT * FROM Sailors EXCEPT SELECT T1.* FROM Sailors AS T1 JOIN Reserves AS T2 ON T1.sid  =  T2.sid
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 532, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

db_id:  boat_1
question:  What is all the information about sailors who do not have boat reservations?
sql:  SELECT * FROM Sailors EXCEPT SELECT T1.* FROM Sailors AS T1 JOIN Reserves AS T2 ON T1.sid  =  T2.sid
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 532, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: t1
None 

reading labeled file for db:  art_1
reading labeled file for db:  real_estate_rentals
db_id:  real_estate_rentals
question:  Which countries and cities are included in addresses?
sql:  SELECT country ,  town_city FROM Addresses;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What are the countries and cities for each address?
sql:  SELECT country ,  town_city FROM Addresses;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What is the minimum number of rooms in a property?
sql:  SELECT min(room_count) FROM Properties;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What is the lowest room count across all the properties?
sql:  SELECT min(room_count) FROM Properties;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  On average, how many rooms does a property have?
sql:  SELECT avg(room_count) FROM Properties;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What is the average number of rooms in a property?
sql:  SELECT avg(room_count) FROM Properties;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  How many kinds of room sizes are listed?
sql:  SELECT count(DISTINCT room_size) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  Return the number of different room sizes.
sql:  SELECT count(DISTINCT room_size) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  When was the time of the latest search by a user?
sql:  SELECT max(search_datetime) FROM User_Searches;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What was the time of the most recent search?
sql:  SELECT max(search_datetime) FROM User_Searches;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  real_estate_rentals
question:  What are the zip codes of properties which do not belong to users who own at most 2 properties?
sql:  SELECT T1.zip_postcode FROM Addresses AS T1 JOIN Properties AS T2 ON T1.address_id  =  T2.property_address_id WHERE T2.owner_user_id NOT IN ( SELECT owner_user_id FROM Properties GROUP BY owner_user_id HAVING count(*)  <=  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  real_estate_rentals
question:  Return the zip codes for properties not belonging to users who own two or fewer properties.
sql:  SELECT T1.zip_postcode FROM Addresses AS T1 JOIN Properties AS T2 ON T1.address_id  =  T2.property_address_id WHERE T2.owner_user_id NOT IN ( SELECT owner_user_id FROM Properties GROUP BY owner_user_id HAVING count(*)  <=  2 );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

reading labeled file for db:  flight_4
db_id:  flight_4
question:  Find the number of routes whose source and destination airports are in different countries.
sql:  SELECT count(*) FROM routes WHERE (SELECT country FROM airports WHERE apid  =  dst_apid) ! =  (SELECT country FROM airports WHERE apid  =  src_apid)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: select
None 

db_id:  flight_4
question:  How many routes have source and destination airports in different countries?
sql:  SELECT count(*) FROM routes WHERE (SELECT country FROM airports WHERE apid  =  dst_apid) ! =  (SELECT country FROM airports WHERE apid  =  src_apid)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: select
None 

reading labeled file for db:  activity_1
reading labeled file for db:  customers_and_orders
reading labeled file for db:  warehouse_1
reading labeled file for db:  dog_kennels
db_id:  dog_kennels
question:  Which owner has paid the largest amount of money in total for their dogs? Show the owner id and zip code.
sql:  SELECT T1.owner_id ,  T1.zip_code FROM Owners AS T1 JOIN Dogs AS T2 ON T1.owner_id  =  T2.owner_id JOIN Treatments AS T3 ON T2.dog_id  =  T3.dog_id GROUP BY T1.owner_id ORDER BY sum(cost_of_treatment) DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: cost_of_treatment
None 

db_id:  dog_kennels
question:  Find the owner id and zip code of the owner who spent the most money in total for his or her dogs.
sql:  SELECT T1.owner_id ,  T1.zip_code FROM Owners AS T1 JOIN Dogs AS T2 ON T1.owner_id  =  T2.owner_id JOIN Treatments AS T3 ON T2.dog_id  =  T3.dog_id GROUP BY T1.owner_id ORDER BY sum(cost_of_treatment) DESC LIMIT 1
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: cost_of_treatment
None 

reading labeled file for db:  bakery_1
db_id:  bakery_1
question:  What are the ids of Cookie and Cake that cost between 3 and 7 dollars.
sql:  SELECT id FROM goods WHERE (food  =  "Cookie" OR food  =  "Cake") AND price BETWEEN 3 AND 7
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    assert toks[idx] == ')'
AssertionError
None 

db_id:  bakery_1
question:  Give the ids of Cookies or Cakes that cost between 3 and 7 dollars.
sql:  SELECT id FROM goods WHERE (food  =  "Cookie" OR food  =  "Cake") AND price BETWEEN 3 AND 7
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 219, in parse_col_unit
    assert toks[idx] == ')'
AssertionError
None 

reading labeled file for db:  store_1
db_id:  store_1
question:  List the top 10 customers by total gross sales. List customers' first and last name and total gross sales.
sql:  SELECT T1.first_name ,  T1.last_name ,  SUM(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T1.customer_id  =  T2.id GROUP BY T1.id ORDER BY SUM(T2.total) DESC LIMIT 10;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'customers.customer_id'
None 

db_id:  store_1
question:  What are the top 10 customers' first and last names with the highest gross sales, and also what are the sales?
sql:  SELECT T1.first_name ,  T1.last_name ,  SUM(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T1.customer_id  =  T2.id GROUP BY T1.id ORDER BY SUM(T2.total) DESC LIMIT 10;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'customers.customer_id'
None 

db_id:  store_1
question:  List every album's title.
sql:  SELECT title FROM albums;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  What are the titles of all the albums?
sql:  SELECT title FROM albums;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  Who is the youngest employee in the company? List employee's first and last name.
sql:  SELECT first_name , last_name FROM employees ORDER BY Date(birth_date) DESC LIMIT 1;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: date
None 

db_id:  store_1
question:  What si the youngest employee's first and last name?
sql:  SELECT first_name , last_name FROM employees ORDER BY Date(birth_date) DESC LIMIT 1;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: date
None 

db_id:  store_1
question:  List top 10 employee work longest in the company. List employee's first and last name.
sql:  SELECT first_name , last_name FROM employees ORDER BY Date(hire_date) ASC LIMIT 10;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: date
None 

db_id:  store_1
question:  What are the first and last names of the top 10 longest-serving employees?
sql:  SELECT first_name , last_name FROM employees ORDER BY Date(hire_date) ASC LIMIT 10;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 513, in parse_sql
    idx, order_col_units = parse_order_by(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 452, in parse_order_by
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: date
None 

db_id:  store_1
question:  What is the total amount of money spent by Lucas Mancini?
sql:  SELECT sum(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T1.id = T2.customer_id WHERE T1.first_name = "Lucas" AND T2.last_name = "Mancini";
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'invoices.last_name'
None 

db_id:  store_1
question:  How much money did Lucas Mancini spend?
sql:  SELECT sum(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T1.id = T2.customer_id WHERE T1.first_name = "Lucas" AND T2.last_name = "Mancini";
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'invoices.last_name'
None 

db_id:  store_1
question:  List all media types.
sql:  SELECT name FROM media_types;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  What are the names of all the media types?
sql:  SELECT name FROM media_types;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  List all different genre types.
sql:  SELECT DISTINCT name FROM genres;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  What are the different names of the genres?
sql:  SELECT DISTINCT name FROM genres;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  List the name of all playlist.
sql:  SELECT name FROM playlists;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  store_1
question:  What are the names of all the playlists?
sql:  SELECT name FROM playlists;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

reading labeled file for db:  inn_1
db_id:  inn_1
question:  Find the first and last names of people who payed more than the rooms' base prices.
sql:  SELECT T2.firstname ,  T2.lastname FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T1.Rate - T2.basePrice  >  0
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'rooms.firstname'
None 

db_id:  inn_1
question:  What are the first and last names of people who payed more than the rooms' base prices?
sql:  SELECT T2.firstname ,  T2.lastname FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T1.Rate - T2.basePrice  >  0
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'rooms.firstname'
None 

db_id:  inn_1
question:  How many rooms are there?
sql:  SELECT count(*) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  inn_1
question:  What is the total number of rooms available in this inn?
sql:  SELECT count(*) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  inn_1
question:  How many different types of beds are there?
sql:  SELECT count(DISTINCT bedType) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  inn_1
question:  Find the number of distinct bed types available in this inn.
sql:  SELECT count(DISTINCT bedType) FROM Rooms;
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ';'
None 

db_id:  inn_1
question:  Find the name of rooms whose price is higher than the average price.
sql:  SELECT roomName FROM Rooms WHERE basePrice  >  ( SELECT avg(basePrice) FROM Rooms );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

db_id:  inn_1
question:  What are the name of rooms that cost more than the average.
sql:  SELECT roomName FROM Rooms WHERE basePrice  >  ( SELECT avg(basePrice) FROM Rooms );
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: ;
None 

reading labeled file for db:  network_1
reading labeled file for db:  movie_2
db_id:  movie_2
question:  Select the title of all movies.
sql:  SELECT title FROM movie
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 'movie'
None 

db_id:  movie_2
question:  What are all of the movie names?
sql:  SELECT title FROM movie
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 'movie'
None 

reading labeled file for db:  small_bank_1
db_id:  small_bank_1
question:  What is the sum of total saving and checking balances in the bank?
sql:  SELECT sum(T1.balance) + sum(T2.balance) FROM checking AS T1 ,  savings AS T2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

db_id:  small_bank_1
question:  What is the sum of all savings and checking balances together?
sql:  SELECT sum(T1.balance) + sum(T2.balance) FROM checking AS T1 ,  savings AS T2
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: ','
None 

reading labeled file for db:  cre_Theme_park
reading labeled file for db:  college_2
db_id:  college_2
question:  What is the id of the instructor who advises of all students from History department?
sql:  SELECT i_id FROM advisor AS T1 JOIN student T2 ON T1.s_id  =  T2.id WHERE T2.dept_name  =  'History'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't2'
None 

db_id:  college_2
question:  Give id of the instructor who advises students in the History department.
sql:  SELECT i_id FROM advisor AS T1 JOIN student T2 ON T1.s_id  =  T2.id WHERE T2.dept_name  =  'History'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 't2'
None 

db_id:  college_2
question:  Find the name of students who have taken the prerequisite course of the course with title International Finance.
sql:  SELECT T1.name FROM student AS T1 JOIN takes AS T2 ON T1.id  =  T2.id WHERE T2.course_id IN (SELECT T2.prereq_id FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id WHERE T1.title  =  'International Finance')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'course.id'
None 

db_id:  college_2
question:  What are the names of students who have taken the prerequisite for the course International Finance?
sql:  SELECT T1.name FROM student AS T1 JOIN takes AS T2 ON T1.id  =  T2.id WHERE T2.course_id IN (SELECT T2.prereq_id FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id WHERE T1.title  =  'International Finance')
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 391, in parse_from
    idx, this_conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 177, in parse_col
    return start_idx+1, schema.idMap[key]
KeyError: 'course.id'
None 

reading labeled file for db:  customers_and_addresses
db_id:  customers_and_addresses
question:  What is the average time span of contact channels in the database?
sql:  SELECT avg(active_to_date - active_from_date) FROM customer_contact_channels
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 211, in parse_col_unit
    assert idx < len_ and toks[idx] == ')'
AssertionError
None 

db_id:  customers_and_addresses
question:  Compute the average active time span of contact channels.
sql:  SELECT avg(active_to_date - active_from_date) FROM customer_contact_channels
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 211, in parse_col_unit
    assert idx < len_ and toks[idx] == ')'
AssertionError
None 

db_id:  customers_and_addresses
question:  What is the channel code and contact number of the customer contact channel that was active for the longest time?
sql:  SELECT channel_code ,  contact_number FROM customer_contact_channels WHERE active_to_date - active_from_date  =  (SELECT active_to_date - active_from_date FROM customer_contact_channels ORDER BY (active_to_date - active_from_date) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 316, in parse_condition
    assert idx < len_ and toks[idx] in WHERE_OPS, "Error condition: idx: {}, tok: {}".format(idx, toks[idx])
AssertionError: Error condition: idx: 8, tok: -
None 

db_id:  customers_and_addresses
question:  Return the channel code and contact number of the customer contact channel whose active duration was the longest.
sql:  SELECT channel_code ,  contact_number FROM customer_contact_channels WHERE active_to_date - active_from_date  =  (SELECT active_to_date - active_from_date FROM customer_contact_channels ORDER BY (active_to_date - active_from_date) DESC LIMIT 1)
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 316, in parse_condition
    assert idx < len_ and toks[idx] in WHERE_OPS, "Error condition: idx: {}, tok: {}".format(idx, toks[idx])
AssertionError: Error condition: idx: 8, tok: -
None 

db_id:  customers_and_addresses
question:  How many types of products have Rodrick Heaney bought in total?
sql:  SELECT count(DISTINCT product_id) FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t1.customer_name  =  "Rodrick Heaney"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_id
None 

db_id:  customers_and_addresses
question:  Find the number of distinct products Rodrick Heaney has bought so far.
sql:  SELECT count(DISTINCT product_id) FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id WHERE t1.customer_name  =  "Rodrick Heaney"
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 503, in parse_sql
    _, select_col_units = parse_select(toks, start_idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 354, in parse_select
    idx, val_unit = parse_val_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 237, in parse_val_unit
    idx, col_unit1 = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 210, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_id
None 

db_id:  customers_and_addresses
question:  Find the names of customers who never ordered product Latte.
sql:  SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 532, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

db_id:  customers_and_addresses
question:  What are names of customers who never ordered product Latte.
sql:  SELECT customer_name FROM customers EXCEPT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 532, in parse_sql
    idx, IUE_sql = parse_sql(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

db_id:  customers_and_addresses
question:  Find the names of customers who ordered both products Latte and Americano.
sql:  SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte' INTERSECT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Americano'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

db_id:  customers_and_addresses
question:  What are the names of customers who have purchased both products Latte and Americano?
sql:  SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Latte' INTERSECT SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id JOIN products AS t4 ON t3.product_id  =  t4.product_id WHERE product_details  =  'Americano'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 507, in parse_sql
    idx, where_conds = parse_where(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 411, in parse_where
    idx, conds = parse_condition(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 310, in parse_condition
    idx, col_unit = parse_col_unit(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 216, in parse_col_unit
    idx, col_id = parse_col(toks, idx, tables_with_alias, schema, default_tables)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 187, in parse_col
    assert False, "Error col: {}".format(tok)
AssertionError: Error col: product_details
None 

reading labeled file for db:  game_1
reading labeled file for db:  advertising_agencies
db_id:  advertising_agencies
question:  Show all payment ids and details for invoices whose status is 'Working'.
sql:  SELECT T1.payment_id ,  T1.payment_details FROM Payments AS T1 JOIN Invoices AS T2 ont T1.invoice_id  =  T2.invoice_id WHERE T2.invoice_status  =  'Working'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 'ont'
None 

db_id:  advertising_agencies
question:  What are all payment ids and payment details for invoices with status Working?
sql:  SELECT T1.payment_id ,  T1.payment_details FROM Payments AS T1 JOIN Invoices AS T2 ont T1.invoice_id  =  T2.invoice_id WHERE T2.invoice_status  =  'Working'
exception: Traceback (most recent call last):
  File "get_data.py", line 137, in parse_file_and_sql
    sql_label = get_sql(schema, sql)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 546, in get_sql
    _, sql = parse_sql(toks, 0, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 500, in parse_sql
    from_end_idx, table_units, conds, default_tables = parse_from(toks, start_idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 384, in parse_from
    idx, table_unit, table_name = parse_table_unit(toks, idx, tables_with_alias, schema)
  File "/data/projects/nl2sql/label_git/nl2sql/scripts/process_sql.py", line 256, in parse_table_unit
    key = tables_with_alias[toks[idx]]
KeyError: 'ont'
None 

