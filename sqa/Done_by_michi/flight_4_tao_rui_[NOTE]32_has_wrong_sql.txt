Total # = 41

1. Find the name of the airport in the city of Goroka. 
P: What is the name of the airport located in Goroka city?

select name
from airports
where city = 'Goroka'

S:
S
S

2. Find the name, city, country, and altitude (or elevation) of the airports in the city of New York.
P: What are the name, city, country, and altitude of the airports in New York city?

select name, city, country, elevation
from airports
where city = 'New York'

S:
S:
S:


3. How many airlines are there?
P: Find the total number of airlines.

select count(*)
from airlines

S:
S:
S:


4. How many airlines does Russia has?
P: Find the number of airlines Russia possesses.

select count(*)
from airlines
where country = 'Russia'

S:
S:
S:

5. What is the maximum elevation of all the airports in the country of Iceland?
P: Tell me the maximum elevation among the the airports located in Iceland.

select max(elevation)
from airports
where country = 'Iceland'

S:
S:
S:

6. Find the names of the airports located in Cuba or Argentina.
P: What are the names of the airports located in Cuba or Argentina?

select name
from airports
where country = 'Cuba' or country = 'Argentina

S:
S:
S:


7. Find the country of the airline whose name starts with 'Orbit'. 
P: Which country does the airline whose name starts with 'Orbit' belong to?

select country
from airlines
where name LIKE '%Orbit%'

S:
S:
S:


8. Find the names of airports whose latitude is between -50 and 50.
P: What are the names of the airports having latitude between -50 and 50?

select name
from airports
where elevation between -50 and 50

S:
S:
S:


9. Which country is the airport that has the highest latitude located in?
P: Find the country that have the airport with the highest latitude.

select country
from airports
order by elevation desc
limit 1

S:
S:
S:

10. Find the number of airports whose name contain the word 'International'.
P: How many airports have the word 'International' in their names?

select count(*)
from airports
where name LIKE '%International%'

S:
S:
S:


11. How many different cities in Greenland have airports?
P: Tell me the number of cities in Greenland that have at least one airport.

select count(distinct city)
from airports
where country = 'Greenland'

S:
S:
S:


12. Find the routes operated by American Airlines.
P: What are the routes operated by American Airlines?

select count(*)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
where T1.name = 'American Airlines'

S:
S:
S:


13. Find the number of routes whose destination airports are in Canada.
P: How many routes have destination airports in Canada?

select count(*)
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where country = 'Canada'

S:
S:
S:


14. Find the name, city, and country of the airport that has the lowest altitude.
P: What are the name, city, and country of the airport that has the lowest altitude of all?

select name, city, country
from airports
order by elevation
limit 1

S:
S:
S:


15. Find the name, city, and country of the airport that has the highest latitude.
P: Which airport has the highest latitude? Give me its name, city, and country.

select name, city, country
from airports
order by elevation desc
limit 1

S:
S:
S:


16. Find the name and city of the airport that is the destination of the most routes.
P: Which airport is the most frequent destination of flight routes? Return its name and city.

select T1.name, T1.city, T2.dst_apid
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
group by T2.dst_apid 
order by count(*) desc
limit 1

S:
S:
S:


17. Find the names of the top 10 airlines that operate the most routes.
P: What are the top 10 airlines in terms of the number of routes operated? Tell me the airline names.

select T1.name, T2.alid
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T2.alid
order by count(*) desc
limit 10

S:
S:
S:


18. Find the name, city and country of the airport that is the source for the most flight routes.
P: What are the name, city and country of the airport that is the source of the most flight routes.

select T1.name, T1.city, T2.src_apid
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T2.src_apid 
order by count(*) desc
limit 1

S:
S:
S:


19. Find the number of different airports that are the destinations of the American Airlines.
P: How many distinct airports operate as the destinations of the American Airlines?

select count(distinct dst_apid)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
where T1.name = 'American Airlines'

S:
S:
S:


20. Which country has the most airlines?
P: Find the country that has more airlines than any other countries.

select country
from airlines
group by country
order by count(*) desc
limit 1

S:
S:
S:


21. Which country has the most number of airlines whose active status is 'Y'?
P: Return the country that has the most airlines, but only consider those with active status 'Y'.

select country
from airlines
where active = 'Y'
group by country
order by count(*) desc
limit 1

S:
S:
S:


22. List all countries along with the number of airlines they have, in the descending order of the number of airlines.
P: Return the list of countries ordered by the number of airlines they have. Show the number of airlines together. 

select country, count(*)
from airlines
group by country
order by count(*) desc

S:
S:
S:


22. How many airports are there per country? Sort the countries in the decreasing order of the number of airports.
P: Find the number of airports for each country and list them in the descending order.

select count(*), country
from airports
group by country
order by count(*) desc

S:
S:
S:

23. How many airports are there per city in the United States? Order the cities by decreasing number of airports.
P: How many airports does each city have in the United States? List each city along with the number of airports in the descending order.

select count(*), city
from airports
where country = 'United States'
group by city
order by count(*) desc

S:
S:
S:


24. Return the cities with more than 3 airports in the United States.
P: Which cities in the United States have more than three airports?

select city
from airports
where country = 'United States'
group by city
having count(*) > 3

S:
S:
S:


25. How many cities are there that have more than 3 airports?
P: Find the number of cities that have more than 3 airports.

select count(*)
from 
(select city
from airports
group by city
having count(*) > 3)

S:
S:
S:


26. List all the cities that have more than one airport. Show the number of airports together.
P: What cities have more than one airport, and how many do they have?

select city, count(*)
from airports
group by city
having count(*) > 1

S:
S:
S:


27. List the cities that have more than 2 airports, sorted by the number of airports.
P: Which cities have more than two airports? Sort them by the number of airports each city has.

select city
from airports
group by city
having count(*) > 2
order by count(*)

S:
S:
S:


28. For each airport, return the name and the number of routes starting from it.
P: What is the name of each airport? How many routes does it serve as a source for? 

select count(*), T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T1.name

S:
S:
S:


29. Find the number of routes and airport name for each source airport, and order the results by the decreasing number of routes.
P: How many outgoing routes does each airport have? Return the result with each airport's name in the descending order.

select count(*), T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
group by T1.name
order by count(*) desc

S:
S:
S:


30. Find the average elevation of all airports for each country.
P: What is the average elevation of each country's airports?

select avg(elevation), country
from airports
group by country

S:
S:
S:



31. Find the cities that have exactly two airports.
P: Which cities have two airports?

select city
from airports
group by city
having count(*) = 2

S:
S:
S:


32. Find the number of routes for each airline in each country.
P: Return the number of routes operated by each airline in each country?

select T1.country, T1.name, count(*)
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T1.country, T1.name

S:
S:
S:


33. Find the number of routes whose destination airports are in Italy.
P: How many routes have destination airports in Italy?

select count(*)
from routes as T1 join airports as T2 on T1.dst_apid = T2.apid
where T2.country = 'Italy'

S:
S:
S:


34. Return the routes with destination airport in Italy operated by the airline named 'American Airlines'.
P: What are the routes that have their destination airport in Italy and are operated by the airline called 'American Airlines'?

select count(*)
from routes as T1 
     join airports as T2 on T1.dst_apid = T2.apid
     join airlines as T3 on T1.alid = T3.alid
where T2.country = 'Italy' and T3.name = 'American Airlines'

S:
S:
S:


35. Find the number of routes whose destination is the John F Kennedy International Airport.
P: How many routes have the John F Kennedy International Airport as their destination?

select count(*)
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where T1.name = 'John F Kennedy International Airport'

S:
S:
S:

36. Find the number of routes from the United States to Canada.
P: How many routes from the United States to Canada are available?

select count(*)
from routes 
where dst_apid IN (select apid from airports where country = 'Canada') 
      and src_apid IN (select apid from airports where country = 'United States')

S:
S:
S:

37. Find the ids of routes whose source and destination airports are in the United States.
P: What are the ids of the routes that depart and arrive within the United States?

select rid
from routes 
where dst_apid IN (select apid from airports where country = 'United States') 
      and src_apid IN (select apid from airports where country = 'United States')

S:
S:
S:


38. Find the number of routes whose source and destination airports are in different countries.
P: How many routes have source and destination airports in different countries?

select count(*)
from routes
where (select country from airports where apid = dst_apid) != (select country from airports where apid = src_apid)

S:
S:
S:


39. Find the name of airline which operates the largest number of routes.
P: Which airline operates the most routes? Give me the airline name.

select T1.name
from airlines as T1 join routes as T2 on T1.alid = T2.alid
group by T1.name
order by count(*) desc
limit 1

S:
S:
S:


40. Find the busiest source airport in China that are used by the most routes.
P: What airport in China is used as the source for the most routes?

select T1.name
from airports as T1 join routes as T2 on T1.apid = T2.src_apid
where T1.country = 'China'
group by src_apid
order by count(*) desc
limit 1

S:
S:
S:


41. Find the busiest destination airport in China that are used by the most routes.
P: Which airport in China is used as the destination for the most routes?

select T1.name
from airports as T1 join routes as T2 on T1.apid = T2.dst_apid
where T1.country = 'China'
group by dst_apid
order by count(*) desc
limit 1

S:
S:
S:
