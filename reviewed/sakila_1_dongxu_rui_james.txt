Total # = 41

1. How many different last names do the actors and actresses have?
P: Count the number of different last names actors have.

select count(distinct last_name)
from actor

2. What is the most popular first name of the actors?
P: Return the most common first name among all actors.

select first_name
from actor
group by first_name
order by count(*) DESC LIMIT 1

3. What is the most popular full name of the actors?
P: Return the most common full name among all actors.

select first_name, last_name
from actor
group by first_name, last_name
order by count(*) DESC LIMIT 1

4. Which districts have at least two addresses?
P: Give the districts which have two or more addresses.

select district
from address
group by district
having count(*) >= 2

5. What is the phone number and postal code of the address 1031 Daugavpils Parkway?
P: Give the phone and postal code corresponding to the address '1031 Daugavpils Parkway'.

select phone, postal_code
from address
where address = '1031 Daugavpils Parkway'

6. Which city has the most addresses? List the city name, number of addresses, and city id.
P: What are the city name, id, and number of addresses corresponding to the city with the most addressed?

select T2.city, count(*), T1.city_id
from address as T1 JOIN city as T2 on T1.city_id = T2.city_id
group by T1.city_id
order by count(*) DESC LIMIT 1

7. How many addresses are in the district of California?
P: Count the number of addressed in the California district.

select count(*)
from address
where district = 'California'

8. Which film is rented at a fee of 0.99 and has less than 3 in the inventory? List the film title and id.
P: What are the title and id of the film which has a rental rate of 0.99 and an inventory of below 3?
 
select title, film_id
from film
where rental_rate = 0.99
INTERSECT
select T1.title, T1.film_id 
from film as T1 JOIN inventory as T2 
on T1.film_id = T2.film_id
group by T1.film_id
having count(*) < 3

9. How many cities are in Australia?
P: Count the number of cities in Australia.

select count(*)
from city as T1 JOIN country as T2 on T1.country_id = T2.country_id
where T2.country = 'Australia'

10. Which countries have at least 3 cities?
P: What are the countries that contain 3 or more cities?

select T2.country
from city as T1 JOIN country as T2 on T1.country_id = T2.country_id
group by T2.country_id
having count(*) >= 3

11. Find all the payment dates for the payments with an amount larger than 10 and the payments handled by a staff person with the first name Elsa.
P: What are the payment dates for any payments that have an amount greater than 10 or were handled by a staff member with the first name Elsa?

select payment_date
from payment
where amount > 10
UNION
select T1.payment_date
from payment as T1 JOIN staff as T2 on T1.staff_id = T2.staff_id
where T2.first_name = 'Elsa'

12. How many customers have an active value of 1?
P: Count the number of customers who are active.

select count(*)
from customer
where active='1'

13. Which film has the highest rental rate? And what is the rate?
P: What are the title and rental rate of the film with the highest rental rate?

select title, rental_rate
from film
order by rental_rate DESC limit 1

14. Which film has the most number of actors or actresses? List the film name, film id and description.
P: What are the title, id, and description of the movie with the greatest number of actors?

select T2.title, T2.film_id, T2.description
from film_actor as T1 JOIN film as T2 on T1.film_id = T2.film_id
group by T2.film_id
order by count(*) DESC LIMIT 1

15. Which film actor (actress) starred the most films? List his or her first name, last name and actor id.
P: Return the full name and id of the actor or actress who starred in the greatest number of films.

select T2.first_name, T2.last_name, T2.actor_id
from film_actor as T1 JOIN actor as T2 on T1.actor_id = T2.actor_id
group by T2.actor_id
order by count(*) DESC LIMIT 1

16. Which film actors (actresses) played a role in more than 30 films? List his or her first name and last name.
P: What are the full names of actors who had roles in more than 30 films?

select T2.first_name, T2.last_name
from film_actor as T1 JOIN actor as T2 on T1.actor_id = T2.actor_id
group by T2.actor_id
having count(*) > 30

17. Which store owns most items?
P: What is the id of the store that has the most items in inventory?

select store_id
from inventory
group by store_id
order by count(*) DESC LIMIT 1

18. What is the total amount of all payments?
P: Return the sum of all payment amounts.

select sum(amount)
from payment

19. Which customer, who has made at least one payment, has spent the least money? List his or her first name, last name, and the id.
P: What is the full name and id of the customer who has the lowest total amount of payment?

select T1.first_name, T1.last_name, T1.customer_id
from customer as T1 JOIN payment as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id
order by sum(amount) ASC LIMIT 1

20. What is the genre name of the film HUNGER ROOF?
P: Return the name of the category to which the film 'HUNGER ROOF' belongs.

select T1.name
from category as T1 JOIN film_category as T2 
on T1.category_id = T2.category_id
JOIN film as T3 on T2.film_id = T3.film_id
where T3.title = 'HUNGER ROOF'

21. How many films are there in each category? List the genre name, genre id and the count.
P: What are the names and ids of the different categories, and how many films are in each?

select T2.name, T1.category_id, count(*) 
from film_category as T1 JOIN category as T2 on T1.category_id = T2.category_id
group by T1.category_id

22. Which film has the most copies in the inventory? List both title and id.
P: What is the title and id of the film that has the greatest number of copies in inventory?

select T1.title, T1.film_id
from film as T1 JOIN inventory as T2 on T1.film_id = T2.film_id
group by T1.film_id
order by count(*) DESC limit 1

23. What is the film title and inventory id of the item in the inventory which was rented most frequently?
P: Return the title and inventory id of the film that is rented most often.

select T1.title, T2.inventory_id
from film as T1 JOIN inventory as T2
on T1.film_id = T2.film_id
JOIN rental as T3 on T2.inventory_id = T3.inventory_id
group by T2.inventory_id
order by count(*) desc limit 1

24. How many languages are in these films?
P: Count the number of different languages in these films. 

select count(distinct language_id)
from film

25. What are all the movies rated as R? List the titles.
P: Return the titles of any movies with an R rating.

select title
from film
where rating = 'R'

26. Where is store 1 located?
P: Return the address of store 1.

select T2.address
from store as T1 JOIN address as T2 on T1.address_id = T2.address_id
where store_id = 1

27. Which staff handled least number of payments? List the full name and the id.
P: Give the full name and staff id of the staff who has handled the fewest payments.

select T1.first_name, T1.last_name, T1.staff_id
from staff as T1 JOIN payment as T2 on T1.staff_id = T2.staff_id
group by T1.staff_id
order by count(*) asc limit 1

28. Which language does the film AIRPORT POLLOCK use? List the language name.
P: What is the name of the language that the film 'AIRPORT POLLOCK' is in?

select T2.name
from film as T1 JOIN language as T2 on T1.language_id = T2.language_id
where T1.title = 'AIRPORT POLLOCK'

29. How many stores are there?
P: Count the number of stores.

select count(*)
from store

30. How many kinds of different ratings are listed?
P: Count the number of different film ratings.

select count(distinct rating)
from film

31. Which movies have 'Deleted Scenes' as a substring in the special feature?
P: Return the titles of films that include 'Deleted Scenes' in their special feature section.

select title 
from film
where special_features LIKE '%Deleted Scenes%'

32. How many items in inventory does store 1 have?
P: Count the number of items store 1 has in stock.

select count(*)
from inventory
where store_id = 1

33. When did the first payment happen?
P: What was the date of the earliest payment?

select payment_date
from payment
order by payment_date asc LIMIT 1

34. Where does the customer with the first name Linda live? And what is her email?
P: Return the address and email of the customer with the first name Linda.

select T2.address, T1.email
from customer as T1 JOIN address as T2 on T2.address_id = T1.address_id
where T1.first_name = 'LINDA'

35. Find all the films longer than 100 minutes, or rated PG, except those who cost more than 200 for replacement. List the titles.
P: What are the titles of films that are either longer than 100 minutes or rated PG other than those that cost more than 200 to replace?

select title
from film
where length > 100 or rating = 'PG'
EXCEPT
select title
from film
where replacement_cost > 200

36. What is the first name and the last name of the customer who made the earliest rental?
P: Return the full name of the customer who made the first rental.

select T1.first_name, T1.last_name
from customer as T1 JOIN rental as T2 on T1.customer_id = T2.customer_id
order by T2.rental_date ASC LIMIT 1

37. What is the full name of the staff member who has rented a film to a customer with the first name April and the last name Burns?
P: Return the full name of the staff who provided a customer with the first name April and the last name Burns with a film rental.

select distinct T1.first_name, T1.last_name
from staff as T1 JOIN rental as T2 
on T1.staff_id = T2.staff_id
JOIN customer as T3
on T2.customer_id = T3.customer_id
where T3.first_name = 'APRIL' and T3.last_name = 'BURNS'

38. Which store has most the customers?
P: Return the id of the store with the most customers.

select store_id
from customer
group by store_id
order by count(*) DESC limit 1

39. What is the largest payment amount?
P: Return the amount of the largest payment.

select amount
from payment
order by amount desc LIMIT 1

40. Where does the staff member with the first name Elsa live?
P: Give the address of the staff member who has the first name Elsa.

select T2.address
from staff as T1 JOIN address as T2 on T1.address_id = T2.address_id
where T1.first_name = 'Elsa'

41. What are the first names of customers who have not rented any films after '2005-08-23 02:06:01'? 
P: Return the first names of customers who did not rented a film after the date '2005-08-23 02:06:01'.

select first_name
from customer
where customer_id not in(
select customer_id from rental where rental_date > '2005-08-23 02:06:01'
)
