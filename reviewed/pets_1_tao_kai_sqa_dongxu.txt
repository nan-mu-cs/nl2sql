
Total # = 21

1. Find the number of pets whose weight is heavier than 10.
P: How many pets have a greater weight than 10?

Select count(*)
From pets
Where weight > 10

S: What information is there on pets?
S: Which pets weigh more than 10?
S: How many are there?

Select *
From pets

Select *
From pets
Where weight > 10

Select count(*)
From pets
Where weight > 10

2. Find the weight of the youngest dog.
P: How much does the youngest dog weigh?

Select weight
From pets
order by pet_age
Limit 1

S: Order the pets by age
S: How much does each one weigh?
S: What about the first one?

Select *
From pets
order by pet_age

Select weight
From pets
order by pet_age

Select weight
From pets
order by pet_age
Limit 1

3. Find the maximum weight for each type of pet. List the maximum weight and pet type.
P: List the maximum weight and type for each type of pet. 

Select max(weight), petType
From pets
Group by petType

S: What are the different types of pets?
S: For each of those types, what is the maximum weight?

# comment: should not use Group by so quick.

Select distinct petType
From pets

Select max(weight), petType
From pets
Group by petType

4. Find number of pets owned by students who are older than 20.
P: How many pets are owned by students that have an age greater than 20?

Select count(*)
From student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.age > 20

S: Which pets are owned by students older than 20?
S: How many are there?

Select *
From student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.age > 20

Select count(*)
From student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.age > 20

5. Find the number of dog pets that are raised by female students (with sex F). 
P: How many dog pets are raised by female students?

Select count(*)
From student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T2.petid = T3.petid
Where T1.sex = 'F' AND T3.pettype = 'dog'

S: Who are the female students?
S: Of those, who has a pet?
S: How many of those have dogs?

Select *
From student 
Where sex = 'F' 

Select *
From student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
Where T1.sex = 'F'

Select count(*)
From student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T2.petid = T3.petid
Where T1.sex = 'F' AND T3.pettype = 'dog'

6. Find the number of distinct type of pets.
P: How many different types of pet are there?

select count(distinct pettype)
From pets

S: What are the different pet types?
S: How many exist?

select distinct pettype
From pets

select count(distinct pettype)
From pets

7. Find the first name of students who have cat or dog pet.
P: What are the first names of every student who has a cat or dog as a pet? 

Select distinct T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat' or T3.pettype = 'dog'

S: what is the first name of every student?
S: Of those names, which ones correspond to somebody who has a cat?
S: Also, combine those names with those who have a dog.

Select distinct T1.Fname
from student as T1

Select distinct T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

Select distinct T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat' or T3.pettype = 'dog'

8.Find the name of students who have both cat and dog pets.
P: What are the students' first names who have both cats and dogs as pets?

Select T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'
Intersect
Select T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'

S: Which students have a dog as their type of pet?
S: Who also has a cat?
S: What are their first names?

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'
Intersect
Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'

Select T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'
Intersect
Select T1.Fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'

9. Find the major and age of students who do not have a cat pet.
P: What major is every student who does not own a cat as a pet, and also how old are they?

Select major, age
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat')

S: Which students have a cat as their pets?
S: What are they majoring in?
S: Also, how old are they?


Select *
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat')

Select major
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat')

Select major, age
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat')

10. Find the id of students who do not have a cat pet.
P: What are the ids of the students who do not own cats as pets?

Select stuid
From student
Except 
Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

S: What is every student's id?
S: Of those ids, which correspond to those who own cats as pets?
S: List all the other ids. 

Select stuid
From student

Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

Select stuid
From student
Except 
Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

11. Find the first name and age of students who have a dog but do not have a cat as a pet.
P: What is the first name of every student who has a dog but does not have a cat? 

Select T1.fname, T1.age
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog' and T1.stuid NOT IN
(Select T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat')

S: Which students have dogs?
S: Of those, who does not own a cat?
S: What are their first names and ages?

# comment fixed the original

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'
EXCEPT
Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

Select T1.fname, T1.age
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'dog'
EXCEPT
Select T1.fname, T1.age
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pettype = 'cat'

12. Find the type and weight of the youngest pet.
P: What type of pet is the youngest animal, and how much does it weigh?

Select pettype, weight
From pets
order by pet_age
Limit 1

S: Who is the youngest pet?
S: What type are they?
S: Also, how much do they weigh?

Select *
From pets
order by pet_age
Limit 1

Select pettype
From pets
order by pet_age
Limit 1

Select pettype, weight
From pets
order by pet_age
Limit 1

13. Find the id and weight of all pets whose age is older than 1.
P: What is the id and weight of every pet who is older than 1?

Select petid, weight
From pets
Where pet_age > 1

S: What are ids of every pet?
S: For those, which refer to pets older than 1?
S: Also, how much do they weigh?

Select petid
From pets

Select petid
From pets
Where pet_age > 1

Select petid, weight
From pets
Where pet_age > 1

14. Find the average and maximum age for each type of pet.
P: What is the average and maximum age for each pet type?

Select avg(pet_age), max(pet_age), pettype
From pets
Group by pettype

S: What are the different pet types?
S: For each of those, what is the maximum age?
S: What about the average age?

# comment: should not use group by at first

Select distinct pettype
From pets

Select max(pet_age), pettype
From pets
Group by pettype

Select avg(pet_age), pettype
From pets
Group by pettype

15. Find the average weight for each pet type.
P: What is the average weight for each type of pet?

Select avg(weight), pettype
From pets
Group by pettype

S: What information is there on pets?
S: For each pet type, what is the average weight?

Select *
From pets

Select avg(weight), pettype
From pets
Group by pettype

16. Find the first name and age of students who have a pet.
P: What are the different first names and ages of the students who do have pets? 

# comment: should not add 'not' in paraphrase

Select distinct T1.fname, T1.age
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid

S: Which students have pets?
S: What are the different first names?
S: Also, what are their ages? 

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     
Select distinct T1.fname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     
Select distinct T1.fname, T1.age
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid

17. Find the id of the pet owned by student whose last name is ‘Smith’.
P: What is the id of the pet owned by the student whose last name is 'Smith'?

Select T2.petid
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.Lname = 'Smith'

S: Which students have pets?
S: Of those, whose last name is smith?
S: What is their pet's id?

Select *
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid

Select *
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.Lname = 'Smith'

Select T2.petid
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid
Where T1.Lname = 'Smith'

18. Find the number of pets for each student who has any pet and student id.
P: For students who have pets, how many pets does each student have?

Select count(*), T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
Group by T1.stuid

S: Which of the students have pets?
S: How many pets does each of them have?

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid

Select count(*), T1.stuid
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
Group by T1.stuid

19. Find the first name and gender of student who have more than one pet.
P: What is the first name and gender of the all the students who have more than one pet?

Select T1.fname, T1.sex
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
group by T1.stuid
Having count(*) > 1

S: What is the first name and sex of each student?
S: Which of those belong to somebody who has more than one pet?

Select T1.fname, T1.sex
from student as T1

Select T1.fname, T1.sex
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
group by T1.stuid
Having count(*) > 1

20. Find the last name of the student who has a cat that is age 3.
P: What is the last name of the student who has a cat that is 3 years old?

Select T1.lname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pet_age = 3 and T3.pettype = 'cat'

S: What is the id of the three-year old cat?
S: Who is the owner of that cat?
S: What is their last name?

Select petid 
from pets
Where pet_age = 3 and pettype = 'cat'

Select *
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pet_age = 3 and T3.pettype = 'cat'

Select T1.lname
from student as T1
     join has_pet as T2 on T1.stuid = T2.stuid
     Join pets as T3 on T3.petid = T2.petid
Where T3.pet_age = 3 and T3.pettype = 'cat'

21. Find the average age of students who do not have any pet.
P: What is the average age for all students who do not own any pets?

Select avg(age)
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid)

S: Which students do not own any pets?
S: What is their average age?

Select *
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid)

Select avg(age)
From student
Where stuid NOT IN
(Select T1.stuid
from student as T1 join has_pet as T2 on T1.stuid = T2.stuid)
