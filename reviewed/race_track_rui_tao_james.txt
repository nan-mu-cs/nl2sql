1. How many tracks do we have?
P: Count the number of tracks.

select count(*)
from track

S:
S:
S:

2. Show the name and location for all tracks.
P: What are the names and locations of all tracks?

select name, location
from track

S:
S:
S:

3. Show names and seatings, ordered by seating for all tracks opened after 2000.
P: What are the names and seatings for all tracks opened after 2000, ordered by seating?

select name, seating
from track
where year_opened > 2000
order by seating

S:
S:
S:

4. What is the name, location and seating for the most recently opened track?
P: Return the name, location, and seating of the track that was opened in the most recent year.

select name, location, seating
from track
order by year_opened desc
limit 1

S:
S:
S:

5. What is the minimum, maximum, and average seating for all tracks.
P: Return the minimum, maximum, and average seating across all tracks.

select min(seating), max(seating), avg(seating)
from track

S:
S:
S:

6. Show the name, location, open year for all tracks with a seating higher than the average.
P: What are the names, locations, and years of opening for tracks with seating higher than average?

select name, location, year_opened
from track
where seating > (select avg(seating) from track)

S:
S:
S:

7. What are distinct locations where tracks are located?
P: Give the different locations of tracks.

select distinct location
from track

S:
S:
S:

8. How many races are there?
P: Count the number of races.

select count(*)
from race

S:
S:
S:

9. What are the distinct classes that races can have?
P: Return the different classes of races.

select distinct class
from race

S:
S:
S:

10. Show name, class, and date for all races.
P: What are the names, classes, and dates for all races?

select name, class, date
from race

S:
S:
S:

11. Show the race class and number of races in each class.
P: What are the different classes of races, and how many races correspond to each?

select class, count(*)
from race
group by class

S:
S:
S:

12. What is the race class with most number of races.
P: Give the class of races that is most common.

select class
from race
group by class
order by count(*) desc
limit 1

S:
S:
S:

13. List the race class with at least two races.
P: What are the classes of races that have two or more corresponding races?

select class
from race
group by class
having count(*) >= 2

S:
S:
S:

14. What are the names for tracks without a race in class 'GT'.
P: Give the names of tracks that do not have a race in the class 'GT'.

select name
from track
EXCEPT
select T2.name
from race as T1 join track as T2 on T1.track_id = T2.track_id
where T1.class = 'GT'

S:
S:
S:

15. Show all track names that have had no races.
P: Return the names of tracks that have no had any races.

select name
from track
where track_id not in (select track_id from race)

S:
S:
S:

16. Show year where a track with a seating at least 5000 opened and a track with seating no more than 4000 opened.
P: What are the years of opening for tracks with seating between 4000 and 5000?

select year_opened
from track
where seating between 4000 and 5000

S:
S:
S:

17. Show the name of track and the number of races in each track.
P: What are the names of different tracks, and how many races has each had?

select T2.name, count(*)
from race as T1 join track as T2 on T1.track_id = T2.track_id
group by T1.track_id

S:
S:
S:

18. Show the name of track with most number of races.
P: What is the name of the track that has had the greatest number of races?

select T2.name
from race as T1 join track as T2 on T1.track_id = T2.track_id
group by T1.track_id
order by count(*) desc
limit 1

S:
S:
S:

19. Show the name and date for each race and its track name.
P: What are the names and dates of races, and the names of the tracks where they are held?

select T1.name, T1.date, T2.name
from race as T1 join track as T2 on T1.track_id = T2.track_id

S:
S:
S:

20. Show the name and location of track with 1 race.
P: What are the names and locations of tracks that have had exactly 1 race?

select T2.name, T2.location
from race as T1 join track as T2 on T1.track_id = T2.track_id
group by T1.track_id
having count(*) = 1

S:
S:
S:

21. Find the locations where have both tracks with more than 90000 seats and tracks with less than 70000 seats.
P: What are the locations that have both tracks with more than 90000 seats, and tracks with fewer than 70000 seats?

select location
from track
where seating > 90000
intersect
select location
from track
where seating < 70000

S:
S:
S:
