Total = # 41


1. Show the number of accounts.
P: How many accounts are there?

select count(*)
from Accounts

S:
S: 
S: 

2. How many customers have opened an account?
P: Count the number of customers who have an account.

select count(distinct customer_id)
from Accounts

S:
S: 
S: 

3. Show the id, the date of account opened, the account name, and other account detail for all accounts.
P: What are the ids, date opened, name, and other details for all accounts?

select account_id, date_account_opened, account_name, other_account_details
from Accounts

S:
S: 
S: 

4. Show the id, the account name, and other account details for all accounts by the customer with first name 'Meaghan'.
P: What are the ids, names, dates of opening, and other details for accounts corresponding to the customer with the first name "Meaghan"?

select T1.account_id, T1.date_account_opened, T1.account_name, T1.other_account_details
from Accounts as T1 join Customers as T2
on T1.customer_id = T2.customer_id
where T2.customer_first_name = 'Meaghan'

S:
S: 
S: 

5. Show the account name and other account detail for all accounts by the customer with first name Meaghan and last name Keeling.
P: What are the names and other details for accounts corresponding to the customer named Meaghan Keeling?

select T1.account_name, T1.other_account_details
from Accounts as T1 join Customers as T2 on T1.customer_id = T2.customer_id
where T2.customer_first_name = "Meaghan" and T2.customer_last_name = "Keeling"

S:
S: 
S: 

6. Show the first name and last name for the customer with account name 900.
P: What are the full names of customers with the account name 900?

select T2.customer_first_name, T2.customer_last_name
from Accounts as T1 join Customers as T2 on T1.customer_id = T2.customer_id
where T1.account_name = "900"

S:
S: 
S: 

7. How many customers don't have an account?
P: Count the number of customers who do not have an account.

select count(*)
from Customers
where customer_id NOT IN (select customer_id from Accounts)

S:
S: 
S: 

8. Show the unique first names, last names, and phone numbers for all customers with any account.
P: What are the distinct first names, last names, and phone numbers for customers with accounts?

select distinct T1.customer_first_name, T1.customer_last_name, T1.phone_number
from Customers as T1 join Accounts as T2
on T1.customer_id = T2.customer_id

S:
S: 
S: 


9. Show customer ids who don't have an account.
P: What are the customer ids for customers who do not have an account?

select customer_id
from Customers
EXCEPT
select customer_id
from Accounts

S:
S: 
S: 

10. How many accounts does each customer have? List the number and customer id.
P: Count the number of accounts corresponding to each customer id.

select count(*), customer_id
from Accounts
group by customer_id

S:
S: 
S: 

11. What is the customer id, first and last name with most number of accounts.
P: Return the id and full name of the customer with the most accounts.

select T1.customer_id, T2.customer_first_name, T2.customer_last_name
from Accounts as T1 join Customers as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id
order by count(*) desc
limit 1 

S:
S: 
S: 

12. Show id, first name and last name for all customers and the number of accounts.
P: What are the the full names and ids for all customers, and how many accounts does each have?

select T1.customer_id, T2.customer_first_name, T2.customer_last_name, count(*)
from Accounts as T1 join Customers as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id

S:
S: 
S: 

13. Show first name and id for all customers with at least 2 accounts.
P: What are the first names and ids for customers who have two or more accounts?

select T2.customer_first_name, T1.customer_id
from Accounts as T1 join Customers as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id
having count(*) >= 2

S:
S: 
S: 

14. Show the number of customers.
P: Count the number of customers.

select count(*)
from Customers

S:
S: 
S: 

15. Show the number of customers for each gender.
P: How many customers are there of each gender?

select gender, count(*)
from Customers
group by gender

S:
S: 
S: 

16. How many transactions do we have?
P: Count the number of transactions.

select count(*)
from Financial_transactions

S:
S: 
S: 

17. How many transaction does each account have? Show the number and account id.
P: Count the number of financial transactions that correspond to each account id.

select count(*), account_id
from Financial_transactions

S:
S: 
S: 

18. How many transaction does account with name 337 have?
P: Count the number of financial transactions that the account with the name 337 has.

select count(*)
from Financial_transactions as T1 join Accounts as T2 on T1.account_id = T2.account_id
where T2.account_name = "337"

S:
S: 
S: 

19. What is the average, minimum, maximum, and total transaction amount?
P: Return the average, minimum, maximum, and total transaction amounts.

select avg(transaction_amount), min(transaction_amount), max(transaction_amount),  sum(transaction_amount)
from Financial_transactions

S:
S: 
S: 

20. Show ids for all transactions whose amounts are greater than the average.
P: What are the ids for transactions that have an amount greater than the average amount of a transaction?

select transaction_id
from Financial_transactions
where transaction_amount > (select avg(transaction_amount) from Financial_transactions)

S:
S: 
S: 

21. Show the transaction types and the total amount of transactions.
P: What are total transaction amounts for each transaction type?

select transaction_type, sum(transaction_amount)
from Financial_transactions
group by transaction_type

S:
S: 
S: 

22. Show the account name, id and the number of transactions for each account.
P: Return the names and ids of each account, as well as the number of transactions.

select T2.account_name, T1.account_id, count(*)
from Financial_transactions as T1 join Accounts as T2 on T1.account_id = T2.account_id
group by T1.account_id

S:
S: 
S: 

23. Show the account id with most number of transactions.
P: What is the id of the account with the most transactions?

select account_id
from Financial_transactions
group by account_id
order by count(*) desc
limit 1

S:
S: 
S: 

24. Show the account id and name with at least 4 transactions.
P: What are the ids and names of accounts with 4 or more transactions?

select T1.account_id, T2.account_name
from Financial_transactions as T1 join Accounts as T2 on T1.account_id = T2.account_id
group by T1.account_id
having count(*) >= 4

S:
S: 
S: 

25. Show all product sizes.
P: What are the different product sizes?

select distinct product_size
from Products

S:
S: 
S: 

26. Show all product colors.
P: What are the different product colors?

select distinct product_color
from Products

S:
S: 
S: 

27. Show the invoice number and the number of transactions for each invoice.
P: How many transactions correspond to each invoice number?

select invoice_number, count(*)
from Financial_transactions
group by invoice_number

S:
S: 
S: 

28. What is the invoice number and invoice date for the invoice with most number of transactions?
P: What is the invoice number and invoice date corresponding to the invoice with the greatest number of transactions?

select T2.invoice_number, T2.invoice_date
from Financial_transactions as T1 join Invoices as T2 on T1.invoice_number = T2.invoice_number
group by T1.invoice_number
order by count(*) desc
limit 1

S:
S: 
S: 

29. How many invoices do we have?
P: Count the number of invoices.

select count(*)
from Invoices

S:
S: 
S: 

30. Show invoice dates and order id and details for all invoices.
P: What are the invoice dates, order ids, and order details for all invoices?

select T1.invoice_date, T1.order_id, T2.order_details
from Invoices as T1 join Orders as T2
on T1.order_id = T2.order_id

S:
S: 
S: 

31. Show the order ids and the number of invoices for each order.
P: How many invoices correspond to each order id?

select order_id, count(*)
from Invoices
group by order_id

S:
S: 
S: 

32. What is the order id and order details for the order more than two invoices.
P: Return the order ids and details for orderes with two or more invoices.

select T2.order_id, T2.order_details
from Invoices as T1 join Orders as T2 on T1.order_id = T2.order_id
group by T2.order_id
having count(*) > 2

S:
S: 
S: 

33. What is the customer last name, id and phone number with most number of orders?
P: Return the last name, id and phone number of the customer who has made the greatest number of orders.

select T2.customer_last_name, T1.customer_id, T2.phone_number
from Orders as T1 join Customers as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id
order by count(*) desc
limit 1

S:
S: 
S: 

34. Show all product names without an order.
P: What are the names of products that have never been ordered?

select product_name
from Products
except
select T1.product_name
from Products as T1 join Order_items as T2
on T1.product_id = T2.product_id

S:
S: 
S: 

35. Show all product names and the total quantity ordered for each product name.
P: What are the different product names, and what is the sum of quantity ordered for each product?

select T2.product_name, sum(T1.product_quantity)
from Order_items as T1 join Products as T2 on T1.product_id = T2.product_id
group by T2.product_name

S:
S: 
S: 

36. Show the order ids and the number of items in each order.
P: How many order items correspond to each order id?

select order_id, count(*)
from Order_items
group by order_id

S:
S: 
S: 

37. Show the product ids and the number of unique orders containing each product.
P: How many distinct order ids correspond to each product?

select product_id, count(distinct order_id)
from Order_items
group by product_id

S:
S: 
S: 

38. Show all product names and the number of customers having an order on each product.
P: What are teh names of the different products, as well as the number of customers who have ordered each product.

select T2.product_name, count(*)
from Order_items as T1 join Products as T2 on T1.product_id = T2.product_id join Orders as T3 on T3.order_id = T1.order_id
group by T2.product_name

S:
S: 
S: 

39. Show order ids and the number of products in each order.
P: How many different products correspond to each order id?

select order_id, count(distinct product_id)
from Order_items
group by order_id

S:
S: 
S: 

40. Show order ids and the total quantity in each order.
P: Give the order ids for all orders, as well as the total product quantity in each.

select order_id, sum(product_quantity)
from Order_items
group by order_id

S:
S: 
S: 

41. How many products were not included in any order?
P: Count the number of products that were never ordered.

select count(*)
from products
where product_id not in
(
select product_id
from Order_items
)

S:
S: 
S: 
