1. How many vehicles do we have?
P: Count the number of vehicles.

select count(*)
from vehicles

S:
S:
S:

2. Show names for all vehicles in descending order of model year.
P: What are the names of all vehicles, ordered by model year descending?

select name
from vehicles
order by model_year desc

S:
S:
S:

3. List all distinct types of powertrain of vehicles.
P: What are the different types of powertrains?

select distinct type_of_powertrain
from vehicles

S:
S:
S:

4. Show name, type of powertrain, and annual fuel cost for all vehicles with model year 2013 or 2014.
P: What are the names, types of powertrains, and yearly fuel costs for vehicles with model years in either 2013 2014?

select name, type_of_powertrain, annual_fuel_cost
from vehicles
where model_year = 2013 or model_year = 2014

S:
S:
S:

5. Show types of powertrain with vehicles both from 2014 and 2013.
P: What are the types of powertrains that have vehicles that were made in both 2013 and 2014?

select type_of_powertrain
from vehicles
where model_year = 2014
INTERSECT
select type_of_powertrain
from vehicles
where model_year = 2013

S:
S:
S:

6. Show all types of powertrain and the number of vehicles in each type.
P: How many vehicles have each type of powertrain?

select type_of_powertrain, count(*)
from vehicles
group by type_of_powertrain

S:
S:
S:

7. What is the type of powertrain with most number of vehicles.
P: Which type of powertrain is most common?

select type_of_powertrain
from vehicles
group by type_of_powertrain
order by count(*) desc
limit 1

S:
S:
S:

8. Show minimum, maximum, and average annual fuel cost for all vehicles.
P: What are the minimum, maximum, and average annual fuel costs across all vehicles?

select min(annual_fuel_cost), max(annual_fuel_cost), avg(annual_fuel_cost)
from vehicles

S:
S:
S:

9. Show name and model year for vehicles with city fuel economy rate less than or equal to highway fuel economy rate.
P: What are the names and model years for vehicles that have a city fuel economy rate less than or equal to its highway fuel economy rate?

select name, model_year
from vehicles
where city_fuel_economy_rate <= highway_fuel_economy_rate

S:
S:
S:

10. Show the type of powertrain with at least two vehicles, and the average annual fuel cost for vehicles in each such type.
P: What are the types of powertrains for which there are two or more vehicles, and what are their average annual fuel costs?

select type_of_powertrain, avg(annual_fuel_cost) 
from vehicles
group by type_of_powertrain
having count(*) >= 2

S:
S:
S:

11.  Show the name, age, membership credit for all customers?
P: What are the names, ages, and membership credits for all customers?

select name, age, membership_credit
from customers

S:
S:
S:

12. Show the name and age of the customer with maximum membership credit.
P: What is the name and age of the customer with the most membership credit?

select name, age
from customers
order by membership_credit desc
limit 1

S:
S:
S:

13. What is the average age for customers with a membership credit above the average?
P: Return the average age for customers who have membership above the average across all customers.

select avg(age)
from customers
where membership_credit > (select avg(membership_credit) from customers)

S:
S:
S:

14. Show all information for all discounts.
P: Return all information about discounts.

select *
from discount

S:
S:
S:

15. Show the name and total hours of renting for each vehicle.
P: What are the names and total rental hours for each vehicle?

select T2.name, sum(T1.total_hours)
from renting_history as T1 join vehicles as T2 on T1.vehicles_id = T2.id
group by T2.id

S:
S:
S:

16. Show the name of vehicles with no renting history.
P: What are the names of vehicles that have never been rented?

select name
from vehicles
where id not in (select vehicles_id from renting_history)

S:
S:
S:

17. Show the name of customer with at least two renting history records.
P: What are the names of customers who have two or more records of rental history?

select T2.name
from renting_history as T1 join customers as T2 on T1.customer_id = T2.id
group by T2.id
having count(*) >= 2

S:
S:
S:

18. Show the name and model year of the vehicle with most number of renting history records.
P: What is the name and model year of the vehicle which has been rented the most times?

select T2.name, T2.model_year
from renting_history as T1 join vehicles as T2 on T1.vehicles_id = T2.id
group by T2.id
order by count(*) desc
limit 1

S:
S:
S:

19. Show the vehicle name with a descending order of total hours of renting.
P: What are the names of vehicles, sorted descending by total hours of renting?

select T2.name
from renting_history as T1 join vehicles as T2 on T1.vehicles_id = T2.id
group by T2.id
order by sum(T1.total_hours) desc

S:
S:
S:

20. What is the discount name with most number of renting history records?
P: Return the name of the discount that corresponds to the most rental history records.

select T2.name
from renting_history as T1 join discount as T2 on T1.discount_id = T2.id
group by T2.id
order by count(*) desc
limit 1

S:
S:
S:

21. Find the name and powertrain type of the cars that rented for more than 30 total hours.
P: What are the names and powertrain types of cars that have more than 30 total rental hours?

select T2.name, T2.Type_of_powertrain
from renting_history as T1 join vehicles as T2 on T1.vehicles_id = T2.id
group by T1.vehicles_id
having sum(T1.total_hours) > 30

S:
S:
S:

22. Find the average city and highway fuel rates for cars with different powertrain types.
P: What are the average city fuel economy rate, average highway fuel economy rate for different types of powertrains?

select avg(City_fuel_economy_rate), avg(Highway_fuel_economy_rate),Type_of_powertrain
from vehicles
group by Type_of_powertrain

S:
S:
S:
