# Total = 20

1. What is id of the city that hosted events in the most recent year?
P: Find the city that hosted some events in the most recent year. What is the id of this city?

SELECT host_city
FROM hosting_city
ORDER BY year desc
LIMIT 1

S:
S:
S:


2. Find the match ids of the cities that hosted competition "1994 FIFA World Cup qualification"?
P: What is the match id of the competition called "1994 FIFA World Cup qualification"?

SELECT match_id
FROM match
WHERE competition="1994 FIFA World Cup qualification"

S:
S:
S:


3. Find the cities which were once a host city after 2010?
P: Which cities served as a host city after 2010?

SELECT T1.city
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id=T2.host_city
WHERE T2.year > 2010

S:
S:
S:


4. Which city has hosted the most events?
P: Find the city that hosted the most events.

SELECT T1.city
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id = T2.host_city
GROUP BY T2.host_city
ORDER BY count(*) desc
LIMIT 1

S:
S:
S:


5. What is the venue of the competition "1994 FIFA World Cup qualification" hosted by "Nanjing ( Jiangsu )"?
P: Find the venue of the competition "1994 FIFA World Cup qualification" which was hosted by "Nanjing ( Jiangsu )".

SELECT T3.venue
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id=T2.host_city JOIN match as T3 ON T2.match_id=T3.match_id
WHERE T1.city="Nanjing ( Jiangsu )" and T3.competition="1994 FIFA World Cup qualification"

S:
S:
S:


6. Give me the temperature of Shanghai in January.
P: What is the temperature of "Shanghai" city in January?

SELECT T2.Jan
FROM city as T1 JOIN temperature as T2 ON T1.city_id=T2.city_id
WHERE T1.city="Shanghai"

S:
S:
S:


7. What is the host year of city "Taizhou ( Zhejiang )"?
P: IN which year did city "Taizhou ( Zhejiang )" serve as a host city?

SELECT T2.year
FROM city as T1 JOIN hosting_city as T2 on T1.city_id = T2.host_city
WHERE T1.city = "Taizhou ( Zhejiang )"

S:
S:
S:


8. Which three cities have the largest regional population?
P: What are the three largest cities in terms of regional population?

SELECT city
FROM city
ORDER BY regional_population desc
LIMIT 3

S:
S:
S:


9. Which city has the lowest GDP? Please list the city name and its GDP.
P: What is the city with the smallest GDP? Return the city and its GDP.

SELECT city, GDP
FROM city
ORDER BY GDP
LIMIT 1

S:
S:
S:


10. Which city has the highest temperature in February?
P: In February, which city marks the highest temperature?

SELECT T1.city
FROM city as T1 JOIN temperature as T2 ON T1.city_id = T2.city_id
ORDER BY T2.Feb desc
LIMIT 1

S:
S:
S:


11. Give me a list of cities whose temperature in March is lower than that in July or higher than that in Oct?
P: Which cities' temperature in March is lower than that in July or higher than that in Oct?

SELECT T1.city
FROM city as T1 JOIN temperature as T2 ON T1.city_id = T2.city_id
WHERE T2.Mar < T2.Jul or T2.Mar > T2.Oct

S:
S:
S:


12. Give me a list of cities whose temperature in Mar is lower than that in July and which have also served as host cities?
P: Which cities have lower temperature in March than in July and have been once host cities?

SELECT T1.city
FROM city as T1 JOIN temperature as T2 ON T1.city_id = T2.city_id
WHERE T2.Mar < T2.Jul
INTERSECT
SELECT T1.city
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id = T2.host_city

S:
S:
S:


13. Give me a list of cities whose temperature in Mar is lower than that in Dec and which have never been host cities.
P: Which cities have lower temperature in March than in Dec and have never served as host cities?

SELECT T1.city
FROM city as T1 JOIN temperature as T2 ON T1.city_id = T2.city_id
WHERE T2.Mar < T2.Dec
Except
SELECT T1.city
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id = T2.host_city

S:
S:
S:


14. Give me a list of cities whose temperature in Feb is higher than that in Jun or cities that were once host cities?
P: Which cities have higher temperature in Feb than in Jun or have once served as host cities?

SELECT T1.city
FROM city as T1 JOIN temperature as T2 ON T1.city_id = T2.city_id
WHERE T2.Feb > T2.Jun
union
SELECT T1.city
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id = T2.host_city

S:
S:
S:


15. Please give me a list of cities whose regional population is over 10000000.
P: Which cities have regional population above 10000000?

SELECT city
FROM city
WHERE regional_population > 10000000

S:
S:
S:


16. Please give me a list of cities whose regional population is over 8000000 or under 5000000.
P: Which cities have regional population above 8000000 or below 5000000?

SELECT city
FROM city
WHERE regional_population > 10000000
UNION
SELECT city
FROM city
WHERE regional_population < 5000000

S:
S:
S:


17. Find the number of matches in different competitions.
P: For each competition, count the number of matches.

select count(*), Competition
from match
group by Competition

S:
S:
S:


18. List venues of all matches in the order of their dates starting from the most recent one.
P: What are the venues of all the matches? Sort them in the descending order of match date.

select venue
from match
order by date desc

S:
S:
S:


19. what is the GDP of the city with the largest population.
P: Find the GDP of the city with the largest regional population.

select gdp
from city
order by Regional_Population desc
limit 1

S:
S:
S:


20. What are the GDP and population of the city that already served as a host more than once?
P: Which cities have served as host cities more than once? Return me their GDP and population.

select t1.gdp, t1.Regional_Population
FROM city as T1 JOIN hosting_city as T2 ON T1.city_id = T2.host_city
group by t2.Host_City
having count(*) > 1

S:
S:
S:


