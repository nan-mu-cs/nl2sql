Total = 20

1. How many film are there?
P: Count the number of films.

SELECT count(*)
FROM film

S:
S:
S:

2. List the distinct director of all films.
P: What are the different film Directors?

SELECT distinct Director
FROM film

S:
S:
S:

3. What is the average ticket sales gross in dollars of films?
P: Return the average gross sales in dollars across all films.

SELECT avg(Gross_in_dollar)
FROM film

S:
S:
S:

4. What are the low and high estimates of film markets?
P: Return the low and high estimates for all film markets.

SELECT Low_Estimate, High_Estimate
FROM film_market_estimation

S:
S:
S:

5. What are the types of film market estimations in year 1995?
P: Return the types of film market estimations in 1995.

SELECT Type
FROM film_market_estimation
WHERE year = 1995

S:
S:
S:

6. What are the maximum and minimum number of cities in all markets.
P: Return the maximum and minimum number of cities across all markets.

SELECT max(Number_cities), min(Number_cities)
FROM market

S:
S:
S:

7. How many markets have number of cities smaller than 300?
P: Count the number of markets that have a number of cities lower than 300.

SELECT count(*)
FROM market
where Number_cities < 300

S:
S:
S:

8. List all countries of markets in ascending alphabetical order.
P: What are the countries for each market, ordered alphabetically?

SELECT Country
FROM market
order by Country ASC

S:
S:
S:

9. List all countries of markets in descending order of number of cities.
P: What are the countries for each market ordered by decreasing number of cities?

SELECT Country
FROM market
order by Number_cities DESC

S:
S:
S:

10. Please show the titles of films and the types of market estimations.
P: What are the titles of films and corresponding types of market estimations?

SELECT T1.Title, T2.Type
FROM film as T1 join film_market_estimation as T2 
on T1.Film_ID = T2.Film_ID

S:
S:
S:

11. Show the distinct director of films with market estimation in the year of 1995.
P: Who are the different directors of films which had market estimation in 1995?

SELECT distinct T1.Director
FROM film as T1 join film_market_estimation as T2 
on T1.Film_ID = T2.Film_ID
Where T2.Year = 1995

S:
S:
S:

12. What is the average number of cities of markets with low film market estimate bigger than 10000?
P: Give the average number of cities within markets that had a low market estimation larger than 10000?

SELECT avg(T2.Number_cities)
FROM film_market_estimation as T1 join market as T2
on T1.Market_ID = T2.Market_ID
Where T1.Low_Estimate > 10000

S:
S:
S:

13. Please list the countries and years of film market estimations.
P: What are the countries of markets and their corresponding years of market estimation?

SELECT T2.Country, T1.Year
FROM film_market_estimation as T1 join market as T2
on T1.Market_ID = T2.Market_ID

S:
S:
S:

14. Please list the years of film market estimations when the market is in country "Japan" in descending order.
P: What are the years of film market estimation for the market of Japan, ordered by year descending?

SELECT T1.Year
FROM film_market_estimation as T1 join market as T2
on T1.Market_ID = T2.Market_ID
Where T2.Country = "Japan"
order by T1.Year DESC
 
S:
S:
S:

15. List the studios of each film and the number of films produced by that studio.
P: How films are produced by each studio?

SELECT Studio, COUNT(*)
FROM film
group by Studio

S:
S:
S:

16. List the name of film studio that have the most number of films.
P: What is the name of teh studio that created the most films?

SELECT Studio
FROM film
group by Studio
order by COUNT(*) DESC limit 1

S:
S:
S:

17. List the names of studios that have at least two films.
P: What are the names of studios that have made two or more films?

SELECT Studio
FROM film
group by Studio
Having COUNT(*) >= 2

S:
S:
S:

18. List the title of films that do not have any market estimation.
P: What are the titles of films that do not have a film market estimation?

SELECT Title
from film
where Film_ID not in (SELECT Film_ID FROM film_market_estimation)

S:
S:
S:

19. Show the studios that have produced films with director "Nicholas Meyer" and "Walter Hill".
P: What are the names of studios that have produced films with both Nicholas Meyer and Walter Hill?

SELECT Studio
FROM film
Where Director = "Nicholas Meyer"
Intersect 
SELECT Studio
FROM film
Where Director = "Walter Hill"

S:
S:
S:

20. Find the titles and studios of the films that are produced by some film studios that contained the word "Universal".
P: What are the titles and studios of films that have been produced by a studio whose name contains "Universal"?

select title, Studio
from film
Where Studio LIKE "%Universal%"

S:
S:
S:

21. Show the studios that have not produced films with director "Walter Hill".
P: Which studios have never worked with the director Walter Hill?

SELECT Studio
FROM film
except
SELECT Studio
FROM film
Where Director = "Walter Hill"

S:
S:
S:

22. List the studios which average gross is above 4500000.
P: Which studios have an average gross of over 4500000?

SELECT Studio
FROM film
group by Studio
Having avg(Gross_in_dollar) >= 4500000

S:
S:
S:

23. What is the title of the film that has the highest high market estimation.
P: Return the title of the film with the highest high estimate?

SELECT t1.title
FROM film as T1 join film_market_estimation as T2  on T1.Film_ID = T2.Film_ID
order by high_estimate desc
limit 1

S:
S:
S:

24. What are the titles and directors of the films were never presented in China?
P: Return the titles and directors of films that were never in the market of China.

SELECT title, director
FROM film
where film_id not in (select film_id 
                      from film_market_estimation as T1 join market as T2 on T1.market_id = T2.Market_ID
                      where country = 'China')

S:
S:
S:
