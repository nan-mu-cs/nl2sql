1. How many artists do we have?
P: Count the number of artists.

select count(*)
from artist

S:
S:
S:

2. Show all artist name, age, and country ordered by the yeared they joined.
P: What are the names, ages, and countries of artists, sorted by the year they joined?

select name, age, country
from artist
order by Year_Join

S:
S:
S:

3. What are all distinct country for artists?
P: Return the different countries for artists.

select distinct country
from artist

S:
S:
S:

4. Show all artist names and the year joined who are not from United States.
P: What are the names and year of joining for artists that do not have the country "United States"?

select name, year_join
from artist
where country != 'United States'

S:
S:
S:

5. How many artists are above age 46 and joined after 1990?
P: Count the number of artists who are older than 46 and joined after 1990.

select count(*)
from artist
where age > 46 and year_join > 1990

S:
S:
S:

6. What is the average and minimum age of all artists from United States.
P: Return the average and minimum ages across artists from the United States.

select avg(age), min(age)
from artist
where country = 'United States'

S:
S:
S:

7. What is the name of the artist who joined latest?
P: Return the name of the artist who has the latest join year.

select name
from artist
order by year_join desc
limit 1

S:
S:
S:

8. How many exhibition are there in year 2005 or after?
P: Count the number of exhibitions that happened in or after 2005.

select count(*)
from exhibition
where year >= 2005

S:
S:
S:

9. Show theme and year for all exhibitions with ticket prices lower than 15.
P: What are the theme and year for all exhibitions that have a ticket price under 15?

select theme, year
from exhibition
where ticket_price < 15

S:
S:
S:

10. Show all artist names and the number of exhibitions for each artist.
P: How many exhibitions has each artist had?

select T2.name, count(*)
from exhibition as T1 join artist as T2 on T1.artist_id = T2.artist_id
group by T1.artist_id

S:
S:
S:

11. What is the name and country for the artist with most number of exhibitions?
P: Return the name and country corresponding to the artist who has had the most exhibitions.

select T2.name,T2.country
from exhibition as T1 join artist as T2 on T1.artist_id = T2.artist_id
group by T1.artist_id
order by count(*) desc
limit 1

S:
S:
S:

12. Show names for artists without any exhibition.
P: What are the names of artists that have not had any exhibitions?

select name
from artist
where artist_id NOT IN (select artist_id from exhibition)

S:
S:
S:

13. What is the theme and artist name for the exhibition with a ticket price higher than the average?
P: Return the names of artists and the themes of their exhibitions that had a ticket price higher than average.

select T1.theme, T2.name
from exhibition as T1 join artist as T2 on T1.artist_id = T2.artist_id
where T1.ticket_price > (select avg(ticket_price) from exhibition)

S:
S:
S:

14. Show the average, minimum, and maximum ticket prices for exhibitions for all years before 2009.
P: What are the average, minimum, and maximum ticket prices for exhibitions that happened prior to 2009?

select avg(ticket_price), min(ticket_price), max(ticket_price)
from exhibition
where year < 2009

S:
S:
S:

15. Show theme and year for all exhibitions in an descending order of ticket price.
P: What are the themes and years for exhibitions, sorted by ticket price descending?

select theme, year
from exhibition
order by ticket_price desc

S:
S:
S:

16. What is the theme, date, and attendance for the exhibition in year 2004? 
P: Return the themes, dates, and attendance for exhibitions that happened in 2004.

select T2.theme, T1.date, T1.attendance
from exhibition_record as T1 join exhibition as T2 on T1.exhibition_id = T2.exhibition_id
where T2.year = 2004

S:
S:
S:

17. Show all artist names who didn't have an exhibition in 2004.
P: What are the names of artists who did not have an exhibition in 2004?

select name
from artist
except
select T2.name
from exhibition as T1 join artist as T2 on T1.artist_id = T2.artist_id
where T1.year = 2004

S:
S:
S:

18. Show the theme for exhibitions with both records of an attendance below 100 and above 500.
P: Which themes have had corresponding exhibitions that have had attendance both below 100 and above 500?

select T2.theme
from exhibition_record as T1 join exhibition as T2 on T1.exhibition_id = T2.exhibition_id
where T1.attendance < 100
intersect
select T2.theme
from exhibition_record as T1 join exhibition as T2 on T1.exhibition_id = T2.exhibition_id
where T1.attendance > 500

S:
S:
S:

19. How many exhibitions have a attendance more than 100 or have a ticket price below 10?
P: Count the number of exhibitions that have had an attendnance of over 100 or a ticket prices under 10.

select count(*)
from exhibition_record as T1 join exhibition as T2 on T1.exhibition_id = T2.exhibition_id
where T1.attendance > 100 or T2.ticket_price < 10 

S:
S:
S:

20. Show all artist names with an average exhibition attendance over 200.
P: What are the names of artist whose exhibitions draw over 200 attendees on average?

select T3.name
from exhibition_record as T1 join exhibition as T2 on T1.exhibition_id = T2.exhibition_id join artist as T3 on T3.artist_id = T2.artist_id
group by T3.artist_id
having avg(T1.attendance) > 200

S:
S:
S:
