# TOTAL =  41

1. How many bookings do we have?
P: Count the total number of bookings made.

select count(*)
from BOOKINGS

S:
S:
S:


2. List the order dates of all the bookings.
P: What is the order date of each booking?

select Order_Date
from BOOKINGS

S:
S:
S:


3. Show all the planned delivery dates and actual delivery dates of bookings.
P: What are the planned delivery date and actual delivery date for each booking?

select Planned_Delivery_Date, Actual_Delivery_Date
from BOOKINGS

S:
S:
S:


4. How many customers do we have?
P: Count the number of customers recorded.

select count(*)
from CUSTOMERS

S:
S:
S:


5. What are the phone and email for customer Harold?
P: Find the phone number and email address of customer "Harold".

select Customer_Phone, Customer_Email_Address
from CUSTOMERS
where Customer_Name = "Harold"

S:
S:
S:


6. Show all the Store_Name of drama workshop groups.
P: What are the store names of drama workshop groups?

select Store_Name
from Drama_Workshop_Groups

S:
S:
S:


7. Show the minimum, average, maximum order quantity of all invoices.
P: What are the minimum, average, and maximum quantities ordered? Check all the invoices.

select min(Order_Quantity), avg(Order_Quantity), max(Order_Quantity)
from INVOICES

S:
S:
S:


8. What are the distinct payment method codes in all the invoices?
P: Show me the distinct payment method codes from the invoice record.

select distinct payment_method_code
from INVOICES

S:
S:
S:


9. What is the description of the marketing region China?
P: Find the marketing region description of China?

select Marketing_Region_Descriptrion
from Marketing_Regions
where Marketing_Region_Name = "China"

S:
S:
S:


10. Show all the distinct product names with price higher than the average.
P: What are the distinct names of the products that cost more than the average?

select distinct Product_Name
from PRODUCTS
where Product_Price > (select avg(Product_Price) from PRODUCTS)

S:
S:
S:


11. What is the name of the most expensive product?
P: Tell me the name of the most pricy product.

select Product_Name
from PRODUCTS
order by Product_Price DESC
limit 1

S:
S:
S:


12. List all product names in ascending order of price.
P: Sort the names of products in ascending order of their price.

select Product_Name
from Products
order by Product_Price ASC

S:
S:
S:


13. What is the phone number of the performer Ashley?
P: Find the phone number of performer "Ashley".

select Customer_Phone
from PERFORMERS
where Customer_Name = "Ashley"

S:
S:
S:


14. Show all payment method codes and the number of orders for each code.
P: List the distinct payment method codes with the number of orders made

select payment_method_code, count(*)
from INVOICES
group by payment_method_code

S:
S:
S:


15. What is the payment method code used by the most orders?
P: Find the payment method that is used the most often in all the invoices. Give me its code.

select payment_method_code
from INVOICES
group by payment_method_code
order by count(*) desc
limit 1

S:
S:
S:


16. Which city is the address of the store named "FJA Filming" located in?
P: Find the city the store named "FJA Filming" is in.

select T1.City_Town
from Addresses as T1 join Stores as T2
on T1.Address_ID = T2.Address_ID
where T2.Store_Name = "FJA Filming"

S:
S:
S:


17. What are the states or counties of the address of the stores with marketing region code "CA"?
P: Find the states or counties where the stores with marketing region code "CA" are located.

select T1.State_County
from Addresses as T1 join Stores as T2
on T1.Address_ID = T2.Address_ID
where T2.Marketing_Region_Code = "CA"

S:
S:
S:


18. What is the name of the marketing region that the store Rob Dinning belongs to?
P: Return the name of the marketing region the store Rob Dinning is located in.

select T1.Marketing_Region_Name
from Marketing_Regions as T1 join Stores as T2
on T1.Marketing_Region_Code = T2.Marketing_Region_Code
where T2.Store_Name = "Rob Dinning"

S:
S:
S:


19. What are the descriptions of the service types with product price above 100?
P: Give me the descriptions of the service types that cost more than 100.

select T1.Service_Type_Description
from Ref_Service_Types as T1 join Services as T2
on T1.Service_Type_Code = T2.Service_Type_Code
where T2.Product_Price > 100

S:
S:
S:


20. What is the description, code and the corresponding count of each service type?
P: List the description, code and the number of services for each service type.

select T1.Service_Type_Description, T2.Service_Type_Code, COUNT(*)
from Ref_Service_Types as T1 join Services as T2
on T1.Service_Type_Code = T2.Service_Type_Code
group by T2.Service_Type_Code

S:
S:
S:


21. What is the description and code of the type of service that is performed the most often?
P: Find the description and code of the service type that is performed the most times.

select T1.Service_Type_Description,T1.Service_Type_Code
from Ref_Service_Types as T1 join Services as T2
on T1.Service_Type_Code = T2.Service_Type_Code
group by T1.Service_Type_Code
order by COUNT(*) DESC limit 1

S:
S:
S:


22. What are the phones and emails of workshop groups in which services are performed?
P: Give me all the phone numbers and email addresses of the workshop groups where services are performed.

select T1.Store_Phone, T1.Store_Email_Address
from Drama_Workshop_Groups as T1 join Services as T2
on T1.Workshop_Group_ID = T2.Workshop_Group_ID

S:
S:
S:


23. What are the names of workshop groups in which services with product name "film" are performed?
P: Find the names of the workshop groups where services with product name "film" are performed.

select T1.Store_Phone, T1.Store_Email_Address
from Drama_Workshop_Groups as T1 join Services as T2
on T1.Workshop_Group_ID = T2.Workshop_Group_ID
WHERE T2.Product_Name = "film"

S:
S:
S:


24. What are the different product names? What is the average product price for each of them?
P: For each distinct product name, show its average product price.

select Product_Name, avg(Product_Price)
from PRODUCTS
group by Product_Name

S:
S:
S:


25. What are the product names with average product price smaller than 1000000?
P: Find the product names whose average product price is below 1000000.

select Product_Name
from PRODUCTS
group by Product_Name
HAVING avg(Product_Price) < 1000000

S:
S:
S:


26. What are the total order quantities of photo products?
P: Compute the total order quantities of the product "photo".

select sum(T1.Order_Quantity)
FROM ORDER_ITEMS as T1 JOIN Products as T2
on T1.Product_ID = T2.Product_ID
WHERE T2.Product_Name = "photo"

S:
S:
S:


27. What are the order details of the products with price higher than 2000?
P: Find the order detail for the products with price above 2000.

select T1.Other_Item_Details
FROM ORDER_ITEMS as T1 JOIN Products as T2
on T1.Product_ID = T2.Product_ID
WHERE T2.Product_price > 2000

S:
S:
S:


28. What are the actual delivery dates of orders with quantity 1?
P: List the actual delivery date for all the orders with quantity 1

select T1.Actual_Delivery_Date
FROM Customer_Orders as T1 JOIN ORDER_ITEMS as T2
on T1.Order_ID = T2.Order_ID
WHERE T2.Order_Quantity = 1

S:
S:
S:


29. What are the order dates of orders with price higher than 1000?
P: Find the order dates of the orders with price above 1000.

select T1.Order_Date
FROM Customer_Orders as T1 JOIN ORDER_ITEMS as T2
on T1.Order_ID = T2.Order_ID
JOIN Products as T3
on T2.Product_ID = T3.Product_ID
WHERE T3.Product_price > 1000

S:
S:
S:


30. How many distinct currency codes are there for all drama workshop groups?
P: Find the number of distinct currency codes used in drama workshop groups.

select count(distinct Currency_Code)
from Drama_Workshop_Groups

S:
S:
S:


31. What are the names of the drama workshop groups with address in Feliciaberg city?
P: Return the the names of the drama workshop groups that are located in Feliciaberg city.

select T2.Store_Name
from Addresses as T1 join Drama_Workshop_Groups as T2
on T1.Address_ID = T2.Address_ID
where T1.City_Town = "Feliciaberg"

S:
S:
S:


32. What are the email addresses of the drama workshop groups with address in Alaska state?
P: List the email addresses of the drama workshop groups located in Alaska state.

select T2.Store_Email_Address
from Addresses as T1 join Drama_Workshop_Groups as T2
on T1.Address_ID = T2.Address_ID
where T1.State_County = "Alaska"

S:
S:
S:


33. Show all cities along with the number of drama workshop groups in each city.
P: How many drama workshop groups are there in each city? Return both the city and the count.

select T1.City_Town, count(*)
from Addresses as T1 join Drama_Workshop_Groups as T2
on T1.Address_ID = T2.Address_ID
group by T1.City_Town

S:
S:
S:


34. What is the marketing region code that has the most drama workshop groups?
P: Which marketing region has the most drama workshop groups? Give me the region code.

select Marketing_Region_Code
from Drama_Workshop_Groups
group by Marketing_Region_Code
order by count(*) desc
limit 1

S:
S:
S:


35. Show all cities where at least one customer lives in but no performer lives in.
P: Which cities have at least one customer but no performer?

select T1.City_Town
from Addresses as T1 join Customers as T2
on T1.Address_ID = T2.Address_ID
EXCEPT
select T1.City_Town
from Addresses as T1 join Performers as T2
on T1.Address_ID = T2.Address_ID

S:
S:
S:


36. What is the most frequent status of bookings?
P: Which status code is the most common of all the bookings?

select Status_Code
from BOOKINGS
group by Status_Code
order by count(*) desc limit 1

S:
S:
S:


37. What are the names of the workshop groups that have bookings with status code "stop"?
P: Which workshop groups have bookings with status code "stop"? Give me the names.

select T2.Store_Name
from Bookings as T1 join Drama_Workshop_Groups as T2 on
T1.Workshop_Group_ID = T2.Workshop_Group_ID
where T1.Status_Code = "stop"

S:
S:
S:

38. Show the names of all the clients with no booking.
P: What are the names of the clients who do not have any booking?

select Customer_Name
from Clients
EXCEPT
select T2.Customer_Name
from Bookings as T1 join Clients as T2
on T1.Customer_ID = T2.Client_ID

S:
S:
S:


39. What is the average quantities ordered with payment method code "MasterCard" on invoices?
P: Check the invoices record and compute the average quantities ordered with the payment method "MasterCard".

select avg(Order_Quantity)
from Invoices
where payment_method_code = "MasterCard"

S:
S:
S:


40. What is the product ID of the most frequently ordered item on invoices?
P: Find the id of the product ordered the most often on invoices.

select Product_ID
from INVOICES
group by Product_ID
order by COUNT(*) desc limit 1

S:
S:
S:


41. What is the description of the service type which offers both the photo product and the film product?
P: Give me the description of the service type that offers not only the photo product but also the film product.

select T1.Service_Type_Description
from Ref_Service_Types as T1 JOIN Services as T2
on T1.Service_Type_Code = T2.Service_Type_Code
where T2.Product_Name = 'photo'
INTERSECT
select T1.Service_Type_Description
from Ref_Service_Types as T1 JOIN Services as T2
on T1.Service_Type_Code = T2.Service_Type_Code
where T2.Product_Name = 'film'

S:
S:
S:


