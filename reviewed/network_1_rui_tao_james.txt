Total = # 30

1. How many high schoolers are there?
P: Count the number of high schoolers.

select count(*)
from Highschooler


2. Show the names and grades of each high schooler.
P: What are the names and grades for each high schooler?

select name, grade
from Highschooler


3. Show all the grades of the high schoolers.
P: What is the grade of each high schooler?

select grade
from Highschooler


4. What grade is Kyle in?
P: Return the grade for the high schooler named Kyle.

select grade
from Highschooler
where name = "Kyle"


5. Show the names of all high schoolers in grade 10.
P: What are the names of all high schoolers in grade 10?

select name
from Highschooler
where grade = 10


6. Show the ID of the high schooler named Kyle.
P: What is Kyle's id?

select ID
from Highschooler
where name = "Kyle"


7. How many high schoolers are there in grade 9 or 10?
P: Count the number of high schoolers in grades 9 or 10.


select count(*)
from Highschooler
where grade = 9 or grade = 10


8. Show the number of high schoolers for each grade.
P: How many high schoolers are in each grade?

select grade, count(*)
from Highschooler
group by grade


9. Which grade has the most high schoolers?
P: Return the grade that has the greatest number of high schoolers.

select grade
from Highschooler
group by grade
order by count(*) desc
limit 1


10. Show me all grades that have at least 4 students.
P: Which grades have 4 or more high schoolers?

select grade
from Highschooler
group by grade
having count(*) >= 4


11. Show the student IDs and numbers of friends corresponding to each.
P: How many friends does each student have?

select student_id, count(*)
from Friend
group by student_id

12. Show the names of high school students and their corresponding number of friends.
P: What are the names of the high schoolers and how many friends does each have?

select T2.name, count(*)
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id


13. What is the name of the high schooler who has the greatest number of friends?
P: Return the name of the high school student with the most friends.

select T2.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id
order by count(*) desc
limit 1


14. Show the names of high schoolers who have at least 3 friends.
P: What are the names of high schoolers who have 3 or more friends?

select T2.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id
having count(*) >= 3

15. What is the average, minimum, maximum number of friends for high schoolers?
P: Give the average, minimum, and maximum number of friends that high schoolers have.

with friend_num (num) as (select count(*)
from Friend
group by student_id)
select avg(num), min(num), max(num)
from friend_num

16. Show the names of all of the high schooler Kyle's friends.
P: Return the names of friends of the high school student Kyle. 

select T3.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id join Highschooler as T3 on T1.friend_id = T3.id
where T2.name = "Kyle"

17. How many friends does the high school student Kyle have?
P: Count the number of friends Kyle has.

select count(*)
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
where T2.name = "Kyle"

18. Show ids of all students who do not have any friends.
P: What are the ids of high school students who do not have friends?

select id
from Highschooler
EXCEPT
select student_id
from Friend

19. Show names of all high school students who do not have any friends.
P: What are the names of students who have no friends?

select name
from Highschooler
EXCEPT
select T2.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id

20. Show the ids of high schoolers who have friends and are also liked by someone else.
P: What are the ids of students who both have friends and are liked?

select student_id
from Friend
INTERSECT
select liked_id
from Likes

21. Show name of all students who have some friends and also are liked by someone else.
P: What are the names of high schoolers who both have friends and are liked?

select T2.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
INTERSECT
select T2.name
from Likes as T1 join Highschooler as T2 on T1.liked_id = T2.id

22. Count the number of likes for each student id.
P: How many likes correspond to each student id?

select student_id, count(*)
from Likes
group by student_id

23. Show the names of high schoolers who have likes, and numbers of likes for each.
P: What are the names of high schoolers who have likes, and how many likes does each have?

select T2.name, count(*)
from Likes as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id

24. What is the name of the high schooler who has the greatest number of likes?
P: Give the name of the student with the most likes.

select T2.name
from Likes as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id
order by count(*) desc
limit 1

25. Show the names of students who have at least 2 likes.
P: What are the names of students who have 2 or more likes?

select T2.name
from Likes as T1 join Highschooler as T2 on T1.student_id = T2.id
group by T1.student_id
having count(*) >= 2

26. Show the names of students who have a grade higher than 5 and have at least 2 friends.
P: What are the names of high schoolers who have a grade of over 5 and have 2 or more friends?

select T2.name
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id
where T2.grade > 5
group by T1.student_id
having count(*) >= 2

27. What is the average, minimum, maximum number of likes for students?
P: Return the average, minimum, and maximum number of likes across high schoolers.

with like_num (num) as (select count(*)
from Likes
group by student_id)
select avg(num), min(num), max(num)
from like_num

28. How many likes does Kyle have?
P: Return the number of likes that the high schooler named Kyle has.

select count(*)
from Likes as T1 join Highschooler as T2 on T1.student_id = T2.id
where T2.name = "Kyle"

29. Find the average grade of all students who have some friends.
P: What is the average grade of students who have friends?

select avg(grade)
From Highschooler
where id IN (select T1.student_id
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id)

30. Find the minimum grade of students who have no friends.
P: What is the lowest grade of students who do not have any friends?

select min(grade)
From Highschooler
where id NOT IN (select T1.student_id
from Friend as T1 join Highschooler as T2 on T1.student_id = T2.id)
