Total # = 41

1. What is the name of the highest rated wine?
P: Give the name of the wine with the highest score.

select Name
from WINE
order by Score
limit 1

2. Which winery is the wine that has the highest score from?
P: What is the winery at which the wine with the highest score was made?

select Winery
from WINE
order by SCORE
limit 1


3. Find the names of all wines produced in 2008.
P: What are the names of all wines produced in 2008?

Select Name
from WINE
Where Year = "2008"

4. List the grapes and appelations of all wines.
P: What are the grapes and appelations of each wine?

select Grape, Appelation
from WINE

5. List the names and scores of all wines.
P: What are the names and scores of all wines?

select Name, Score
from WINE

6. List the area and county of all appelations.
P: What are the areas and counties for all appelations?

select Area, County
from APPELLATIONS

7. What are the prices of wines produced before the year of 2010?
P: Return the prices of wines produced before 2010.

select Price
from WINE
Where Year < 2010

8. List the names of all distinct wines that have scores higher than 90.
P: What are the names of wines with scores higher than 90?

select Name 
from WINE
Where score > 90


9. List the names of all distinct wines that are made of red color grape.
P: What are the names of wines made from red grapes?

Select DISTINCT T2.Name
From GRAPES as T1 JOIN WINE as T2 ON T1.Grape = T2.Grape
Where T1.Color = "Red"

10. Find the names of all distinct wines that have appellations in North Coast area.
P: What are the distinct names of wines that have appellations in the North Coast area?

Select DISTINCT T2.Name
From APPELLATIONs as T1 JOIN WINE as T2 ON T1.Appelation = T2.Appelation
Where T1.Area = "North Coast"


11. How many wines are produced at Robert Biale winery?
P: Count the number of wines produced at Robert Biale winery.

Select count(*)
From WINE
where Winery = "Robert Biale"

12. How many appelations are in Napa Country?
P: Count the number of appelations in Napa County.

Select count(*)
From APPELLATIONS
where County = "Napa"


13. Give me the average prices of wines that are produced by appelations in Sonoma County.
P: What is the average price of wines produced in appelations in Sonoma County?

Select AVG(T2.Price)
From APPELLATIONS as T1 JOIN WINE as T2 ON T1.Appelation = T2.Appelation
Where T1.County = "Sonoma"


14. What are the names and scores of wines that are made of white color grapes?
P: Give the names and scores of wines made from white grapes.

Select T2.Name,  T2.Score
From GRAPES as T1 JOIN WINE as T2 ON T1.Grape = T2.Grape
Where T1.Color = "White"

15. Find the maximum price of wins from the appelations in Central Coast area and produced before the year of 2005.
P: What is the maximum price of wines from the appelation in the Central Coast area, which was produced before 2005?

Select max(T2.Price)
From APPELLATIONS as T1 JOIN WINE as T2 ON T1.Appelation = T2.Appelation
Where T1.Area = "Central Coast" and T2.year < 2005

16. Find the the grape whose white color grapes are used to produce wines with scores higher than 90.
P: Find the white grape used to produce wines with scores above 90.

Select distinct T1.Grape
From GRAPES as T1 JOIN WINE as T2 ON T1.Grape = T2.Grape
Where T1.Color = "White" and T2.score > 90

17. What are the wines that have prices higher than 50 and made of Red color grapes?
P: What are the names of wines made from red grapes and with prices above 50?

Select T2.Name
From Grapes as T1 JOIN WINE as T2 ON T1.Grape = T2.Grape
where T1.Color = "Red" and T2.price > 50

18. What are the wines that have prices lower than 50 and have appelations in Monterey county?
P: Give the neames of wines with prices below 50 and with appelations in Monterey county.

Select T2.Name
From APPELLATIONS as T1 JOIN WINE as T2 ON T1.Appelation = T2.Appelation
where T1.County = "Monterey" and T2.price < 50


19. What are the numbers of wines for different grapes?
P: How many wines are there for each grape?

Select count(*), Grape
From WINE
group by Grape

20. What are the average prices of wines for different years?
P: What is the average prices of wines for each each?

Select avg(Price), Year
From WINE
group by Year


21.  Find the distinct names of all wines that have prices higher than some wines from John Anthony winery.
P: What are the distinct names of wines with prices higher than any wine from John Anthony winery.

Select distinct T1.Name
From WINE as T1, WINE as T2
where T1.Price > T2.Price and T2.Winery = "John Anthony"


22. List the names of all distinct wines in alphabetical order.
P: What are the names of wines, sorted in alphabetical order?

Select distinct Name
From WINE
Order by Name

23. List the names of all distinct wines ordered by price.
P: What are the names of wines, sorted by price ascending?

Select distinct Name
From WINE
Order by price

24. What is the area of the appelation that produces the highest number of wines before the year of 2010?
P: What is the area for the appelation which produced the most wines prior to 2010?

Select T1.Area
From APPELLATIONS as T1 JOIN WINE as T2 ON T1.Appelation = T2.Appelation
group by T2.Appelation
having T2.year < 2010
order by count(*) DESC
LIMIT 1

25. What is the color of the grape whose wine products has the highest average price?
P: Give the color of the grape whose wine products have the highest average price?

Select T1.Color
From GRAPES as T1 JOIN WINE as T2 ON T1.Grape = T2.Grape
group by T2.Grape
order by AVG(Price) DESC
LIMIT 1

26. Find the distinct names of wines produced before the year of 2000 or after the year of 2010.
P: Give the distinct names of wines made before 2000 or after 2010.

Select distinct Name
From WINE
where year < 2000 or year > 2010

27. Find the distinct winery of wines having price between 50 and 100.
P: What are the distinct wineries which produce wines costing between 50 and 100?

Select distinct Winery
From WINE
where Price between 50 and 100


28. What are the average prices and cases of wines produced in the year of 2009 and made of Zinfandel grape?
P: Give the average price and case of wines made from Zinfandel grapes in the year 2009.

Select AVG(Price), AVG(Cases)
From WINE
where Year = 2009 and Grape = "Zinfandel"

29. What are the maximum price and score of wines produced by St. Helena appelation?
P: Give the maximum price and score for wines produced in the appelation St. Helena.

Select max(Price), max(Score)
From WINE
where Appelation = "St. Helena"


30. What are the maximum price and score of wines in each year?
P: What are the maximum price and score of wines for each year?

Select max(Price), max(Score), Year
From WINE
group by year

31. What are the average price and score of wines grouped by appelation?
P: What are the average price and score of wines for each appelation?

Select avg(Price), avg(Score), Appelation
From WINE
group by Appelation


32. Find the wineries that have at least four wines.
P: Which wineries produce at least four wines?

Select Winery
From WINE
group by Winery
having count(*) >= 4

33. Find the country of all appelations who have at most three wines.
P: What are the countries for appelations with at most 3 wines?

Select T1.County
From APPELLATIONS as T1 JOIN WINE as T2 on T1.Appelation = T2.Appelation
group by T2.Appelation
having count(*) <= 3

34. What are the names of wines whose production year are before the year of all wines by Brander winery?
P: What are the names of wines produced before any wine from the Brander winery?

Select Name
From WINE
where year < (select min(Year) from WINE where Winery = "Brander")

35. What are the names of wines that are more expensive then all wines made in the year 2006?
P: Give the names of wines with prices above any wine produced in 2006.

Select Name
From WINE
where Price > (select max(Price) from WINE where Year = 2006)

36. Find the top 3 wineries with the greatest number of wines made of white color grapes.
P: Which 3 wineries produce the most wines made from white grapes?

Select T2.Winery
From GRAPES as T1 JOIN WINE as T2 ON T1.GRAPE = T2.GRAPE
where T1.Color = "White"
group by T2.Winery
order by count(*) DESC
LIMIT 3


37. List the grape, winery and year of the wines whose price is bigger than 100 ordered by year.
P: What are the grapes, wineries and years for wines with price higher than 100, sorted by year?

Select Grape, Winery, Year
From WINE
where Price >  100
order by Year

38. List the grape, appelation and name of wines whose score is higher than 93 ordered by Name.
P: What are the grapes, appelations, and wines with scores above 93, sorted by Name?

Select Grape, Appelation, Name
From WINE
where Score > 93
order by Name


39. Find the appelations that produce wines after the year of 2008 but not in Central Coast area.
P: What are the appelations for wines produced after 2008 but not in the Central Coast area?

Select Appelation from WINE Where Year > 2008
EXCEPT
Select Appelation from APPELLATIONS Where Area = "Central Coast"

40. Find the average price of wines that are not produced from Sonoma county.
P: What is the average price for wines not produced in Sonoma county?

Select avg(price)
from wine
where Appelation NOT IN
(Select T1.Appelation 
From APPELLATIONS as T1 JOIN WINE as T2 on T1.Appelation = T2.Appelation
where T1.County = 'Sonoma')

41. Find the county where produces the most number of wines with score higher than 90.
P: What is the county that produces the most wines scoring higher than 90?

Select T1.County
From APPELLATIONS as T1 JOIN WINE as T2 on T1.Appelation = T2.Appelation
where T2.Score > 90
group by T1.County
order by count(*) desc
limit 1
