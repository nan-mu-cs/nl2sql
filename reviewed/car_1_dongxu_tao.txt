
Total # = 46

1. How many continents are there?
P: What is the number of continents?

select count(*)
from CONTINENTS;

S:
S:
S:

2. How many countries does each continent have? List the continent id, continent name and the number of countries.
P: For each continent, list its id, name, and how many countries it has?

select T1.ContId, T1.Continent, count(*)
from CONTINENTS as T1 JOIN COUNTRIES as T2 on T1.ContId = T2.Continent
group by T1.ContId;

S:
S:
S:

3. How many countries are listed?
P: How many countries exist?

select count(*)
from COUNTRIES;

S:
S:
S:

4. How many models does each car maker produce? List maker full name, id and the number.
P: What is the full name of each car maker, along with its id and how many models it produces?

select T1.FullName, T1.Id, count(*)
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
group by T1.Id;

S:
S:
S:

5. Which model of the car has the minimum horsepower?
P: What is the model of the car with the smallest amount of horsepower?

select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
order by T2.horsepower ASC LIMIT 1;

S:
S:
S:

6. Find the model of the car whose weight is below the average weight.
P: What is the model for the car with a weight smaller than the average?

select T1.model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.Weight < (select avg(Weight) from CARS_DATA)

S:
S:
S:

7. Find the name of the makers that produced some cars in the year of 1970?
P: What is the name of the different car makers who produced a car in 1970?

select distinct T1.Maker
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2
on T1.Id = T2.Maker JOIN CAR_NAMES as T3
on T2.model = T3.model JOIN CARS_DATA as T4
on T3.MakeId = T4.id
where T4.year = '1970';

S:
S:
S:

8. Find the make and production time of the cars that were produced in the earliest year?
P: What is the maker of the carr produced in the earliest year and what year was it?

select T2.Make, T1.Year
from CARS_DATA as T1 join CAR_NAMES as T2
on T1.Id = T2.MakeId
where T1.Year = (select min(Year)
from CARS_DATA);

S:
S:
S:

9. Which distinct car models are the produced after 1980?
P: What are the different models for the cards produced after 1980?

select distinct T1.model
from MODEL_LIST as T1 JOIN CAR_NAMES as T2
on T1.model = T2.model JOIN CARS_DATA as T3
on T2.MakeId = T3.id
where T3.year > 1980;

S:
S:
S:

10. How many car makers are there in each continents? List the continent name and the count.
P: What is the name of each continent and how many car makers are there in each one?

select T1.Continent, count(*)
from CONTINENTS as T1 JOIN COUNTRIES as T2
on T1.ContId = T2.continent JOIN car_makers as T3
on T2.CountryId = T3.Country
group by T1.Continent;

S:
S:
S:

11. Which of the countries has the most car makers? List the country name.
P: What is the name of the country with the most car makers?

select T2.CountryName
from CAR_MAKERS as T1 JOIN COUNTRIES as T2 on T1.Country = T2.CountryId
group by T1.Country
order by Count(*) DESC LIMIT 1;

S:
S:
S:

12. How many car models are produced by each maker? List the count and the maker full name.
P: What is the number of car models that are produced by each maker and what is the id and full name of each maker?

 select Count(*), T2.FullName, T2.id
 from MODEL_LIST as T1 JOIN CAR_MAKERS as T2 on T1.Maker = T2.Id
 group by T2.id;

S:
S:
S:

13. What is the accelerate of the car make amc hornet sportabout (sw)?
P: How much does the car accelerate that makes amc hornet sportabout (sw)?

select T1.Accelerate
from CARS_DATA as T1 JOIN CAR_NAMES as T2 on T1.Id = T2.MakeId
where T2.Make = 'amc hornet sportabout (sw)';

S:
S:
S:


14. How many car makers are there in france?
P: What is the number of makers of care in France?

select count(*)
from CAR_MAKERS as T1 JOIN COUNTRIES as T2 on T1.Country = T2.CountryId
where T2.CountryName = 'france';

S:
S:
S:


15. How many car models are produced in the usa?
P: What is the count of the car models produced in the United States?

select count(*)
from MODEL_LIST as T1 JOIN CAR_MAKERS as T2 on T1.Maker = T2.Id
JOIN COUNTRIES as T3 on T2.Country = T3.CountryId
where T3.CountryName = 'usa';

S:
S:
S:


16. What is the average miles per gallon(mpg) of the cars with 4 cylinders?
P: What is the average miles per gallon of all the cards with 4 cylinders?

select avg(mpg)
from CARS_DATA
where Cylinders = 4;

S:
S:
S:



17. What is the smallest weight of the car produced with 8 cylinders on 1974?
P: What is the minimu weight of the car with 8 cylinders produced in 1974?

select Weight
from CARS_DATA
where Cylinders = 4 and Year = 1974
order by Weight asc Limit 1;

S:
S:
S:


18. What are all the makers and models?
P: What are the makers and models?

select Maker, Model
from MODEL_LIST;

S:
S:
S:


19. What are the countries having at least one car maker? List name and id.
P: What are the names and ids of all countries with at least one car maker?

select T1.CountryName, T1.CountryId
from COUNTRIES as T1 JOIN CAR_MAKERS as T2 on T1.CountryId = T2.Country
group by T1.CountryId
having count(*) >= 1;

S:
S:
S:


20. What is the number of the cars with horsepower more than 150?
P: What is the number of cars with a horsepower greater than 150?

select count(*)
from CARS_DATA
where horsepower > 150;

S:
S:
S:


21. What is the average weight of cars each year?
P: What is the average weight and year for each year?

select avg(Weight), Year
from CARS_DATA
group by Year;

S:
S:
S:

22. Which countries in europe have at least 3 car manufacturers?
P: What are the names of all European countries with at least 3 manufacturers?

select T1.CountryName
from COUNTRIES as T1 JOIN CONTINENTS as T2
on T1.Continent = T2.ContId
JOIN CAR_MAKERS as T3
on T1.CountryId = T3.Country
where T2.Continent = 'europe'
group by T1.CountryName
having count(*) >= 3;

S:
S:
S:


23. What is the maximum horsepower and the make of the car models with 3 cylinders?
P: What is the largest amount of horsepower for the models with 3 cylinders and what make is it?

select T2.horsepower, T1.Make
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.cylinders = 3
order by T2.horsepower DESC LIMIT 1;

S:
S:
S:


24. Which model saves the most gasoline? That is to say, have the maximum miles per gallon.
P: What is the car wmodel with the highest mpg?

select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
order by T2.mpg DESC LIMIT 1;

S:
S:
S:


25. What is the average horsepower of the cars before 1980?
P: What is the average horsepower for all cards produced before 1980?

select avg(horsepower)
from CARS_DATA
where Year < 1980;

S:
S:
S:

26. What is the average edispl of the cars of model volvo?
P: What is the average edispl for all volvos?

select avg(T2.edispl)
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T1.Model = 'volvo';

S:
S:
S:

27. What is the maximum accelerate for different number of cylinders?
P: What is the maximum accelerate for all the different cylinders?

select max(Accelerate), Cylinders
from CARS_DATA
group by Cylinders;

S:
S:
S:

28. Which model has the most version(make) of cars?
P: What model has the most different versions?

select Model
from CAR_NAMES
group by Model
order by count(*) DESC LIMIT 1;

S:
S:
S:

29. How many cars have more than 4 cylinders?
P: What is the number of cars with more than 4 cylinders?

select count(*)
from CARS_DATA
where Cylinders > 4;

S:
S:
S:

30. how many cars were produced in 1980?
P: In 1980, how many cars were made?

select count(*)
from CARS_DATA
where Year = 1980;

S:
S:
S:

31. How many car models were produced by the maker with full name American Motor Company?
P: What is the number of car models created by the car maker American Motor Company?

select count(*)
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
where T1.FullName = 'American Motor Company';

S:
S:
S:

32. Which makers designed more than 3 car models? List full name and the id.
P: What are the names and ids of all makers with more than 3 models?

select T1.FullName, T1.Id
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2 on T1.Id = T2.Maker
group by T1.Id
having count(*) > 3;

S:
S:
S:

33. Which distinctive models are produced by maker with the full name General Motors or weighing more than 3500?
P: What are the different models created by either the car maker General Motors or weighed more than 3500?

select distinct T2.Model
from CAR_NAMES as T1 JOIN MODEL_LIST as T2
on T1.Model = T2.Model
JOIN CAR_MAKERS as T3 on T2.Maker = T3.Id
JOIN CARS_DATA as T4
on T1.MakeId = T4.Id
where T3.FullName = 'General Motors' or T4.weight > 3500;

S:
S:
S:


34. In which years cars were produced weighing no less than 3000 and no more than 4000?
P: What are the different years in which there were cars produced that weighed less than 4000 and also cars that weighted more than 3000?

select distinct T1.Year
from CARS_DATA as T1
where T1.Weight > 3000 and T1.weight < 4000;

S:
S:
S:


35. What is the horsepower of the car with the largest accelerate?
P: What is the horsepower of the car with the greatest accelerate?

select T1.horsepower
from CARS_DATA as T1
order by T1.accelerate DESC LIMIT 1;

S:
S:
S:

36. For model volvo, how many cylinders does the car with the least accelerate have?
P: For a volvo model, how many cylinders does the version with least accelerate have?

select T1.cylinders
from CARS_DATA as T1 JOIN CAR_NAMES as T2
on T1.Id = T2.MakeId
where T2.Model = 'volvo'
order by T1.accelerate asc limit 1;

S:
S:
S:

37. How many cars have a larger accelerate than the car with the largest horsepower?
P: What is the number of cars with a greater accelerate than the one with the most horsepower?

select COUNT(*)
from CARS_DATA
where Accelerate > (
        select Accelerate
        from CARS_DATA
        order by Horsepower DESC LIMIT 1
);

S:
S:
S:

38. How many countries has more than 2 car makers?
P: What is the number of countries with more than 2 car makers?

select COUNT(*)
from (
 select T1.CountryId, COUNT(*)
 from COUNTRIES as T1 join CAR_MAKERS as T2 on T1.CountryId = T2.Country
 group by T1.CountryId
 having count(*) > 2
);

S:
S:
S:

39. How many cars has over 6 cylinders?
P: What is the number of carsw ith over 6 cylinders?

select COUNT(*)
from CARS_DATA
where Cylinders > 6;

S:
S:
S:

40. For the cars with 4 cylinders, which model has the largest horsepower?
P: For all of the 4 cylinder cars, which model has the most horsepower?

select T1.Model
from CAR_NAMES as T1 JOIN CARS_DATA as T2 on T1.MakeId = T2.Id
where T2.Cylinders = 4
order by T2.horsepower DESC LIMIT 1;

S:
S:
S:

41. Among the cars with more than lowest horsepower, which ones do not have more than 3 cylinders? List the car makeid and make name.
P: Among the cars that do not have the minimum horsepower, what are the make ids and names of al those with less than 4 cylinders?


select T2.MakeId, T2.Make
from CARS_DATA as T1 JOIN CAR_NAMES as T2 on T1.Id = T2.MakeId
where T1.Horsepower > (select min(Horsepower) from CARS_DATA) and T1.Cylinders <= 3;


S:
S:
S:

42. What is the maximum miles per gallon of the car with 8 cylinders or produced before 1980?
P: What is the maximum mpg of the cars that had 8 cylinders or that were produced before 1980?

select mpg
from CARS_DATA
where Cylinders = 8 or Year < 1980
order by mpg desc Limit 1;

S:
S:
S:


43. Which models are lighter than 3500 but not built by the 'Ford Motor Company'?
P: What are the different models wthat are lighter than 3500 but were not built by the Ford Motor Company?

select distinct T1.model
from MODEL_LIST as T1 JOIN CAR_NAMES as T2
on T1.Model = T2.Model
JOIN CARS_DATA as T3 on T2.MakeId = T3.Id
JOIN CAR_MAKERS as T4
on T1.Maker = T4.Id
where T3.weight < 3500 and T4.FullName != 'Ford Motor Company';

S:
S:
S:


44. What are the name of the countries where there is not a single car maker?
P: What are the names of the countries with no car makers?

select CountryName
from countries
EXCEPT
select T1.CountryName
from countries as T1 JOIN CAR_MAKERS as T2
on T1.countryId = T2.Country;

S:
S:
S:

45. Which are the car makers which produce at least 2 models and more than 3 car makes? List the id and the maker.
P: What are the ids and makers of all car makers that produce at least 2 models and make more than 3 cars?


select T1.Id, T1.Maker
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2
on T1.Id = T2.Maker
group by T1.Id
having count(*) >= 2
INTERSECT
select T1.Id, T1.Maker
from CAR_MAKERS as T1 JOIN MODEL_LIST as T2
on T1.Id = T2.Maker
JOIN CAR_NAMES as T3
on T2.model = T3.model
group by T1.Id
having count(*) > 3;

S:
S:
S:

46. What are the id and names of the countries which have more than 3 car makers or produce the 'fiat' model?
P: What are the ids and names of all countries that either have more than 3 car makers or produce fiats?

select T1.countryId, T1.CountryName
from Countries as T1 JOIN CAR_MAKERS as T2
on T1.CountryId = T2.Country
group by T1.countryId
having count(*) > 3
UNION
select T1.countryId, T1.CountryName
from Countries as T1 JOIN CAR_MAKERS as T2
on T1.CountryId = T2.Country
JOIN MODEL_LIST as T3
on T2.Id = T3.Maker
where T3.Model = 'fiat';

S:
S:
S:

