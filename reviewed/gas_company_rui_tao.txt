1. How many gas companies are there?
P: What is the total number of companies?

select count(*)
from company

2. List the company name and rank for all companies in the decreasing order of their sales.
P: What is the name and rank of every company ordered by descending number of sales?

select company, rank
from company
order by Sales_billion desc

3. Show the company name and the main industry for all companies whose headquarters are not from USA.
P: What are the companies and main industries of all companies that are not headquartered in the United States?

select company, main_industry
from company
where headquarters != 'USA'

4. Show all company names and headquarters in the descending order of market value.
P: What are the names and headquarters of all companies ordered by descending market value?

select company, headquarters
from company
order by market_value desc

5. Show minimum, maximum, and average market value for all companies.
P: What is the minimum, maximum, and average market value for every company?

select min(market_value), max(market_value), avg(market_value)
from company

6. Show all main industry for all companies.
P: What are the different main industries for all companies?

select distinct main_industry
from company

7. List all headquarters and the number of companies in each headquarter. 
P: For each headquarter, what are the headquarter and how many companies are centered there?

select headquarters, count(*)
from company 
group by headquarters

8. Show all main industry and total market value in each industry.
P: What are the main indstries and total market value for each industry? 

select main_industry, sum(market_value)
from company
group by main_industry

9. List the main industry with highest total market value and its number of companies.
P: For each main industry, what is the total number of companies for the industry with the highest total market value?

select main_industry, count(*)
from company
group by main_industry
order by sum(market_value) desc
limit 1

10. Show headquarters with at least two companies in the banking industry.
P: What are the headquarters with at least two companies in the banking industry?

select headquarters
from company
where main_industry = 'Banking'
group by headquarters
having count(*) >= 2

11. Show gas station id, location, and manager_name for all gas stations ordered by open year.
P: What are the gas station ids, locations, and manager names for the gas stations ordered by opening year?

select station_id, location, manager_name
from gas_station
order by open_year

12. How many gas station are opened between 2000 and 2005?
P: What is the total number of gas stations that opened between 2000 and 2005?

select count(*)
from gas_station
where open_year between 2000 and 2005

13. Show all locations and the number of gas stations in each location ordered by the count.
P: For each location, how many gas stations are there in order?

select location, count(*)
from gas_station
group by location
order by count(*)

14. Show all headquarters with both a company in banking industry and a company in Oil and gas.
P: What are the headquarters that have both a company in the banking and 'oil and gas' industries?

select headquarters
from company
where main_industry = 'Banking'
INTERSECT
select headquarters
from company
where main_industry = 'Oil and gas'

15. Show all headquarters without a company in banking industry.
P: What are the headquarters without companies that are in the banking industry?

select headquarters
from company
EXCEPT
select headquarters
from company
where main_industry = 'Banking'

16. Show the company name with the number of gas station.
P: For each company id, what are the companies and how many gas stations does each one operate?

select T2.company, count(*)
from station_company as T1 join company as T2 on T1.company_id = T2.company_id
group by T1.company_id

17. Show company name and main industry without a gas station.
P: What are the main industries of the companies without gas stations and what are the companies? 

select company, main_industry
from company
where company_id not in (select company_id from station_company)

18. Show the manager name for gas stations belonging to the ExxonMobil company.
P: What are the names of the managers for gas stations that are operated by the ExxonMobil company? 


select T3.manager_name
from station_company as T1 join company as T2 on T1.company_id = T2.company_id join gas_station as T3 on T1.station_id = T3.station_id
where T2.company = 'ExxonMobil'

19. Show all locations where a gas station for company with market value greater than 100 is located.
P: What are the locations that have gas stations owned by a company with a market value greater than 100?

select T3.location
from station_company as T1 join company as T2 on T1.company_id = T2.company_id join gas_station as T3 on T1.station_id = T3.station_id
where T2.market_value > 100

20. Show the manager name with most number of gas stations opened after 2000.
P: What is the name of the manager with the most gas stations that opened after 2000?

select manager_name
from gas_station
where open_year > 2000
group by manager_name
order by count(*) desc
limit 1

21. order all gas station locations by the opening year.
P: What are the locations of all the gas stations ordered by opening year?


select location
from gas_station
order by open_year

22. find the rank, company names, market values of the companies in the banking industry order by their sales and profits in billion.
P: What is the rank, company, and market value of every comapny in the banking industry ordered by sales and profits? 

select rank, company, market_value
from company
where main_industry = 'Banking'
order by sales_billion, profits_billion

23. find the location and Representative name of the gas stations owned by the companies with top 3 Asset amounts.
P: What are the locations and representatives' names of the gas stations owned by the companies with the 3 largest amounts of assets? 

select T3.location, T3.Representative_Name
from station_company as T1 join company as T2 on T1.company_id = T2.company_id join gas_station as T3 on T1.station_id = T3.station_id
order by T2.Assets_billion desc
limit 3
