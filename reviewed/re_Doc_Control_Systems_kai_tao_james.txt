Total = #35

1. What document status codes do we have?

SELECT document_status_code FROM Ref_Document_Status;

S:
S:
S:

2. What is the description of document status code 'working'?

SELECT document_status_description 
FROM Ref_Document_Status
WHERE document_status_code="working";

S:
S:
S:

3. What document type codes do we have?

SELECT document_type_code FROM Ref_Document_Types;

S:
S:
S:

4. What is the description of document type 'Paper'?

SELECT document_type_description
FROM Ref_Document_Types
WHERE document_type_code="Paper";

S:
S:
S:

5. What are the shipping agent names?

SELECT shipping_agent_name FROM Ref_Shipping_Agents;

S:
S:
S:

6. What is the shipping agent code of shipping agent UPS?

SELECT shipping_agent_code
FROM Ref_Shipping_Agents
WHERE shipping_agent_name="UPS";

S:
S:
S:

7. What are all role codes?

SELECT role_code FROM Roles;

S:
S:
S:

8. What is the description of role code ED?

SELECT role_description
FROM Roles
WHERE role_code="ED";

S:
S:
S:

9. How many employees do we have?

SELECT count(*)
FROM Employees;

S:
S:
S:

10. What is the role of the employee named Koby?

SELECT T1.role_description
FROM Roles as T1 JOIN Employees as T2
ON T1.role_code=T2.role_code
WHERE T2.employee_name="Koby";

S:
S:
S:

11. List all document ids and receipt dates of documents.

SELECT document_id, receipt_date FROM Documents;

S:
S:
S:

12. How many employees does each role have? List role description, id and number of employees.

SELECT T1.role_description, T2.role_code, count(*)
FROM Roles as T1 JOIN Employees as T2
ON T1.role_code=T2.role_code
GROUP BY T2.role_code;

S:
S:
S:

13. List roles that have more than one employee. List the role description and number of employees.

SELECT Roles.role_description,count(Employees.employee_id)
FROM Roles JOIN Employees ON Employees.role_code=Roles.role_code
GROUP BY Employees.role_code
HAVING count(Employees.employee_id) > 1;

S:
S:
S:

14. What is the document status description of the document with id 1? 

SELECT Ref_Document_Status.document_status_description
FROM Ref_Document_Status JOIN Documents ON Documents.document_status_code=Ref_Document_Status.document_status_code
WHERE Documents.document_id=1;

S:
S:
S:

15. How many documents have the status code done?

SELECT count(*)
FROM Documents
WHERE document_status_code="done";

S:
S:
S:

17. List the document type code for the document with the id 2.

SELECT document_type_code
FROM Documents
WHERE document_id=2;

S:
S:
S:

18. List the document ids for any documents with the status code done and the type code paper.

SELECT document_id
FROM Documents
WHERE document_status_code="done" and document_type_code="Paper";

S:
S:
S:

19. What is the name of the shipping agent of the document with id 2? 

SELECT Ref_Shipping_Agents.shipping_agent_name
FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code=Ref_Shipping_Agents.shipping_agent_code
WHERE Documents.document_id=2;

S:
S:
S:

20. How many documents were shipped by USPS?

SELECT count(*)
FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code=Ref_Shipping_Agents.shipping_agent_code
WHERE Ref_Shipping_Agents.shipping_agent_name="USPS";

S:
S:
S:

21. Which shipping agent shipped the most documents? List the shipping agent name and the number of documents.

SELECT Ref_Shipping_Agents.shipping_agent_name,count(Documents.document_id)
FROM Ref_Shipping_Agents JOIN Documents ON Documents.shipping_agent_code=Ref_Shipping_Agents.shipping_agent_code
GROUP BY Ref_Shipping_Agents.shipping_agent_code
ORDER BY count(Documents.document_id) DESC
LIMIT 1;

S:
S:
S:

22. What is the receipt date of the document with id 3?

SELECT receipt_date
FROM Documents
WHERE document_id=3;

S:
S:
S:

23. What address was the document with id 4 mailed to?

SELECT Addresses.address_details
FROM Addresses JOIN Documents_Mailed ON Documents_Mailed.mailed_to_address_id=Addresses.address_id
WHERE document_id=4;

S:
S:
S:

24. What is the mail date of the document with id 7?

SELECT mailing_date
FROM Documents_Mailed
WHERE document_id=7;

S:
S:
S:

25. List the document ids of documents with the status done and type Paper, which not shipped by the shipping agent named USPS.

SELECT document_id
FROM Documents
WHERE document_status_code = "done" and document_type_code="Paper"
EXCEPT
SELECT document_id
FROM Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code=Ref_Shipping_Agents.shipping_agent_code
WHERE Ref_Shipping_Agents.shipping_agent_name="USPS";

S:
S:
S:

26. List document id of documents status is done and document type is Paper and the document is shipped by shipping agent named USPS.

SELECT document_id
FROM Documents
WHERE document_status_code = "done" and document_type_code="Paper"
INTERSECT
SELECT document_id
FROM Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code=Ref_Shipping_Agents.shipping_agent_code
WHERE Ref_Shipping_Agents.shipping_agent_name="USPS";

S:
S:
S:

27. What is draft detail of the document with id 7?

SELECT draft_details
FROM Document_Drafts
WHERE document_id=7;

S:
S:
S:

28. How many draft copies does the document with id 2 have?

SELECT count(*)
FROM Draft_Copies
WHERE document_id=2;

S:
S:
S:

29. Which document has the most draft copies? List its document id and number of draft copies.

SELECT document_id,count(copy_number)
FROM Draft_Copies
GROUP BY document_id
ORDER BY count(copy_number) DESC
LIMIT 1;

S:
S:
S:

30. Which documents have more than 1 draft copies? List document id and number of draft copies.

SELECT document_id,count(*)
FROM Draft_Copies
GROUP BY document_id
HAVING count(*) > 1;

S:
S:
S:

31. List all employees in the circulation history of the document with id 1. List the employee's name.

SELECT Employees.employee_name
FROM Employees JOIN Circulation_History ON Circulation_History.employee_id=Employees.employee_id
WHERE Circulation_History.document_id=1;

S:
S:
S:

32. List the employees who have not showed up in any circulation history of documents. List the employee's name.

SELECT employee_name
FROM Employees
EXCEPT
SELECT Employees.employee_name
FROM Employees JOIN Circulation_History ON Circulation_History.employee_id=Employees.employee_id

S:
S:
S:

33. Which employee has showed up in most circulation history documents. List the employee's name and the number of drafts and copies.

SELECT Employees.employee_name,count(*)
FROM Employees JOIN Circulation_History ON Circulation_History.employee_id=Employees.employee_id
GROUP BY Circulation_History.document_id,Circulation_History.draft_number,Circulation_History.copy_number
ORDER BY count(*) DESC
LIMIT 1;

S:
S:
S:

34. For each document, list the number of employees who have showed up in the circulation history of that document. List the document ids and number of employees.

SELECT document_id, count(distinct employee_id)
FROM Circulation_History
GROUP BY document_id;

S:
S:
S:

35 List the ids of documents for which no employee has showed up in the corresponding circulation history.

SELECT Documents.document_id
FROM Documents LEFT OUTER JOIN Circulation_History ON Documents.document_id= Circulation_History.document_id
GROUP BY Documents.document_id
HAVING count(*) = 0;

S:
S:
S:
