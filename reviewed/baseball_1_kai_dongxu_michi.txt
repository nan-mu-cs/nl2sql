# Total = 42

1. what is the full name and id of the college with the largest number of baseball players?
P: Find the full name and id of the college that has the most baseball players.

SELECT T1.name_full, T1.college_id
FROM college as T1 join player_college as T2 on T1.college_id = T2.college_id
GROUP BY T1.college_id
ORDER BY count(*) desc
LIMIT 1;

S:
S:
S:


2. What is average salary of the players in the team named 'Boston Red Stockings' ?
P: Compute the average salary of the players in the team called 'Boston Red Stockings'.

SELECT avg(T1.salary)
FROM salary as T1 join team as T2 on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings'

S:
S:
S:


3. What are first and last names of players participating in all star game in 1998?
P: List the first and last name for players who participated in all star game in 1998.

SELECT name_first, name_last
FROM player as T1 join all_star as T2 on T1.player_id = T2.player_id
WHERE year = 1998

S:
S:
S:


4. What are the first name, last name and id of the player with the most all star game experiences? Also list the count.
P: Which player has the most all star game experiences? Give me the first name, last name and id of the player, as well as the number of times the player participated in all star game.

SELECT T1.name_first,T1.name_last, T1.player_id,  count(*)
FROM player as T1 join all_star as T2 on T1.player_id = T2.player_id
GROUP BY T1.player_id
ORDER BY count(*) desc
LIMIT 1;

S:
S:
S:


5.  What are the id and name of the team appearing at any game with the most all star players?
P: Find the id and name of the team that had the most all star players.

select T2.team_id, T1.name
from team as T1 JOIN appearances as T2
ON T1.team_id = T2.team_id
JOIN all_star as T3 ON T2.player_id = T3.player_id
group by T2.team_id
order by count(*) desc
limit 1;

S:
S:
S:


6. How many players enter hall of fame each year?
P: Count the number of players who enter hall of fame for each year.

SELECT yearid, count(*)
FROM hall_of_fame
GROUP BY yearid;

S:
S:
S:


7. What is the average number of attendance at home games for each year?
P: For each year, return the year and the average number of attendance at home games.

SELECT year, avg(attendance)
FROM home_game
GROUP BY year;

S:
S:
S:


8. In 2014, what are the id and rank of the team that has the largest average number of attendance?
P: Find the id and rank of the team that has the highest average attendance rate in 2014.

SELECT T2.team_id, T2.rank
FROM home_game as T1 join team as T2
on T1.team_id = T2.team_id
WHERE T1.year = 2014
GROUP BY T1.team_id
ORDER BY avg(T1.attendance) desc
LIMIT 1;

S:
S:
S:


9. What are the manager's first name, last name and id who won the most manager award?
P: Which manager won the most manager award? Give me the manager's first name, last name and id.

SELECT T1.name_first, T1.name_last, T2.player_id
FROM player as T1 join manager_award as T2 on T1.player_id = T2.player_id
GROUP BY T2.player_id
ORDER BY count(*) desc
LIMIT 1;

S:
S:
S:


10. How many parks are there in the state of NY?
P: Show me the number of parks the state of NY has.

SELECT count(*)
FROM park
WHERE state = 'NY';

S:
S:
S:


11. Which 3 players won the most player awards? List their full name and id.
P: Find the first name, last name and id for the top three players won the most player awards.

SELECT T1.name_first, T1.name_last, T1.player_id
FROM player as T1 join player_award as T2 on T1.player_id = T2.player_id
GROUP BY T1.player_id
ORDER BY count(*) desc
LIMIT 3;

S:
S:
S:


12. List three countries which are the origins of the least players.
P: What are the three countries that the least players are from?

SELECT birth_country
FROM player
GROUP BY birth_country
ORDER BY count(*) asc
LIMIT 3;

S:
S:
S:


13. Find all the players' first name and last name who have empty death record.
P: What are the first name and last name of the players whose death record is empty?

SELECT name_first, name_last
FROM player
WHERE death_year='';

S:
S:
S:


14. How many players born in USA are right-handed batters? That is, have the batter value 'R'.
P: Count the number of players who were born in USA and have bats information 'R'.

SELECT count(*)
FROM player
WHERE birth_country='USA' and bats = 'R';

S:
S:
S:


15. What is the average height of the players from the college named 'Yale University'?
P: Find the average height of the players who belong to the college called 'Yale University'.

SELECT avg(T1.height)
FROM player as T1 JOIN player_college T2 on T1.player_id = T2.player_id
JOIN college T3 on T3.college_id = T2.college_id
WHERE T3.name_full = 'Yale University';

S:
S:
S:


16. What is the highest salary among each team? List the team name, id and maximum salary.
P: For each team, return the team name, id and the maximum salary among the team.

SELECT T1.name, T1.team_id, max(T2.salary)
FROM team as T1 JOIN salary as T2 on T1.team_id = T2.team_id
GROUP BY T1.team_id;

S:
S:
S:


17. What are the name and id of the team offering the lowest average salary?
P: Which team offers the lowest average salary? Give me the name and id of the team.

SELECT T1.name, T1.team_id
FROM team as T1 JOIN salary as T2 on T1.team_id=T2.team_id
GROUP BY T1.team_id
ORDER BY avg(T2.salary) asc
LIMIT 1;

S:
S:
S:


18. Find the players' first name and last name who won award both in 1960 and in 1961.
P: Which players won awards in both 1960 and 1961? Return their first names and last names.

SELECT T1.name_first,T1.name_last
FROM player as T1 JOIN player_award as T2
WHERE T2.year = 1960
INTERSECT
SELECT T1.name_first,T1.name_last
FROM player as T1 JOIN player_award as T2
WHERE T2.year = 1961

S:
S:
S:


19. List players' first name and last name who have weight greater than 220 or height shorter than 75.
P: What are the first name and last name of the players who have weight above 220 or height below 75?

SELECT name_first, name_last
FROM player
WHERE weight > 220 or height < 75

S:
S:
S:


20. List the maximum scores of the team Boston Red Stockings when the team won in postseason?
P: What are the maximum scores the team Boston Red Stockings got when the team won in postseason?

SELECT max(T1.wins)
FROM postseason as T1 JOIN team as T2 ON T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings';

S:
S:
S:


21. How many times did Boston Red Stockings lose in 2009 postseason?
P: Count the number of times the team "Boston Red Stockings" lost in 2009 postseason.

SELECT count(*)
FROM postseason as T1 JOIN team as T2 on T1.team_id_loser = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings' and T1.year=2009;

S:
S:
S:


22. What are the name and id of the team with the most victories in 2008 postseason?
P: Find the name and id of the team that won the most times in 2008 postseason.

SELECT T2.name, T1.team_id_winner
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T1.year = 2008
GROUP BY T1.team_id_winner
ORDER BY count(*) desc
LIMIT 1;

S:
S:
S:


23. What is the number of wins the team Boston Red Stockings got in the postseasons each year in history?
P: For each year, return the year and the number of times the team Boston Red Stockings won in the postseasons.

SELECT count(*), T1.year
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
GROUP BY T1.year

S:
S:
S:


24. What is the total number of postseason games that team Boston Red Stockings participated in?
P: How many times in total did the team Boston Red Stockings participate in postseason games?

select count(*)
from (
SELECT *
FROM postseason as T1 JOIN team as T2 on T1.team_id_winner = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
UNION
SELECT *
FROM postseason as T1 JOIN team as T2 on T1.team_id_loser = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings'
);

S:
S:
S:


25. How many games in 1885 postseason resulted in ties (that is, the value of "ties" is '1')?
P: Find the number of tied games (the value of "ties" is '1') in 1885 postseason.

SELECT count(*)
FROM postseason
WHERE year = 1885 and ties = 1;

S:
S:
S:


26. What is the total salary paid by team Boston Red Stockings in 2010?
P: What is the total salary expenses of team Boston Red Stockings in 2010?

SELECT sum(T1.salary)
FROM salary as T1 join team as T2
on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings' and T1.year = 2010

S:
S:
S:


27. How many players were in the team Boston Red Stockings in 2000?
P: How many players did Boston Red Stockings have in 2000?

SELECT count(*)
FROM salary as T1 join team as T2
on T1.team_id = T2.team_id_br
WHERE T2.name ='Boston Red Stockings' and T1.year = 2000

S:
S:
S:


28. List the 3 highest salaries of the players in 2001?
P: How much salary did the top 3 well-paid players get in 2001?

SELECT salary
FROM salary
WHERE year = 2001
ORDER BY salary desc
LIMIT 3;

S:
S:
S:


29. What were all the salary values of players in 2010 and 2001?
P: List all the salary values players received in 2010 and 2001.

SELECT salary
FROM salary
WHERE year = 2010
UNION
SELECT salary
FROM salary
WHERE year = 2001

S:
S:
S:


30. In which year did the least people enter hall of fame?
P: Find the year in which the least people enter hall of fame.

SELECT yearid
FROM hall_of_fame
GROUP BY yearid
ORDER BY count(*) asc
LIMIT 1;

S:
S:
S:


31. How many parks are there in Atlanta city?
P: How many parks does Atlanta city have?

SELECT count(*)
FROM park
WHERE city='Atlanta';

S:
S:
S:


32. How many games were played in park "Columbia Park" in 1907?
P: Count the number of games taken place in park "Columbia Park" in 1907.

SELECT count(*)
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year=1907 and T2.park_name='Columbia Park';

S:
S:
S:


33. How many games were played in city Atlanta in 2000?
P: Find the number of games taken place in city Atlanta in 2000.

SELECT count(*)
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year = 2000 and T2.city = 'Atlanta';

S:
S:
S:


34. What is the total home game attendance of team Boston Red Stockings from 2000 to 2010?
P: How many games in total did team Boston Red Stockings attend from 2000 to 2010?

SELECT sum(T1.attendance)
FROM home_game as T1 JOIN team as T2 on T1.team_id = T2.team_id_br
WHERE T2.name = 'Boston Red Stockings' and T1.year between 2000 and 2010;

S:
S:
S:


35. How much did the the player with first name Len and last name Barker earn between 1985 to 1990 in total?
P: Compute the total salary that the player with first name Len and last name Barker received between 1985 to 1990.

SELECT sum(T1.salary)
FROM salary as T1 JOIN player as T2 on T1.player_id=T2.player_id
WHERE T2.name_first = 'Len' and T2.name_last='Barker' and T1.year between 1985 and 1990;

S:
S:
S:


36. List players' first name and last name who received salary from team Washington Nationals in both 2005 and 2007.
P: What are the first name and last name of the players who were paid salary by team Washington Nationals in both 2005 and 2007?

SELECT T2.name_first, T2.name_last
FROM salary as T1 JOIN player as T2 ON T1.player_id=T2.player_id JOIN
team as T3 on T3.team_id_br=T1.team_id
WHERE T1.year=2005 and T3.name='Washington Nationals'
INTERSECT
SELECT T2.name_first,T2.name_last
FROM salary as T1 JOIN player as T2 ON T1.player_id=T2.player_id JOIN
team as T3 on T3.team_id_br=T1.team_id
WHERE T1.year=2007 and T3.name='Washington Nationals'

S:
S:
S:


37. How many home games did the team Boston Red Stockings play from 1990 to 2000 in total?
P: Count the total number of games the team Boston Red Stockings attended from 1990 to 2000.

SELECT sum(T1.games)
FROM home_game as T1 JOIN team as T2 on T1.team_id=T2.team_id_br
WHERE T2.name='Boston Red Stockings' and T1.year between 1990 and 2000;

S:
S:
S:


38. Which team had the least number of attendances in home games in 1980?
P: Find the team that attended the least number of home games in 1980.

SELECT T2.name
FROM home_game as T1 JOIN team as T2 on T1.team_id=T2.team_id_br
WHERE T1.year=1980
ORDER BY T1.attendance asc
LIMIT 1;

S:
S:
S:


39. List the names of states that have more than 2 parks.
P: Which states have more than 2 parks?

SELECT state
FROM park
GROUP BY state
HAVING count(*) > 2;

S:
S:
S:


40. How many team franchises are active, with active value 'Y'?
P: Find the number of team franchises that are active (have 'Y' as "active" information).

SELECT count(*)
FROM team_franchise
WHERE active='Y';

S:
S:
S:


41. Which cities have 2 to 4 parks?
P: Find all the cities that have 2 to 4 parks.

SELECT city
FROM park
GROUP BY city
HAVING count(*) between 2 and 4;

S:
S:
S:


42. Which park had most attendances in 2008?
P: Which park did the most people attend in 2008?

SELECT T2.park_name
FROM home_game as T1 JOIN park as T2 on T1.park_id = T2.park_id
WHERE T1.year=2008
ORDER BY T1.attendance desc
LIMIT 1;

S:
S:
S:


