1. How many regions do we have?
P: Count the number of regions.

select count(*)
from region

S:
S:
S:

2. Show all region code and region name sorted by the codes.
P: What are the codes and names for all regions, sorted by codes?

select region_code, region_name
from region
order by region_code

S:
S:
S:

3. List all region names in alphabetical order.
P: What are the names of the regions in alphabetical order?

select region_name
from region
order by region_name

S:
S:
S:

4. Show names for all regions except for Denmark.
P: Return the names of all regions other than Denmark.

select region_name
from region
where region_name != 'Denmark'

S:
S:
S:

5. How many storms had death records?
P: Count the number of storms in which at least 1 person died.

select count(*)
from storm
where Number_Deaths > 0

S:
S:
S:

6. List name, dates active, and number of deaths for all storms with at least 1 death.
P: What are the names, dates active, and number of deaths for storms that had 1 or more death?

select name, dates_active, number_deaths
from storm
where number_deaths >= 1

S:
S:
S:

7. Show the average and maximum damage for all storms with max speed higher than 1000.
P: What is the average and maximum damage in millions for storms that had a max speed over 1000?

select avg(damage_millions_USD), max(damage_millions_USD)
from storm
where max_speed > 1000

S:
S:
S:

8. What is the total number of deaths and damage for all storms with a max speed greater than the average?
P: Return the total number of deaths and total damange in millions for storms that had a max speed greater than the average.

select sum(number_deaths), sum(damage_millions_USD)
from storm
where max_speed > (select avg(max_speed) from storm)

S:
S:
S:

9. List name and damage for all storms in a descending order of max speed.
P: What are the names and damage in millions for storms, ordered by their max speeds descending?

select name, damage_millions_USD
from storm
order by max_speed desc

S:
S:
S:

10. How many regions are affected?
P: Count the number of different affected regions.

select count(distinct region_id)
from affected_region

S:
S:
S:

11. Show the name for regions not affected.
P: What are the names of regions that were not affected?

select region_name
from region
where region_id not in (select region_id from affected_region)

S:
S:
S:

12. Show the name for regions and the number of storms for each region.
P: How many storms occured in each region?

select T1.region_name, count(*) 
from region as T1 join affected_region as T2 on T1.region_id=T2.region_id
group by T1.region_id

S:
S:
S:

13. List the name for storms and the number of affected regions for each storm.
P: How many regions were affected by each storm?

select T1.name, count(*)
from storm as T1 join affected_region as T2 on T1.storm_id = T2.storm_id
group by T1.storm_id

S:
S:
S:

14. What is the storm name and max speed which affected the greatest number of regions?
P: Return the name and max speed of the storm that affected the most regions.

select T1.name, T1.max_speed
from storm as T1 join affected_region as T2 on T1.storm_id = T2.storm_id
group by T1.storm_id
order by count(*) desc
limit 1

S:
S:
S:

15. Show the name of storms which don't have affected region in record.
P: What are the names of storms that did not affect any regions?

select name
from storm
where storm_id not in (select storm_id from affected_region)

S:
S:
S:

16. Show storm name with at least two regions and 10 cities affected. 
P: What are the names of storms that both affected two or more regions and affected a total of 10 or more cities?

select T1.name
from storm as T1 join affected_region as T2 on T1.storm_id = T2.storm_id
group by T1.storm_id
having count(*) >= 2
intersect
select T1.name
from storm as T1 join affected_region as T2 on T1.storm_id = T2.storm_id
group by T1.storm_id
having sum(T2.number_city_affected) >= 10

S:
S:
S:

17. Show all storm names except for those with at least two affected regions.
P: What are the names of storms that did not affect two or more regions?

select name
from storm
EXCEPT
select T1.name
from storm as T1 join affected_region as T2 on T1.storm_id = T2.storm_id
group by T1.storm_id
having count(*) >= 2

S:
S:
S:

18. What are the region names affected by the storm with a number of deaths of least 10?
P: Return the names of the regions affected by storms that had a death count of at least 10.

select T2.region_name
from affected_region as T1 join region as T2 on T1.region_id = T2.region_id join storm as T3 on T1.storm_id = T3.storm_id
where T3.number_deaths >= 10

S:
S:
S:

19. Show all storm names affecting region "Denmark".
P: What are the names of the storms that affected Denmark?

select T3.name
from affected_region as T1 join region as T2 on T1.region_id = T2.region_id join storm as T3 on T1.storm_id = T3.storm_id
where T2.region_name = 'Denmark'

S:
S:
S:

20. Show the region name with at least two storms.
P: What are the names of regions with two or more storms?

select T1.region_name
from region as T1 join affected_region as T2 on T1.region_id=T2.region_id
group by T1.region_id
having count(*) >= 2

S:
S:
S:

21. Find the names of the regions which were affected by the storm that killed the greatest number of people.
P: What are the names of regions that were affected by the storm in which the most people died?

select T2.region_name
from affected_region as T1 join region as T2 on T1.region_id = T2.region_id join storm as T3 on T1.storm_id = T3.storm_id
order by T3.Number_Deaths desc
limit 1

S:
S:
S:

22. Find the name of the storm that affected both Afghanistan and Albania regions.
P: What are the names of the storms that affected both the regions of Afghanistan and Albania?

select T3.Name
from affected_region as T1 join region as T2 on T1.region_id = T2.region_id join storm as T3 on T1.storm_id = T3.storm_id
where T2.Region_name = 'Afghanistan'
intersect
select T3.Name
from affected_region as T1 join region as T2 on T1.region_id = T2.region_id join storm as T3 on T1.storm_id = T3.storm_id
where T2.Region_name = 'Albania'

S:
S:
S:
