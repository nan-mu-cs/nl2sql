Total = # 40


1. How many authors do we have?


select count(*)
from Author


How many papers do we have?


select count(*)
from Paper


How many affiliations do we have?


select count(*)
from Affiliation


2. How many papers do we have in NAACL 2000?


select count(*)
from Paper
where venue = "NAACL" and year = 2000


How many papers are published in year 2009 by Columbia University?


select count(distinct Paper.paper_id)
from Paper, Author_list,  Affiliation
where Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Columbia University" and Paper.year = 2009


2. List names and addresses for all affiliations.


select distinct name, address
from Affiliation


List all venues and years for papers ordered by year.


select distinct venue, year
from paper
order by year


3. Find all papers with titles and paper IDs written by Harvard University.


select distinct Paper.title, Paper.paper_id
from Paper, Author_list,  Affiliation
where Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name = "Harvard University"




Find all papers with titles and paper IDs written by Mckeown, Kathleen.


select Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
Author.name like "%Mckeown, Kathleen%"


4. Find all papers with titles and paper IDs collaborated by Stanford University and Columbia University.


select Paper.title, Paper.paper_id
from Paper, Author_list,  Affiliation
where Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Stanford University"
intersect
select Paper.title, Paper.paper_id
from Paper, Author_list,  Affiliation
where Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Columbia University"




Find all papers with titles and paper IDs co-authored by Mckeown, Kathleen and Rambow, Owen.


select Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
Author.name like "%Mckeown, Kathleen%"
intersect
select Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
Author.name like "%Rambow, Owen%"


Find all papers with titles and paper IDs which have Mckeown, Kathleen but not Rambow, Owen in author list.


select Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
Author.name like "%Mckeown, Kathleen%"
except
select Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
Author.name like "%Rambow, Owen%"


Find all papers with titles and paper IDs which have Mckeown, Kathleen or Rambow, Owen in author list.


select distinct Paper.title, Paper.paper_id
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and 
(Author.name like "%Mckeown, Kathleen%" or Author.name like "%Rambow, Owen%")


5. List all authors with descending ordered number of papers.


select Author.name, count(*)
from Author join Author_list on Author.author_id = Author_list.author_id
group by Author.author_id
order by count(*) desc


List all affiliations with ascending ordered number of papers.


select Affiliation.name, count(*)
from Affiliation join Author_list on Affiliation.affiliation_id = Author_list.affiliation_id
group by Affiliation.affiliation_id
order by count(*) desc


6. List all authors who have more than 50 papers.


select Author.name
from Author join Author_list on Author.author_id = Author_list.author_id
group by Author.author_id
having count(*) > 50


List all authors who have only 1 paper.


select Author.name
from Author join Author_list on Author.author_id = Author_list.author_id
group by Author.author_id
having count(*) = 1


List all affiliations who have greater than or equal to 100 papers.


with Distinct_Paper(paper_id, affiliation_id) as
         (select distinct paper_id, affiliation_id
          from Author_list)
select Affiliation.name
from Affiliation join Distinct_Paper on Affiliation.affiliation_id = Distinct_Paper.affiliation_id
group by Affiliation.affiliation_id
having count(*) >= 100


7. What is the venue and year with the most number of publications?


select venue, year
from paper
group by venue, year
order by count(*) desc
limit 1


What is the venue with the least number of publications


select venue
from paper
group by venue
order by count(*) asc
limit 1


8. How many papers cite paper A00-1002?


select count(*)
from Citation
where cited_paper_id = "A00-1002"


How many reference papers does paper D12-1027 have?


select count(*)
from Citation
where paper_id = "D12-1027"


9. What is the id and the number of citations of the most cited paper?


select paper_id, count(*)
from Citation
group by cited_paper_id
order by count(*) desc
limit 1


Give the title of the paper which cites most number of papers?


select title
from Citation join Paper on Paper.paper_id = Citation.paper_id
group by Citation.paper_id
order by count(*) desc
limit 1


List top 10 most cited papers and their numbers of citations.


select paper_id, count(*)
from Citation
group by cited_paper_id
order by count(*) desc
limit 10




10. How many citations does Mckeown, Kathleen have?


select count(*)
from Citation, Author_list, Author
where Citation.cited_paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and Author.name like "%Mckeown, Kathleen%"


How many papers does Mckeown, Kathleen cite?


select count(*)
from Citation, Author_list, Author
where Citation.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and Author.name like "%Mckeown, Kathleen%"


11. Who has most citations among all authors?


select Author.name, count(*)
from Citation, Author_list, Author
where Citation.cited_paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id
group by Author_list.author_id
order by count(*) desc
limit 1


Who have more citations than "Mckeown, Kathleen"?


with author_citation (author_name, citation_number) as 
(select Author.name, count(*)
from Citation, Author_list, Author
where Citation.cited_paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id
group by Author_list.author_id
order by count(*) desc)
select author_name
from author_citation
where citation_number > (select citation_number from author_citation where author_name like "%Mckeown, Kathleen%")


12. What are venues and years where Mckeown, Kathleen has papers?


select distinct Paper.venue, Paper.year
from Paper, Author_list, Author
where Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id and Author.name like "%Mckeown, Kathleen%"


What are venues and years where Columbia University has papers?


select distinct Paper.venue, Paper.year
from Paper, Author_list, Affiliation
where Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Columbia University"


13. Which author has most papers in year 2009?


select Author.name
from Paper, Author_list, Author
where Paper.year = 2009 and Paper.paper_id = Author_list.paper_id and Author_list.author_id = Author.author_id
group by Author_list.author_id
order by count(*) desc
limit 1


What are top 3 affiliations that have most papers in year 2009?


select Affiliation.name
from Paper, Author_list, Affiliation
where Paper.year = 2009 and Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id
group by Author_list.affiliation_id
order by count(*) desc
limit 3


14. How many papers does Columbia University have in or before 2009?


select count(distinct paper.paper_id)
from Paper, Author_list, Affiliation
where Paper.year <= 2009 and Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Columbia University"


How many papers does Stanford University have between 2000 and 2009?


select count(distinct paper.paper_id)
from Paper, Author_list, Affiliation
where Paper.year >= 2000 and Paper.year <= 2009 and Paper.paper_id = Author_list.paper_id and Author_list.affiliation_id = Affiliation.affiliation_id and Affiliation.name like "Stanford University"


15. What is the title of the paper that has most number of authors?


select Paper.title
from Author_list join Paper on Author_list.paper_id = Paper.paper_id
group by Paper.paper_id
order by count(*) desc
limit 1


What is the average number of authors in each paper?


with paper_author_number (paper_id, author_number) as 
(select paper_id, count(*)
from Author_list
group by paper_id)
select avg(author_number)
from paper_author_number




What is the average number of papers for an author?


with author_paper_number (author_id, paper_number) as 
(select author_id, count(*)
from Author_list
group by author_id)
select avg(paper_number)
from author_paper_number




16. How many collaborators does Mckeown, Kathleen have?


select count (distinct T2.author_id)
from Author_list T1, Author_list T2, Author
where T1.paper_id = T2.paper_id and T1.author_id != T2.author_id and T1.author_id = Author.author_id and Author.name like "%Mckeown, Kathleen%"


Who have most papers co-authored with Mckeown, Kathleen?


select T4.name
from Author_list T1, Author_list T2, Author T3, Author T4
where T1.paper_id = T2.paper_id and T1.author_id != T2.author_id and T1.author_id = T3.author_id and T3.name like "%Mckeown, Kathleen%" and T2.author_id = T4.author_id
group by T2.author_id
order by count(*) desc
limit 1