1. What is the model of the vehicle with maximum speed whose power is higher than 6000 ?

select model 
from vehicle
where power > 6000
order by top_speed desc limit 1;


2. What are the names of the drivers who are citizens of the 'United States'?

select name
from driver
where citizenship = 'United States'


3. How many vehicles have a driver driven at most? And what is the driver id?

select count(*), driver_id
from vehicle_driver
group by driver_id
order by count(*) desc limit 1

4. What is the maximum and average power for the vehicles manufactured by 'Zhuzhou'?

select max(power), avg(power)
from vehicle
where builder = 'Zhuzhou'

5. What is the id of the vehicle driven for the least times for the vehicles ever used?

select vehicle_id
from vehicle_driver
group by vehicle_id
order by count(*) asc limit 1

6. What is the top speed and power of the vehicle manufactured in the year of 1996?

select top_speed, power
from vehicle
where build_year = 1996

7. What are the build year, model name and builder of the vehicles?

select build_year, model, builder
from vehicle


8. How many drivers have driven vehicles built in 2012?

select count(distinct T1.driver_id)
from vehicle_driver as T1 join vehicle as T2
on T1.vehicle_id = T2.vehicle_id
where T2.build_year = 2012


9. How many drivers have raced in 'NASCAR'?

select count(*)
from driver
where Racing_Series = 'NASCAR'

10. What is the average top speed of vehicles?

select avg(top_speed)
from vehicle


11. What are the distinct names who have driven vehicles with power more than 5000?

select distinct T1.Name
from driver as T1 join vehicle_driver as T2
on T1.driver_id = T2.driver_id
join vehicle as T3
on T2.vehicle_id = T3.vehicle_id
where T3.power > 5000

12. Which car models has total production larger than 100 or top speed higher than 150?

select model
from vehicle
where total_production > 100 or top_speed > 150

13. What are the model names and built year of the cars with 'DJ' in its name?

select model, build_year
from vehicle
where model like '%DJ%'


14. What are the models which have not been driven by any drivers?

select model
from vehicle
except
select T1.model
from vehicle as T1 join vehicle_driver as T2
on T1.vehicle_id = T2.vehicle_id


15. What are the vehicle id and models of the vehicle which have been driven by two drivers or been manufactured by 'Ziyang'.

 
select T1.vehicle_id, T1.model
from vehicle as T1 join vehicle_driver as T2
on T1.vehicle_id = T2.vehicle_id
group by T2.vehicle_id
having count(*) = 2 or T1.builder = 'Ziyang'

16. What are the vehicle models which have been driven by at least 2 drivers or been driven by driver named 'Jeff Gordon'?

select T1.vehicle_id, T1.model
from vehicle as T1 join vehicle_driver as T2
on T1.vehicle_id = T2.vehicle_id
join driver as T3
on T2.driver_id = T3.driver_id
where T3.name = 'Jeff Gordon'
union
select T1.vehicle_id, T1.model
from vehicle as T1 join vehicle_driver as T2
on T1.vehicle_id = T2.vehicle_id
group by T2.vehicle_id
having count(*) > 2




17. select count(*)
from vehicle
where top_speed = (select max(top_speed) from vehicle)


select name
from driver
order by name


18. How many drivers have been racing in each racing series?

select count(*), racing_series
from driver
group by racing_series


19. What are the name and citizenship of the drivers who have driven the vehicle model 'DJ1'?

select T1.name, T1.citizenship
from driver as T1 join vehicle_driver as T2
on T1.driver_id = T2.driver_id
join vehicle as T3
on T2.vehicle_id = T3.vehicle_id
where T3.model = 'DJ1'


20. How many drivers have not driven any cars?

select count(*)
from driver
where driver_id not in (
select driver_id from vehicle_driver
)




