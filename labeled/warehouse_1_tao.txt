
Total # = 40

Select all details of all warehouses.

select *
from warehouses

Find all different contents stored in New York.

select distinct T1.contents
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where location = 'New York'

Select contents of all boxes with a value larger than $150.

select contents
from boxes
where Value > 150

Select the warehouse code and the average value of the boxes in each warehouse.

select warehouse, avg(value)
from boxes
group by warehouse

Find the average and total values of all boxes.

select avg(value), sum(value)
from boxes

Find the average and total capacity of all warehouses.

select avg(capacity), sum(capacity)
from warehouses

Find the average and maximum value for each different content.

select avg(value), max(value), contents
from boxes
group by contents

Find the content that has the highest total values in all boxes.

select contents
from boxes
order by value desc
limit 1

Select the average value of all the boxes.

select avg(value)
from boxes


Select all distinct contents in all the boxes.

select distinct contents
from boxes

Find the number of all distinct contents in all the boxes.

select count(distinct contents)
from boxes

Find all distinct locations of warehouses.

select count(distinct location)
from warehouses


Find the code of boxes that are stored at the warehouses located at Chicago or New York.

select T1.code 
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'Chicago' or T2.location = 'New York'

Find the total value of boxes in the warehouses located at Chicago and New York.

select sum(T1.value)
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'Chicago' or T2.location = 'New York'

Find all contents which warehouses located at both Chicago and New York have.
Find the contents that are saved in both Chicago and New York.

select T1.contents
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'Chicago'
INTERSECT
select T1.contents
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'New York'

Find the type of contents that are not in the warehouses located at New York.

select contents
from boxes
except
select T1.contents
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'New York'

Find the location of the warehouses where have contents Rocks but not Scissors.

select T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T1.contents = 'Rocks'
except
select T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T1.contents = 'Scissors'

Find the warehouses where store contents Rocks or Scissors.

select distinct warehouse
from boxes
where contents = 'Rocks' or contents = 'Scissors'

Find the location of the warehouses where store contents Rocks and Scissors.

select T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T1.contents = 'Rocks'
intersect
select T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T1.contents = 'Scissors'


List the code and contents of all boxes sorted by their values.

select code, contents
from boxes
order by value

Find the code and contents of the box with the lowest value.

select code, contents
from boxes
order by value
limit 1

Find the unique contents of all boxes whose value is higher than the average value of all boxes.

select distinct contents
from boxes
where value > (select avg(value) from boxes)

List all different types of contents ordered by contents.

select distinct contents
from boxes
order by contents

Find the code of all boxes whose value is higher than the value of any boxes with Rocks content.

select code
from boxes
where value > (select min(value) from boxes where contents = 'Rocks')

Find the code and content of all boxes whose value is higher than the value of all boxes with Scissors content.

select code, contents
from boxes
where value > (select max(value) from boxes where contents = 'Scissors')

Find the total values of boxes stored in the warehouse with the largest capacity.

select sum(T1.value)
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
order by T2.capacity desc
limit 1

Select the warehouse code and the average value of the boxes only for those warehouses where the average value of the boxes is greater than 150.

select warehouse, avg(value)
from boxes
group by warehouse
having avg(value)> 150

Find the total value and number of each content in all boxes.

select sum(value), count(*), contents
from boxes
group by contents

Find the total, average, and maximum capacity for different location.

select sum(capacity), avg(capacity), max(capacity), location
from warehouses
group by location

Find the total capacity of all warehouse locations.

select sum(capacity)
from warehouses

Find the value of the most expensive boxes saved in each warehouse location.

select max(T1.value), T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
group by T2.location

Find the value and contents of the most expensive boxes saved in each warehouse.

select T1.value, T1.contents, T2.location
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
group by T2.location
having  T1.value = max(T1.value)

Select the warehouse codes, along with the number of boxes in each warehouse.

select Warehouse, count(*)
from boxes
group by warehouse

Find the number of different locations which content Rocks is stored.

select count(distinct location)
from boxes as T1 join warehouses as T2 on T1.warehouse = T2.code
where T1.contents = 'Rocks'

Select the code of each box, along with the name of the city the box is located in.

select T1.code, T2.location
from boxes as T1 join warehouses as T2 on T1.Warehouse = T2.Code

Select the codes of all the boxes located in Chicago.

select T1.code
from boxes as T1 join Warehouses as T2 on T1.warehouse = T2.code
where T2.location = 'Chicago'

Find the number of boxes saved in each warehouse.

select count(*), warehouse
from boxes
group by warehouse

Find the number of distinct type of contents in each warehouse.

select count(distinct contents), warehouse
from boxes
group by warehouse

Select the codes of all warehouses that are saturated (a warehouse is saturated if the number of boxes in it is larger than the warehouse's capacity).

select T2.code
from boxes as T1 join Warehouses as T2 on T1.warehouse = T2.code
group by T2.code
having T2.capacity < count(*)

——or ———
SELECT Code
FROM Warehouses
WHERE Capacity <
(SELECT COUNT(*)
FROM Boxes
WHERE Warehouse = Warehouses.Code)

Find the total values of boxes that are not in the warehouses located at Chicago.

select sum(T1.value)
from boxes as T1 join Warehouses as T2 on T1.warehouse = T2.code
where T2.location != 'Chicago'
