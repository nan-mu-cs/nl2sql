1. How many buildings are there?

select count(*)
from building

2. Show the name, street address, and number of floors for all buildings ordered by the number of floors.

select name, street_address, floors
from building
order by floors

3. What is the name for the tallest building?

select name
from building
order by height_feet desc
limit 1

4. What is the average, maximum, and minimum number of floors for all buildings?

select avg(floors), max(floors), min(floors)
from building

5. Show the number of buildings with a height above the average or a number of floors above the average.

select count(*)
from building
where height_feet > (select avg(height_feet) from building) OR floors > (select avg(floors) from building)

6. List the name of buildings with a at least 200 feet height and at least 20 floors.

select name
from building
where height_feet >= 200 and floors >= 20

7. Show the name and location of institutions funded after 1990 and with a type private.

select institution, location
from institution
where founded > 1990 and type = 'Private'

8. Show institution types with the number of institutions and total enrollment for each type.

select type, count(*), sum(enrollment)
from institution
group by type

9. Show the institution type with most number of institutions.

select type
from institution
group by type
order by count(*) desc
limit 1

10. Show the institution type with a institution founded after 1990 and a institution with at least 1000 enrollment.

select type
from institution
where founded > 1990
intersect
select type
from institution
where enrollment >= 1000

11. Show the name of buildings which do not have any institution.

select name
from building
where building_id NOT IN (select building_id from institution)

12. Show the name of buildings except for those having an institution funded in 2003.

select name
from building
except 
select T1.name
from building as T1 join institution as T2 on T1.building_id = T2.building_id
where T2.founded = 2003

13. Show the name of buildings and the number of institution in each building.

select T1.name, count(*)
from building as T1 join institution as T2 on T1.building_id = T2.building_id
group by T1.building_id

14. Show the name and height of buildings with at least two institutions founded after 1880.

select T1.name, T1.height_feet
from building as T1 join institution as T2 on T1.building_id = T2.building_id
where T2.founded > 1880
group by T1.building_id
having count(*) >= 2

15. show all distinct institution types.

select distinct type
from institution

16. Show institution names and the number of proteins for each institution.

select T1.institution, count(*)
from institution as T1 join protein as T2 on T1.institution_id = T2.institution_id
group by T1.institution_id

17. How many proteins are associated with an institution founded after 1880 or with a type Private?

select count(*)
from institution as T1 join protein as T2 on T1.institution_id = T2.institution_id
where T1.founded > 1880 or T1.type = 'Private'

18. Show the protein name and the institution name.

select T2.protein_name, T1.institution
from institution as T1 join protein as T2 on T1.institution_id = T2.institution_id

19. How many proteins are associated with an institution in a building with at least 20 floors?

select count(*)
from institution as T1 join protein as T2 on T1.institution_id = T2.institution_id join building as T3 on T3.building_id = T1.building_id
where T3.floors >= 20

20. How many institutions do not have an associated protein in our record?

select count(*)
from institution
where institution_id not in (select institution_id from protein)
