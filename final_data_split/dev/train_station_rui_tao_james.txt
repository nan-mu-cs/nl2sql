1. How many train stations are there?

select count(*)
from station

S:
S:
S:

2. Show the name, location, and number of platforms for all stations.

select name, location, number_of_platforms
from station

S:
S:
S:

3. What are all locations of train stations?

select distinct location
from station

S:
S:
S:

4. Show the names and total passengers for all train stations not in London.

select name, total_passengers
from station
where location != 'London'

S:
S:
S:

5. Show the names and main services for train stations that have the top three total number of passengers.

select name, main_services
from station
order by total_passengers desc
limit 3

S:
S:
S:

6. What is the average and maximum number of total passengers for train stations in London or Glasgow?

select avg(total_passengers), max(total_passengers)
from station
where location = 'London' or location = 'Glasgow'

S:
S:
S:

7. Show all locations and the total number of platforms and passengers for all train stations in each location.

select location, sum(number_of_platforms), sum(total_passengers)
from station
group by location

S:
S:
S:

8. Show all locations that have train stations with at least 15 platforms and train stations with more than 25 total passengers.

select distinct location
from station
where number_of_platforms >= 15 and total_passengers > 25

S:
S:
S:

9. Show all locations which don't have a train station with at least 15 platforms.

select location
from station
EXCEPT
select location
from station
where number_of_platforms >= 15

S:
S:
S:

10. Show the location with most number of train stations.

select location
from station
group by location
order by count(*) desc
limit 1

S:
S:
S:

11. Show the name, time, and service for all trains.

select name, time, service
from train

S:
S:
S:

12. Show the number of trains

select count(*)
from train

S:
S:
S:

13. Show the name and service for all trains in order by time.

select name, service
from train
order by time

S:
S:
S:

14. Show the station name and number of trains in each station.

select T2.name, count(*)
from train_station as T1 join station as T2 on T1.station_id = T2.station_id
group by T1.station_id

S:
S:
S:

15. show the train name and station name for each train.

select T2.name, T3.name
from train_station as T1 join station as T2 on T1.station_id = T2.station_id join train as T3 on T3.train_id = T1.train_id

S:
S:
S:

16. Show all train names and times in stations in London in descending order by train time.

select T3.name, T3.time
from train_station as T1 join station as T2 on T1.station_id = T2.station_id join train as T3 on T3.train_id = T1.train_id
where T2.location = 'London'
order by T3.time desc

S:
S:
S:

17. Show the station name with greatest number of trains.

select T2.name
from train_station as T1 join station as T2 on T1.station_id = T2.station_id
group by T1.station_id
order by count(*) desc
limit 1

S:
S:
S:

18. Show the station name with at least two trains.

select T2.name
from train_station as T1 join station as T2 on T1.station_id = T2.station_id
group by T1.station_id
having count(*) >= 2

S:
S:
S:

19. Show all locations with only 1 station.

select location
from station
group by location
having count(*) = 1

S:
S:
S:

20. Show station names without any trains.

select name
from station
where station_id not in (select station_id from train_station)

S:
S:
S:

21. What are the names of the stations which serve both "Ananthapuri Express" and "Guruvayur Express" trains?

select T2.name
from train_station as T1 join station as T2 on T1.station_id = T2.station_id join train as T3 on T3.train_id = T1.train_id
where T3.Name = "Ananthapuri Express"
intersect
select T2.name
from train_station as T1 join station as T2 on T1.station_id = T2.station_id join train as T3 on T3.train_id = T1.train_id
where T3.Name = "Guruvayur Express"

S:
S:
S:

22. Find the names of the trains that do not pass any station located in London.

select T2.name
from train_station as T1 join train as T2 on T1.train_id = T2.train_id
where T1.station_id not in (select T4.station_id
from train_station as T3 join station as T4 on T3.station_id = T4.station_id
where t4.location = "London")

S:
S:
S:

23. List the names and locations of all stations ordered by their yearly entry exit and interchange amounts.

select name, location
from station
order by Annual_entry_exit, Annual_interchanges

S:
S:
S:
