1. How many churches opened before 1850 are there?

select count(*)
from Church
where Open_Date < 1850

2. Show the name, open date, and organizer for all churches.

select name, open_date, organized_by
from Church

3. List all church names in descending order of opening date.

select name
from church
order by open_date desc

4. Show the opening year in whcih at least two churches opened.

select open_date
from church
group by open_date
having count(*) >= 2

5. Show the organizer and name for churches that opened between 1830 and 1840.

select organized_by, name
from church
where open_date beween 1830 and 1840

6. Show all opening years and the number of churches that opened in that year.

select open_date, count(*)
from church
group by open_date

7. Show the name and opening year for three churches that opened most recently.

select name, open_date
from church
order by open_date desc
limit 3

8. How many female people are older than 30 in our record?

select count(*)
from people
where is_male = 'F' and age > 30

9. Show the country where people older than 30 and younger than 25 are from. 

select country
from people
where age < 25
INTERSECT
select country
from people
where age > 30

10. Show the minimum, maximum, and average age for all people.

select min(age), max(age), avg(age)
from people

11. Show the name and country for all people whose age is smaller than the average.

select name, country
from people
where age < (select avg(age) from people)

12. Show the pair of male and female names in all weddings after year 2014

select T2.name, T3.name 
from wedding as T1 join people as T2 on T1.male_id = T2.people_id join people as T3 on T1.female_id = T3.people_id
where T1.year > 2014

13. Show the name and age for all male people who don't have a wedding.

select name, age
from people
where is_male = 'T' and people_id not in (select male_id from wedding)

14. Show all church names except for those that had a wedding in year 2015.

select name
from church
EXCEPT
select T1.name
from church as T1 join wedding as T2 on T1.church_id = T2.church_id
where T2.year = 2015

15. Show all church names that have hosted least two weddings.

select T1.name
from church as T1 join wedding as T2 on T1.church_id = T2.church_id
group by T1.church_id 
having count(*) >= 2

16. Show the names for all females from Canada having a wedding in year 2016.

select T2.name
from wedding as T1 join people as T2 on T1.female_id = T2.people_id
where T1.year = 2016 and T2.is_male = 'F' and T2.country = 'Canada'

17. How many weddings are there in year 2016?

select count(*)
from wedding
where year = 2016

18. Show the church names for the weddings of all people older than 30.

select T4.name
from wedding as T1 join people as T2 on T1.male_id = T2.people_id join people as T3 on T1.female_id = T3.people_id join church as T4 on T4.church_id = T1.church_id
where T2.age > 30 OR T3.age > 30

19. Show all countries and the number of people from each country.

select country, count(*)
from people
group by country

20. How many churches have a wedding in year 2016?

select count (distinct church_id)
from wedding
where year = 2016
