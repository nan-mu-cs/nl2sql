
1. what are the details of the cmi masters that have the cross reference code 'Tax'?

select T1.cmi_details
from Customer_Master_Index as T1 join CMI_Cross_References as T2
on T1.master_customer_id = T2.master_customer_id
where T2.source_system_code = 'Tax'

2. What is the cmi cross reference id that is related to at least one council tax entry? List the cross reference id and source system code.

select T1.cmi_cross_ref_id, T1.source_system_code
from CMI_Cross_References as T1 join Council_Tax as T2
on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id
group by T1.cmi_cross_ref_id
having count(*) >= 1

3. How many business rates are related to each cmi cross reference? List cross reference id, master customer id and the n
umber.

select T2.cmi_cross_ref_id, T2.master_customer_id, count(*)
from Business_Rates as T1 join CMI_Cross_References as T2
on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id
group by T2.cmi_cross_ref_id


4. What is the tax source system code related to the benefits and overpayments? List the code and the benifit id, order by benifit id.

select T1.source_system_code, T2.council_tax_id
from CMI_Cross_References as T1 join Benefits_Overpayments as T2
on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id
order by T2.council_tax_id

6. Wat is the tax source system code and master customer id of the taxes related to each parking fine id?

select T1.source_system_code, T1.master_customer_id, T2.council_tax_id
from CMI_Cross_References as T1 join Parking_Fines as T2
on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id


7. What are the renting arrears tax ids related to the customer master index whose detail is not 'Schmidt, Kertzmann and Lubowitz'?

select T1.council_tax_id 
from Rent_Arrears as T1 join CMI_Cross_References as T2 on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id
join Customer_Master_Index as T3 on T3.master_customer_id = T2.master_customer_id
where T3.cmi_details != 'Schmidt, Kertzmann and Lubowitz'


8. What are the register ids of electoral registries that have the cross reference source system code 'Electoral' or 'Tax'?

select T1.electoral_register_id 
from Electoral_Register as T1 join CMI_Cross_References
as T2
on T1.cmi_cross_ref_id = T2.cmi_cross_ref_id
where T2.source_system_code = 'Electoral' or T2.source_system_code = 'Tax'

9. How many different source system code for the cmi cross references are there?

SELECT count(distinct source_system_code)
FROM CMI_cross_references

10. List all information about customer master index, and sort them by details in descending order.

SELECT *
FROM customer_master_index
order by cmi_details desc

11. List the council tax ids and their related cmi cross references of all the parking fines.

SELECT council_tax_id, cmi_cross_ref_id
from parking_fines

12. How many council taxes are collected for renting arrears ?

select count(*)
from rent_arrears

13. What are the distinct cross reference source system codes which are related to the master customer details 'Gottlieb, Becker and Wyman'?

select distinct T2.source_system_code
from customer_master_index as T1 join cmi_cross_references as T2
on T1.master_customer_id = T2.master_customer_id
where T1.cmi_details = 'Gottlieb, Becker and Wyman'


14. Which cmi cross reference id is not related to any parking taxes?

select cmi_cross_ref_id
from cmi_cross_references
except 
select cmi_cross_ref_id
from parking_fines

15. Which distinct source system code includes the substring 'en'?

select distinct source_system_code
from cmi_cross_references
where source_system_code like '%en%'
