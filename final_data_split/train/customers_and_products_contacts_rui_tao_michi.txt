1. How many addresses are there in country USA?
P: 

select count(*)
from addresses
where country = 'USA'

S:
S:
S:


2. Show all distinct cities in the address record.
P: 

select distinct city
from addresses

S:
S:
S:


3. Show each state and the number of addresses in each state.
P: 

select state_province_county, count(*)
from addresses
group by state_province_county

S:
S:
S:


4. Show names and phones of customers who do not have address information.
P: 

select customer_name, customer_phone
from customers
where customer_id not in (select customer_id from customer_address_history)

S:
S:
S:


5. Show the name of the customer who has the most orders.
P: 

select T1.customer_name
from customers as T1 join customer_orders as T2 on T1.customer_id = T2.customer_id
group by T1.customer_id
order by count(*) desc limit 1

S:
S:
S:


6. Show the product type codes which have at least two products.
P: 

select product_type_code
from products
group by product_type_code
having count(*) >= 2

S:
S:
S:


7. Show the names of customers who have both an order in completed status and an order in part status.
P: 

select T1.customer_name
from customers as T1 join customer_orders as T2 on T1.customer_id = T2.customer_id
where T2.order_status_code = 'Completed'
intersect
select T1.customer_name
from customers as T1 join customer_orders as T2 on T1.customer_id = T2.customer_id
where T2.order_status_code = 'Part'

S:
S:
S:


8. Show the name, phone, and payment method code for all customers in descending order of customer number.
P: 

select customer_name, customer_phone, payment_method_code
from customers
order by customer_number desc

S:
S:
S:


9. Show the product name and total order quantity for each product.
P: 

select T1.product_name, sum(T2.order_quantity)
from products as T1 join order_items as T2 on T1.product_id = T2.product_id
group by T1.product_id

S:
S:
S:


10. Show the minimum, maximum, average price for all products.
P: 

select min(product_price), max(product_price), avg(product_price)
from products

S:
S:
S:


11. How many products have a price higher than the average?
P: 

select count(*)
from products
where product_price > (select avg(product_price) from products)

S:
S:
S:


12. Show the customer name, customer address city, date from, and date to for each customer address history.
P: 

select T2.customer_name, T3.city, T1.date_from, T1.date_to
from customer_address_history as T1 join customers as T2 on T1.customer_id = T2.customer_id join addresses as T3 on T1.address_id = T3.address_id

S:
S:
S:


13. Show the names of customers who use Credit Card payment method and have more than 2 orders.
P: 

select T1.customer_name
from customers as T1 join customer_orders as T2 on T1.customer_id = T2.customer_id
where T1.payment_method_code = 'Credit Card'
group by T1.customer_id
having count(*) > 2

S:
S:
S:


14. What are the name and phone of the customer with the most ordered product quantity?
P: 

select  T1.customer_name, T1.customer_phone
from customers as T1 join customer_orders as T2 on T1.customer_id = T2.customer_id join order_items as T3 on T3.order_id = T2.order_id
group by T1.customer_id
order by sum(T3.order_quantity) desc limit 1

S:
S:
S:


15. Show the product type and name for the products with price higher than 1000 or lower than 500.
P: 

select product_type_code, product_name
from products
where product_price > 1000 OR product_price < 500

S:
S:
S:


