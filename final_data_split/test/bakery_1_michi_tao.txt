Total # = 51

1. What is the most expensive cake and its flavor?
P: Give the id and flavor of the most expensive cake.

select id, flavor
from goods
where food = "Cake"
order by price desc
limit 1

S: What are the ids and flavors of all the cakes?
S: Order them by price descending.
S: Which is the most expensive?

select id, flavor
from goods
where food = "Cake"

select id, flavor
from goods
where food = "Cake"
order by price desc

select id, flavor
from goods
where food = "Cake"
order by price desc
limit 1

2. What is the cheapest cookie and its flavor?
P: What is the id and flavor of the cheapest cookie?

select id, flavor
from goods
where food = "Cookie"
order by price
limit 1

S: What are the ids and flavors of all the cookies?
S: Order them by price.
S: Which is the least expensive?

select id, flavor
from goods
where food = "Cookie"

select id, flavor
from goods
where food = "Cookie"
order by price

select id, flavor
from goods
where food = "Cookie"
order by price
limit 1

3. Find the ids of goods that have apple flavor.
P: What are the ids with apple flavor?

Select id
From goods
Where flavor = "Apple"

S: What are the ids of all the goods?
S: Of these, which have apple flavor?

Select id
From goods

Select id
From goods
Where flavor = "Apple"

4. What are the ids of goods that cost less than 3 dollars?
P: Give the ids of goods that cost less than 3 dollars.

Select id
From goods
Where price < 3

S: What are the ids of all goods?
S: Of those, which have a price less than 3 dollars?

Select id
From goods

Select id
From goods
Where price < 3

5. List the distinct ids of all customers who bought a cake with lemon flavor?
P: What are the distinct ids of customers who bought lemon flavored cake?

Select DISTINCT T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.Id = T2.Item
     JOIN receipts as T3 ON T2.Receipt = T3.ReceiptNumber
Where T1.Flavor = "Lemon" and T1.Food = "Cake"

S: What are the ids of lemon flavor cakes?
S: What are the distinct customer ids of customers who bought these?

Select id
From goods
Where Flavor = "Lemon" and Food = "Cake"

Select DISTINCT T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.Id = T2.Item
     JOIN receipts as T3 ON T2.Receipt = T3.ReceiptNumber
Where T1.Flavor = "Lemon" and T1.Food = "Cake"

6. For each type of food, tell me how many customers have ever bought it.
P: How many customers have bought each food?

Select T1.food, count(distinct T3.CustomerId)
From goods as T1 JOIN items as T2 ON T1.Id = T2.Item
     JOIN receipts as T3 ON T2.Receipt = T3.ReceiptNumber
Group by T1.food

S: What are the different foods?
S: How many customers have bought each of them?

Select food
From goods
Group by food

Select T1.food, count(distinct T3.CustomerId)
From goods as T1 JOIN items as T2 ON T1.Id = T2.Item
     JOIN receipts as T3 ON T2.Receipt = T3.ReceiptNumber
Group by T1.food

7. Find the id of customers who shopped at the bakery at least 15 times.
P: What are the customer ids of customers who have at least 15 receipts?

Select CustomerId
From receipts
Group by CustomerId
having count(*) >= 15

S: What are the different customer ids for those who have had receipts?
S: Of those, which have a count of at least 15?

Select CustomerId
From receipts
Group by CustomerId

Select CustomerId
From receipts
Group by CustomerId
having count(*) >= 15

8. What is the last name of the customers who shopped at the bakery more than 10 times?
P: Give the last names of customers who have been to the bakery more than 10 times?

Select T2.LastName
From receipts as T1 JOIN customers as T2 ON T1.CustomerId = T2.id
Group by T2.id
having count(*) > 10

S: What are the customer ids of customers who have shopped at the bakery more than 10 times?
S: What are their last names?

Select CustomerId
From receipts
Group by CustomerId
having count(*) > 10

Select T2.LastName
From receipts as T1 JOIN customers as T2 ON T1.CustomerId = T2.id
Group by T2.id
having count(*) > 10

9. How many types of Cake does this bakery sell?
P: Count the number of types of cake this bakery sells.

Select count(*)
From goods
where food = "Cake"

S: How many goods does this bakery sell?
S: Of those, how many are cakes?

Select count(*)
From goods

Select count(*)
From goods
where food = "Cake"

10. List all the flavors of Croissant available in this bakery.
P: What are all the flavors of croissant?

Select flavor
From goods
where food = "Croissant"

S: What is all the information about croissants?
S: What are their flavors?

Select *
From goods
where food = "Croissant"

Select flavor
From goods
where food = "Croissant"

11. Give me a list of all the distinct items bought by the customer number 15.
P: What are all the distinct items bought by customer 15?

Select distinct T1.item
from items as T1 JOIN receipts as T2 ON T1.receipt = T2.ReceiptNumber
Where T2.CustomerId = 15

S: What are the distinct items bought by any customer?
S: Of those, which were bought by customer number 15?

Select distinct T1.item
from items as T1 JOIN receipts as T2 ON T1.receipt = T2.ReceiptNumber

Select distinct T1.item
from items as T1 JOIN receipts as T2 ON T1.receipt = T2.ReceiptNumber
Where T2.CustomerId = 15

12. For each type of food, what are the average, maximum and minimum price?
P: What are the average, minimum and maximum prices for each food?

Select food, avg(price), max(price), min(price)
from goods
Group by food

S: What are the maximum and minimum prices of each food?
S: Also, what is the average price for each food?

Select food, max(price), min(price)
from goods
Group by food

Select food, avg(price), max(price), min(price)
from goods
Group by food

13. Find the receipt numbers where both Cake and Cookie were bought.
P: What are the receipt numbers for instances where both cakes and cookies were purchased?

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.food = "Cake"
INTERSECT
Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.food = "Cookie"

S: What are the receipts where cakes were bought?
S: Of those, which also had cookies purchased?

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.food = "Cake"

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.food = "Cake"
INTERSECT
Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.food = "Cookie"

14. Find all the receipt numbers in which customer with last name LOGAN purchased Croissant.
P: What are the receipt numbers for a customer with the last name Logan who purchased a croissant?

Select T1.ReceiptNumber
From receipts as T1
     Join items as T2 on T1.ReceiptNumber = T2.receipt
     Join goods as T3 on T2.item = T3.id
     Join customers as T4 on T4.Id = T1.CustomerId
Where T3.food = "Croissant" and T4.LastName = 'LOGAN'

S: What are the receipt numbers for purchases with a croissant?
S: Of those, which were for customers with the last name Logan?

Select T1.ReceiptNumber
From receipts as T1
     Join items as T2 on T1.ReceiptNumber = T2.receipt
     Join goods as T3 on T2.item = T3.id
Where T3.food = "Croissant"

Select T1.ReceiptNumber
From receipts as T1
     Join items as T2 on T1.ReceiptNumber = T2.receipt
     Join goods as T3 on T2.item = T3.id
     Join customers as T4 on T4.Id = T1.CustomerId
Where T3.food = "Croissant" and T4.LastName = 'LOGAN'

15. What is the receipt number and date of the receipt in which the most expensive item was bought?
P: What is the receipt number and date corresponding to the receipt for which the most expensive item was purchased?

Select T1.ReceiptNumber, T1.Date
From receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Order by T3.price Desc
LIMIT 1

S: What are all the receipt numbers and dates?
S: Order these by the prices of the items on them.
S: Of these, which was the one for the most expensive item?

Select ReceiptNumber, Date
From receipts

Select T1.ReceiptNumber, T1.Date
From receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Order by T3.price Desc

Select T1.ReceiptNumber, T1.Date
From receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Order by T3.price Desc
LIMIT 1

16. What is the item that was bought the least number of times?
P: Which item was bought the fewest times?

Select item
From items
Group by item
Order by count(*)
LIMIT 1

S: What are the codes of all the items?
S: Order them by the number of times that they were bought.
S: Which was bought the fewest times?

Select item
From items
Group by item

Select item
From items
Group by item
Order by count(*)

Select item
From items
Group by item
Order by count(*)
LIMIT 1

17. How many goods are available for each food type?
P: Count the number of goods for each food type.

Select count(*), food
From goods
group by food

S: What are all the food types?
S: How many of each are there?

Select food
From goods
group by food

Select count(*), food
From goods
group by food

18. What is the average price for each food type?
P: Give the average price for each food type.

Select avg(price), food
From goods
group by food

S: What are all the food types?
S: What is the average price for each?

Select food
From goods
group by food

Select avg(price), food
From goods
group by food

19. What are ids of the goods that have Apricot flavor and are cheaper than 5 dollars?
P: Give the ids for goods that have Apricot flavor and have a price lower than 5 dollars.

Select id
From goods
where flavor = "Apricot" and price < 5

S: What are the ids for all the goods?
S: Of these, which have Apricot flavor?
S: Of these, which are cheaper than 5 dollars?

Select id
From goods

Select id
From goods
where flavor = "Apricot"

Select id
From goods
where flavor = "Apricot" and price < 5

20. Find flavor of cakes that cost more than 10 dollars.
P: What are the flavors of cakes that cost more than 10 dollars?

Select flavor
From goods
where food = "Cake" and price > 10

S: What flavors of Cake are there?
S: Of these, which cost more than 10 dollars?

Select flavor
From goods
where food = "Cake"

Select flavor
From goods
where food = "Cake" and price > 10

21. Give me the distinct id and price for all goods whose price is below the average of all goods?
P: What are the distinct ids and prices for goods that cost less than the average good?

Select distinct id, price
From goods
where price < (Select avg(price) From goods)

S: What is the average price of any good?
S: What is all the information on goods that cost less than this?
S: What are their distinct ids and prices?

Select avg(price)
From goods)

Select *
From goods
where price < (Select avg(price) From goods)

Select distinct id, price
From goods
where price < (Select avg(price) From goods)

22. What are the distinct ids of all goods that are cheaper than some goods of type Tart?
P: Give the distinct ids for goods that cost less than any Tart.

Select distinct id
From goods
where price < (select max(price) From goods Where food = "Tart")

S: What is the price of the most expensive Tart?
S: What are the distinct ids for goods that cost less than this?

select max(price)
From goods
Where food = "Tart"

Select distinct id
From goods
where price < (select max(price) From goods Where food = "Tart")

23.  List distinct receipt numbers for which someone bought a good that costs more than 13 dollars.
P: What distinct receipt numbers correspond to someone who bought a good that costs more than 13 dollars?

Select distinct T1.ReceiptNumber
from receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Where T3.price > 13

S: What are the distinct receipt numbers?
S: Of these, which were for instances in which a purchase of over 13 dollars was made?

Select distinct ReceiptNumber
from receipts

Select distinct T1.ReceiptNumber
from receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Where T3.price > 13

24. On which date did some customer buy a good that costs more than 15 dollars?
P: Which date corresponds to when a customer purchased a good costing over 15 dollars?

Select distinct T1.date
from receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Where T3.price > 15

S: On what different dates did customers purchase something?
S: Of these, which correspond to when a customer purchased a good costing over 15 dollars?

Select distinct date
from receipts

Select distinct T1.date
from receipts as T1 JOIN items as T2 ON T1.ReceiptNumber = T2.receipt JOIN goods as T3 ON T2.item = T3.id
Where T3.price > 15

25. Give me the list of ids of all goods whose id has "APP".
P: What are all the ids of goods with an id which contains "APP"?

Select id
from goods
Where id LIKE "%APP%"

S: What are the ids of all goods?
S: Of these, which contain the string "APP"?

Select id
from goods

Select id
from goods
Where id LIKE "%APP%"

26. Which good has "70" in its id? And what is its price?
P: What are the id and price for the good with "70" in its id?

Select id, price
from goods
Where id LIKE "%70%"

S: What are the ids and prices for all goods?
S: Of these, which has an id which contains "70"?

Select id, price
from goods

Select id, price
from goods
Where id LIKE "%70%"

27. List the last names of all customers in an alphabetical order.
P: What are the last names of the customers in alphabetical order?

Select distinct LastName
From customers
Order by LastName

S: What are the distinct last names of the customers?
S: Order them in alphabetical order.

Select distinct LastName
From customers

Select distinct LastName
From customers
Order by LastName

28. Return the ordered list of all good ids.
P: Order the distinct good ids.

Select distinct id
From goods
Order by id

S: What are the distinct good ids?
S: Order them.

Select distinct id
From goods

Select distinct id
From goods
Order by id

29. Find all receipts in which either apple flavor pie was bought or customer id 12 shopped.
P: What are the receipt numbers for which either an apple flavor pie was purchased or the customer with id 12 shopped?

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
where T2.flavor = "Apple" and T2.food = "Pie"
UNION
Select ReceiptNumber
From receipts
where CustomerId = 12

S: What are the receipt numbers for which the customer id is 12?
S: What are the receipt numbers for which an apple flavor pie was purchased?
S: Return all results that are either of these.

Select ReceiptNumber
From receipts
where CustomerId = 12

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
where T2.flavor = "Apple" and T2.food = "Pie"

Select T1.receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
where T2.flavor = "Apple" and T2.food = "Pie"
UNION
Select ReceiptNumber
From receipts
where CustomerId = 12

30. Find all receipts which has the latest date. Also tell me that date.
P: What is the receipt number with the latest date, and what is that date?

Select ReceiptNumber, date
From receipts
where date = (Select date From receipts Order by date Desc LIMIT 1)

S: What is the latest date for a receipt?
S: Also, what is the receipt number corresponding to that?

Select date
From receipts
Order by date Desc
LIMIT 1

Select ReceiptNumber, date
From receipts
where date = (Select date From receipts Order by date Desc LIMIT 1)

31. Find all receipts which either has the earliest date or has a good with price above 10.
P: What are all the receipt numbers that have a good with a price above 10 or have the earliest date?

Select T1.Receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
where T2.price > 10
UNION
Select ReceiptNumber
From receipts
where date = (Select date From receipts Order by date LIMIT 1)

S: What is the earliest date for a receipt?
S: What is the receipt number corresponding to that?
S: What are the receipt numbers that are either included in those or are for receipts for goods that cost more than 10 dollars?

Select date
From receipts
Order by date
LIMIT 1

Select ReceiptNumber
From receipts
where date = (Select date From receipts Order by date LIMIT 1)

Select T1.Receipt
From items as T1 JOIN goods as T2 ON T1.item = T2.id
where T2.price > 10
UNION
Select ReceiptNumber
From receipts
where date = (Select date From receipts Order by date LIMIT 1)

32. What are the ids of Cookie and Cake that cost between 3 and 7 dollars.
P: Give the ids of Cookies or Cakes that cost between 3 and 7 dollars.

Select id
From goods
where food = "Cookie" or food = "Cake" and price between 3 and 7

S: What are the ids of goods that have prices between 3 and 7?
S: Of those, which are for cookies or cakes?

Select id
From goods
where price between 3 and 7

Select id
From goods
where food = "Cookie" or food = "Cake" and price between 3 and 7

33. Find the first name and last name of a customer who visited on the earliest date.
P: What is the full name of the customer who visited on the earliest date?

Select T1.FirstName, T1.LastName
From customers as T1 JOIN receipts as T2 ON T1.id = T2.CustomerId
Order by T2.date
LIMIT 1

S: What are the full names of all customers?
S: Sort them by the dates that they came to the bakery.
S: Which corresponds to the earliest date?

Select FirstName, LastName
From customers

Select T1.FirstName, T1.LastName
From customers as T1 JOIN receipts as T2 ON T1.id = T2.CustomerId
Order by T2.date

Select T1.FirstName, T1.LastName
From customers as T1 JOIN receipts as T2 ON T1.id = T2.CustomerId
Order by T2.date
LIMIT 1

34. What is average price of goods whose flavor is blackberry or blueberry?
P: What are the average prices of goods with blackberry or blueberry flavor?

Select avg(price)
From goods
where flavor = "Blackberry" or flavor = "Blueberry"

S: What is the average price of all goods?
S: What if only goods with blackberry or blueberry flavor are included?

Select avg(price)
From goods

Select avg(price)
From goods
where flavor = "Blackberry" or flavor = "Blueberry"

35. Return the cheapest price for goods with cheese flavor.
P: What is the cheapest good with cheese flavor?

Select min(price)
From goods
where flavor = "Cheese"

S: What is the cheapest good?
S: What if only goods that have cheese flavor are considered?

Select min(price)
From goods

Select min(price)
From goods
where flavor = "Cheese"

36. What are highest, lowest, and average prices of goods, grouped and ordered by flavor?
P: What are the maximum, minimum, and average prices of goods of each flavor, ordered by flavor?

Select max(price), min(price), avg(price), flavor
From goods
group by flavor
order by flavor

S: What are maximum, minimum, and average prices for all goods?
S: What are these, grouped by flavor?
S: Order these by flavor.

Select max(price), min(price), avg(price)
From goods

Select max(price), min(price), avg(price), flavor
From goods
group by flavor

Select max(price), min(price), avg(price), flavor
From goods
group by flavor
order by flavor

37. Return the lowest and highest prices of goods grouped and ordered by food type.
P: What are the minimum and maximum prices of food goods, ordered by food?

Select min(price), max(price), food
From goods
group by food
order by food

S: What are the minimum and maximum prices for all goods?
S: What are these for different food types?
S: Order these by food type.

Select min(price), max(price)
From goods

Select min(price), max(price), food
From goods
group by food

Select min(price), max(price), food
From goods
group by food
order by food

38. Find the top three dates with the most receipts.
P: What are the three dates for which the most receipts were given?

Select date
From receipts
Group by date
Order by count(*) desc
LIMIT 3

S: What are all the different dates on receipts?
S: Order these by decreasing frequency.
S: What are the top three?

Select date
From receipts
Group by date

Select date
From receipts
Group by date
Order by count(*) desc

Select date
From receipts
Group by date
Order by count(*) desc
LIMIT 3

39. Which customer shopped most often? How many times?
P: Give the customer id of the customer that made the most purchases, as well as the number of purchases made.

Select CustomerId, count(*)
From receipts
Group by CustomerId
Order by count(*) desc
LIMIT 1

S: Order the customer ids by decreasing number of receipts.
S: Also, include the number of receipts.
S: Who had the most?

Select CustomerId
From receipts
Group by CustomerId
Order by count(*) desc

Select CustomerId, count(*)
From receipts
Group by CustomerId
Order by count(*) desc

Select CustomerId, count(*)
From receipts
Group by CustomerId
Order by count(*) desc
LIMIT 1

40. For each date, return how many distinct customers visited on that day.
P: How many cusomters visited on each date?

Select date, count (distinct CustomerId)
from receipts
Group by date

S: What are the different dates?
S: How many distinct customer ids are there for each date?

Select date
from receipts
Group by date

Select date, count (distinct CustomerId)
from receipts
Group by date

41. Give me the first name and last name of customers who have bought apple flavor Tart.
P: What are the full names of customers who bought apple flavored Tarts?

Select distinct T4.FirstName, T4.LastName
from goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber JOIN customers as T4 ON T3.CustomerId = T4.id
where T1.flavor = "Apple" and T1.food = "Tart"

S: What are the full names of all customers?
S: What are the full names of customers who bought apple flavored Tarts?

Select distinct FirstName, LastName
from customers

Select distinct T4.FirstName, T4.LastName
from goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber JOIN customers as T4 ON T3.CustomerId = T4.id
where T1.flavor = "Apple" and T1.food = "Tart"

42. What are the ids of Cookies whose price is lower than any Croissant?
P: Give the ids of cookes that are cheaper than any croissant.

Select id
From goods
where food = "Cookie" and price < (select min(price) from goods where food = 'Croissant')

S: What is the price of the cheapest croissant?
S: What are the ids of cookies that are cheaper?

select min(price)
from goods
where food = 'Croissant'

Select id
From goods
where food = "Cookie" and price < (select min(price) from goods where food = 'Croissant')

43. Give me the ids of Cakes whose price is at least three times as much as the average price of Tart?
P: What are the ids of cakes that are at least three times as expensive as the average Tart?

Select id
From goods
where food = "Cake" and price >= 3 * (select avg(price)
                             from goods
                             where food = "Tart")

S: What is the price of the average tart?
S: What are the ids of goods that are at least three times as expensive?
S: Of those, which are cakes?

select avg(price)
from goods
where food = "Tart"

Select id
From goods
where price >= 3 * (select avg(price)
                             from goods
                             where food = "Tart")

Select id
From goods
where food = "Cake" and price >= 3 * (select avg(price)
                             from goods
                             where food = "Tart")

44. What are the ids of goods whose price is above twice the average price of all goods?
P: Give the ids of goods that are more than twice as expensive as the average good.

Select id
From goods
where price > 2 * (select avg(price) from goods)

S: What is the average price of a good?
S: What are the ids of goods that are more than twice as expensive?

select avg(price)
from goods

Select id
From goods
where price > 2 * (select avg(price) from goods)

45. List the id, flavor and type of food of goods ordered by price.
P: What are the ids, flavors, and food types of goods, ordered by price?

Select id, flavor, food
From goods
order by price

S: What are the ids, flavors, and food types of all goods?
S: Order these by price.

Select id, flavor, food
From goods

Select id, flavor, food
From goods
order by price

46. Return a list of the id and flavor for Cakes ordered by flavor.
P: What are the ids and flavors of cakes, ordered by flavor?

Select id, flavor
From goods
where food = "Cake"
order by flavor

S: What are the ids and flavors of cakes?
S: Order them by flavor.

Select id, flavor
From goods
where food = "Cake"

Select id, flavor
From goods
where food = "Cake"
order by flavor

47. Find all the items that have chocolate flavor but were not bought more than 10 times.
P: What are the items with chocolate flavor that were purchased at most 10 times.

Select distinct T1.item
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.flavor = "Chocolate"
Group by item
having count(*) <= 10

S: What are the distinct items that have been purchased at most 10 times?
S: Of these, which have chocolate flavor?

Select distinct item
From items
Group by item
having count(*) <= 10

Select distinct T1.item
From items as T1 JOIN goods as T2 ON T1.item = T2.id
Where T2.flavor = "Chocolate"
Group by item
having count(*) <= 10

48. What are the flavors available for Cake but not for Tart?
P: Give the flavors of Cakes that are not available for Tart.

Select distinct flavor
From goods
where food = "Cake"
EXCEPT
Select distinct flavor
From goods
where food = "Tart"

S: What are the distinct flavors of cakes?
S: Of these, which are not available for tarts?

Select distinct flavor
From goods
where food = "Cake"

Select distinct flavor
From goods
where food = "Cake"
EXCEPT
Select distinct flavor
From goods
where food = "Tart"

49. What is the three most popular goods in this bakery?
P: Give the three most purchased items at this bakery.

Select item
From items
Group by item
Order by count (*) DESC
LIMIT 3

S: Order the items decreasing by the number of times they were purchased.
S: Which three were the most popular?

Select item
From items
Group by item
Order by count (*) DESC

Select item
From items
Group by item
Order by count (*) DESC
LIMIT 3

50. Find the ids of customers who have spent more than 150 dollars in total.
P: What are the ids of customers who have spent over 150 dollars in total?

Select T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.CustomerId
having sum(T1.price) > 150

S: What are the different customer ids?
S: Of those, who spent over 150 dollars in total?

Select CustomerId
From receipts
Group by CustomerId

Select T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.CustomerId
having sum(T1.price) > 150

51. Find the ids of customers whose average spending for each good is above 5.
P: What are the ids of customers who spend more than 5 on average for each good?

Select T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.CustomerId
having avg(T1.price) > 5

S: What are the different customer ids?
S: Of those, who spends over 5 dollars on average for each good?

Select CustomerId
From receipts
Group by CustomerId

Select T3.CustomerId
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.CustomerId
having avg(T1.price) > 5

52. On which day did the bakery sell more than 100 dollars in total.
P: On what dates did the bakery sell more than 100 dollars worth of goods in total?

Select T3.date
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.date
having sum(T1.price) > 100

S: What are all the different dates on receipts?
S: Of these, which dates did the bakery sell more than 100 dollars of goods?

Select date
From receipts
Group by date

Select T3.date
From goods as T1 JOIN items as T2 ON T1.id = T2.item JOIN receipts as T3 ON T2.receipt = T3.ReceiptNumber
Group by T3.date
having sum(T1.price) > 100


